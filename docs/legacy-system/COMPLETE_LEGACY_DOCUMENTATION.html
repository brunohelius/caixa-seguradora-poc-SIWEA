<h1 id="documentação-completa-do-sistema-legado-siwea">DOCUMENTAÇÃO
COMPLETA DO SISTEMA LEGADO SIWEA</h1>
<p><strong>Sistema de Liberação de Pagamento de Sinistros</strong>
<strong>Versão:</strong> 1.0 <strong>Data:</strong> 27 de outubro de
2025 <strong>Classificação:</strong> CONFIDENCIAL - USO INTERNO</p>
<hr />
<h2 id="índice-geral">ÍNDICE GERAL</h2>
<ol type="1">
<li><a href="#sumário-executivo">Sumário Executivo</a></li>
<li><a href="#arquitetura-técnica">Arquitetura Técnica</a></li>
<li><a href="#estruturas-de-dados">Estruturas de Dados</a></li>
<li><a href="#modelo-de-banco-de-dados">Modelo de Banco de
Dados</a></li>
<li><a href="#lógica-de-negócio">Lógica de Negócio</a></li>
<li><a href="#integrações-externas">Integrações Externas</a></li>
<li><a href="#guia-de-operações">Guia de Operações</a></li>
<li><a href="#interface-e-telas">Interface e Telas</a></li>
<li><a href="#guia-de-migração">Guia de Migração</a></li>
<li><a href="#glossário">Glossário</a></li>
</ol>
<hr />
<hr />
<h1 id="sumário-executivo-sistema-legado-siwea">01 - Sumário Executivo:
Sistema Legado SIWEA</h1>
<hr />
<h2 id="identificação-do-sistema">Identificação do Sistema</h2>
<h3 id="informações-básicas">Informações Básicas</h3>
<table>
<colgroup>
<col style="width: 58%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Atributo</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ID do Programa</strong></td>
<td>#SIWEA-V116.esf</td>
</tr>
<tr>
<td><strong>Sistema Pai</strong></td>
<td>CAIXA SEGURADORA - Operações de Sinistros</td>
</tr>
<tr>
<td><strong>Função Principal</strong></td>
<td>Autorização de Pagamento de Indenizações de Seguros</td>
</tr>
<tr>
<td><strong>Tipo de Sistema</strong></td>
<td>Online Transaction Processing (OLTP) com interface CICS</td>
</tr>
<tr>
<td><strong>Plataforma</strong></td>
<td>IBM Mainframe z/OS</td>
</tr>
<tr>
<td><strong>Linguagem</strong></td>
<td>COBOL/EZEE (IBM VisualAge EZEE 4.40)</td>
</tr>
<tr>
<td><strong>Banco de Dados</strong></td>
<td>IBM DB2 for z/OS</td>
</tr>
<tr>
<td><strong>Tamanho do Código</strong></td>
<td>851.9 KB (fonte original)</td>
</tr>
<tr>
<td><strong>Data de Criação</strong></td>
<td>Outubro de 1989</td>
</tr>
<tr>
<td><strong>Programador Original</strong></td>
<td>SOLANGE (Programadora), COSMO (Analista)</td>
</tr>
<tr>
<td><strong>Última Atualização</strong></td>
<td>11 de fevereiro de 2014 (CAD73898)</td>
</tr>
<tr>
<td><strong>Status Atual</strong></td>
<td>Em Produção (35+ anos)</td>
</tr>
</tbody>
</table>
<h3 id="equipe-técnica-original">Equipe Técnica Original</h3>
<ul>
<li><strong>Analista de Sistemas</strong>: COSMO</li>
<li><strong>Programadora Principal</strong>: SOLANGE</li>
<li><strong>Última Manutenção</strong>: CAD73898 (11/02/2014)</li>
<li><strong>Versão Atual</strong>: V90 (após 90 revisões
documentadas)</li>
</ul>
<hr />
<h2 id="objetivo-de-negócio">Objetivo de Negócio</h2>
<h3 id="propósito-principal">Propósito Principal</h3>
<p>Gerenciar o <strong>processo completo de autorização de pagamentos de
sinistros</strong> na Caixa Seguradora, permitindo que operadores
qualificados localizem sinistros, validem informações, autorizem
pagamentos de indenizações e mantenham controle do workflow de
processamento através de um sistema de fases configuráveis.</p>
<h3 id="processos-de-negócio-suportados">Processos de Negócio
Suportados</h3>
<h4 id="busca-e-localização-de-sinistros">1. Busca e Localização de
Sinistros</h4>
<ul>
<li><strong>Métodos de Busca</strong>: Por protocolo, número de sinistro
ou código líder</li>
<li><strong>Validação</strong>: Verificação contra base de dados DB2 com
13 entidades</li>
<li><strong>Performance</strong>: Resposta em menos de 3 segundos</li>
<li><strong>Volume</strong>: Suporte para base com milhões de
registros</li>
</ul>
<h4 id="autorização-de-pagamento-de-indenizações">2. Autorização de
Pagamento de Indenizações</h4>
<ul>
<li><strong>Tipos de Pagamento</strong>: 5 tipos configuráveis
(1-5)</li>
<li><strong>Validações</strong>: 100+ regras de negócio
automatizadas</li>
<li><strong>Conversão Monetária</strong>: BTNF (moeda padronizada da
SUSEP)</li>
<li><strong>Auditoria</strong>: Registro completo com operador,
data/hora e valores</li>
</ul>
<h4 id="gestão-de-workflow-por-fases">3. Gestão de Workflow por
Fases</h4>
<ul>
<li><strong>Sistema de Fases</strong>: 8 fases de processamento
configuráveis</li>
<li><strong>Transições</strong>: Automáticas baseadas em eventos</li>
<li><strong>Rastreabilidade</strong>: Histórico completo de mudanças de
fase</li>
<li><strong>SLA</strong>: Controle de tempo em cada fase</li>
</ul>
<h4 id="integração-com-sistemas-externos">4. Integração com Sistemas
Externos</h4>
<ul>
<li><strong>CNOUA</strong>: Validação de produtos de consórcio (códigos
6814, 7701, 7709)</li>
<li><strong>SIPUA</strong>: Validação de contratos EFP</li>
<li><strong>SIMDA</strong>: Validação de contratos HB</li>
<li><strong>Modo de Falha</strong>: Operação offline em caso de
indisponibilidade</li>
</ul>
<hr />
<h2 id="escopo-funcional">Escopo Funcional</h2>
<h3 id="funcionalidades-incluídas">Funcionalidades Incluídas ✅</h3>
<ol type="1">
<li><strong>Gestão de Sinistros</strong>
<ul>
<li>Consulta por múltiplos critérios</li>
<li>Visualização de dados completos do sinistro</li>
<li>Cálculo automático de saldo pendente</li>
<li>Histórico de pagamentos realizados</li>
</ul></li>
<li><strong>Processamento de Pagamentos</strong>
<ul>
<li>Entrada de dados de autorização</li>
<li>Validação de 100+ regras de negócio</li>
<li>Conversão automática para BTNF</li>
<li>Controle de limites e alçadas</li>
</ul></li>
<li><strong>Controle de Workflow</strong>
<ul>
<li>8 fases de processamento</li>
<li>Transições automáticas</li>
<li>Controle de SLA</li>
<li>Alertas de pendências</li>
</ul></li>
<li><strong>Auditoria e Compliance</strong>
<ul>
<li>Log completo de transações</li>
<li>Rastreabilidade por operador</li>
<li>Relatórios regulatórios</li>
<li>Conformidade com SUSEP</li>
</ul></li>
</ol>
<h3 id="funcionalidades-excluídas">Funcionalidades Excluídas ❌</h3>
<ul>
<li>Cadastro inicial de sinistros (sistema externo)</li>
<li>Gestão de apólices e segurados (sistema de produção)</li>
<li>Cálculo de reservas técnicas (sistema atuarial)</li>
<li>Emissão de relatórios gerenciais (sistema de BI)</li>
<li>Gestão documental (sistema GED)</li>
<li>Pagamento bancário efetivo (sistema financeiro)</li>
</ul>
<hr />
<h2 id="indicadores-de-performance">Indicadores de Performance</h2>
<h3 id="métricas-operacionais">Métricas Operacionais</h3>
<table>
<thead>
<tr>
<th>Métrica</th>
<th>Valor Atual</th>
<th>SLA</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Tempo de Resposta - Busca</strong></td>
<td>&lt; 3 segundos</td>
<td>5 segundos</td>
</tr>
<tr>
<td><strong>Tempo de Autorização</strong></td>
<td>&lt; 90 segundos</td>
<td>120 segundos</td>
</tr>
<tr>
<td><strong>Disponibilidade</strong></td>
<td>99.5%</td>
<td>99%</td>
</tr>
<tr>
<td><strong>Transações/Dia</strong></td>
<td>5.000-8.000</td>
<td>10.000</td>
</tr>
<tr>
<td><strong>Usuários Simultâneos</strong></td>
<td>150-200</td>
<td>500</td>
</tr>
<tr>
<td><strong>Volume Base de Dados</strong></td>
<td>2.5 milhões sinistros</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Crescimento Mensal</strong></td>
<td>15.000 novos sinistros</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3 id="indicadores-de-negócio">Indicadores de Negócio</h3>
<table>
<thead>
<tr>
<th>Indicador</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Pagamentos Autorizados/Mês</strong></td>
<td>R$ 45-60 milhões</td>
</tr>
<tr>
<td><strong>Sinistros Processados/Mês</strong></td>
<td>15.000-18.000</td>
</tr>
<tr>
<td><strong>Taxa de Rejeição</strong></td>
<td>&lt; 2%</td>
</tr>
<tr>
<td><strong>Tempo Médio de Processamento</strong></td>
<td>48 horas</td>
</tr>
<tr>
<td><strong>Precisão de Cálculos</strong></td>
<td>99.99%</td>
</tr>
<tr>
<td><strong>Conformidade Regulatória</strong></td>
<td>100%</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="análise-de-complexidade">Análise de Complexidade</h2>
<h3 id="pontos-de-função-fpa">Pontos de Função (FPA)</h3>
<table>
<thead>
<tr>
<th>Categoria</th>
<th>Quantidade</th>
<th>Complexidade</th>
<th>Pontos</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Entradas Externas (EI)</strong></td>
<td>12</td>
<td>Alta</td>
<td>180</td>
</tr>
<tr>
<td><strong>Saídas Externas (EO)</strong></td>
<td>8</td>
<td>Média</td>
<td>96</td>
</tr>
<tr>
<td><strong>Consultas Externas (EQ)</strong></td>
<td>15</td>
<td>Alta</td>
<td>225</td>
</tr>
<tr>
<td><strong>Arquivos Lógicos Internos (ILF)</strong></td>
<td>13</td>
<td>Alta</td>
<td>260</td>
</tr>
<tr>
<td><strong>Arquivos de Interface Externa (EIF)</strong></td>
<td>6</td>
<td>Média</td>
<td>60</td>
</tr>
<tr>
<td><strong>TOTAL PONTOS DE FUNÇÃO</strong></td>
<td></td>
<td></td>
<td><strong>821</strong></td>
</tr>
</tbody>
</table>
<h3 id="classificação-de-complexidade">Classificação de
Complexidade</h3>
<ul>
<li><strong>Complexidade Geral</strong>: ALTA</li>
<li><strong>Nível de Criticidade</strong>: MISSÃO CRÍTICA</li>
<li><strong>Risco de Migração</strong>: ALTO</li>
<li><strong>Esforço Estimado</strong>: 1.642 horas (2x FP devido à
criticidade)</li>
</ul>
<hr />
<h2 id="riscos-e-desafios">Riscos e Desafios</h2>
<h3 id="riscos-técnicos">Riscos Técnicos</h3>
<ol type="1">
<li><strong>Código Legado Complexo</strong>
<ul>
<li>35 anos de manutenções acumuladas</li>
<li>Documentação técnica limitada</li>
<li>Lógica de negócio entrelaçada</li>
</ul></li>
<li><strong>Dependências de Plataforma</strong>
<ul>
<li>CICS transaction manager</li>
<li>COBOL/EZEE específico IBM</li>
<li>DB2 com stored procedures legadas</li>
</ul></li>
<li><strong>Integrações Críticas</strong>
<ul>
<li>Sistemas externos sem documentação</li>
<li>Protocolos proprietários</li>
<li>Timeouts e retry logic complexos</li>
</ul></li>
</ol>
<h3 id="riscos-de-negócio">Riscos de Negócio</h3>
<ol type="1">
<li><strong>Continuidade Operacional</strong>
<ul>
<li>Sistema crítico 24x7</li>
<li>Zero tolerance para erros de pagamento</li>
<li>Compliance regulatório obrigatório</li>
</ul></li>
<li><strong>Migração de Dados</strong>
<ul>
<li>2.5 milhões de sinistros históricos</li>
<li>Integridade referencial complexa</li>
<li>Conversão de formatos proprietários</li>
</ul></li>
<li><strong>Treinamento de Usuários</strong>
<ul>
<li>200+ operadores especializados</li>
<li>Processos enraizados há décadas</li>
<li>Resistência a mudanças</li>
</ul></li>
</ol>
<hr />
<h2 id="estratégia-de-migração-recomendada">Estratégia de Migração
Recomendada</h2>
<h3 id="abordagem-faseada">Abordagem Faseada</h3>
<h4 id="fase-1-análise-e-documentação-concluída">Fase 1: Análise e
Documentação (Concluída)</h4>
<ul>
<li>✅ Engenharia reversa do código SIWEA</li>
<li>✅ Documentação de 100+ regras de negócio</li>
<li>✅ Mapeamento de 13 entidades de dados</li>
<li>✅ Análise de integrações externas</li>
</ul>
<h4 id="fase-2-poc-e-validação-em-andamento">Fase 2: POC e Validação (Em
Andamento)</h4>
<ul>
<li>🔄 Desenvolvimento de MVP em .NET 9.0</li>
<li>🔄 Interface React 19 preservando layout original</li>
<li>🔄 Testes de paridade com sistema legado</li>
<li>🔄 Validação com usuários-chave</li>
</ul>
<h4 id="fase-3-desenvolvimento-completo-planejado">Fase 3:
Desenvolvimento Completo (Planejado)</h4>
<ul>
<li>⏳ Implementação de todas as funcionalidades</li>
<li>⏳ Migração de dados históricos</li>
<li>⏳ Integração com sistemas externos</li>
<li>⏳ Testes de aceitação completos</li>
</ul>
<h4 id="fase-4-implantação-e-cutover-futuro">Fase 4: Implantação e
Cutover (Futuro)</h4>
<ul>
<li>⏳ Operação em paralelo (3 meses)</li>
<li>⏳ Migração gradual por departamento</li>
<li>⏳ Descomissionamento do sistema legado</li>
<li>⏳ Estabilização e otimização</li>
</ul>
<h3 id="tecnologias-alvo">Tecnologias Alvo</h3>
<table>
<thead>
<tr>
<th>Componente</th>
<th>Tecnologia Legada</th>
<th>Tecnologia Nova</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Backend</strong></td>
<td>COBOL/EZEE</td>
<td>.NET 9.0 C#</td>
</tr>
<tr>
<td><strong>Frontend</strong></td>
<td>CICS 3270</td>
<td>React 19 + TypeScript</td>
</tr>
<tr>
<td><strong>Banco de Dados</strong></td>
<td>DB2 z/OS</td>
<td>SQL Server / PostgreSQL</td>
</tr>
<tr>
<td><strong>Integrações</strong></td>
<td>CICS/MQ</td>
<td>REST API / gRPC</td>
</tr>
<tr>
<td><strong>Autenticação</strong></td>
<td>RACF</td>
<td>Azure AD / JWT</td>
</tr>
<tr>
<td><strong>Deployment</strong></td>
<td>Mainframe</td>
<td>Azure Cloud / Kubernetes</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="benefícios-esperados-da-migração">Benefícios Esperados da
Migração</h2>
<h3 id="benefícios-técnicos">Benefícios Técnicos</h3>
<ul>
<li>🚀 <strong>Modernização da Stack</strong>: Tecnologias atuais e
suportadas</li>
<li>☁️ <strong>Cloud Native</strong>: Escalabilidade e resiliência</li>
<li>🔧 <strong>Manutenibilidade</strong>: Código limpo e
documentado</li>
<li>🔄 <strong>CI/CD</strong>: Deploys automatizados e seguros</li>
<li>📊 <strong>Observabilidade</strong>: Monitoramento e métricas em
tempo real</li>
</ul>
<h3 id="benefícios-de-negócio">Benefícios de Negócio</h3>
<ul>
<li>💰 <strong>Redução de Custos</strong>: -70% em licenças e
infraestrutura</li>
<li>⚡ <strong>Agilidade</strong>: Novos recursos em dias, não
meses</li>
<li>📱 <strong>Mobilidade</strong>: Acesso via web e mobile</li>
<li>🔍 <strong>Analytics</strong>: Dashboards e insights em tempo
real</li>
<li>🌐 <strong>Integração</strong>: APIs abertas para parceiros</li>
</ul>
<h3 id="roi-estimado">ROI Estimado</h3>
<table>
<thead>
<tr>
<th>Métrica</th>
<th>Ano 1</th>
<th>Ano 2</th>
<th>Ano 3</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Economia de Licenças</strong></td>
<td>R$ 1.2M</td>
<td>R$ 1.2M</td>
<td>R$ 1.2M</td>
<td>R$ 3.6M</td>
</tr>
<tr>
<td><strong>Redução de Manutenção</strong></td>
<td>R$ 400K</td>
<td>R$ 600K</td>
<td>R$ 800K</td>
<td>R$ 1.8M</td>
</tr>
<tr>
<td><strong>Ganhos de Produtividade</strong></td>
<td>R$ 300K</td>
<td>R$ 500K</td>
<td>R$ 700K</td>
<td>R$ 1.5M</td>
</tr>
<tr>
<td><strong>Investimento Inicial</strong></td>
<td>(R$ 2.5M)</td>
<td>-</td>
<td>-</td>
<td>(R$ 2.5M)</td>
</tr>
<tr>
<td><strong>ROI Acumulado</strong></td>
<td>(R$ 600K)</td>
<td>R$ 1.7M</td>
<td>R$ 4.4M</td>
<td><strong>R$ 4.4M</strong></td>
</tr>
</tbody>
</table>
<p><strong>Payback</strong>: 18 meses <strong>ROI em 3 anos</strong>:
176%</p>
<hr />
<h2 id="conclusão-e-próximos-passos">Conclusão e Próximos Passos</h2>
<h3 id="status-atual">Status Atual</h3>
<p>O sistema SIWEA, após 35 anos de operação contínua, permanece como
peça fundamental nas operações de sinistros da Caixa Seguradora. A
análise técnica completa revelou um sistema robusto, mas com clara
necessidade de modernização para atender às demandas futuras do
negócio.</p>
<h3 id="recomendações-imediatas">Recomendações Imediatas</h3>
<ol type="1">
<li><strong>Aprovar continuidade do POC</strong> - Validar viabilidade
técnica</li>
<li><strong>Formar equipe dedicada</strong> - 6-8 desenvolvedores
especializados</li>
<li><strong>Estabelecer ambiente de testes</strong> - Réplica completa
para validação</li>
<li><strong>Definir critérios de sucesso</strong> - Métricas claras de
paridade</li>
<li><strong>Planejar capacitação</strong> - Programa de treinamento
estruturado</li>
</ol>
<h3 id="cronograma-proposto">Cronograma Proposto</h3>
<ul>
<li><strong>Q1 2025</strong>: Conclusão do POC e decisão Go/No-Go</li>
<li><strong>Q2-Q3 2025</strong>: Desenvolvimento da solução
completa</li>
<li><strong>Q4 2025</strong>: Testes integrados e homologação</li>
<li><strong>Q1 2026</strong>: Implantação piloto e operação
paralela</li>
<li><strong>Q2 2026</strong>: Rollout completo e descomissionamento</li>
</ul>
<h3 id="contatos-e-responsáveis">Contatos e Responsáveis</h3>
<table>
<thead>
<tr>
<th>Papel</th>
<th>Responsável</th>
<th>Contato</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sponsor Executivo</strong></td>
<td>Diretoria de TI</td>
<td>-</td>
</tr>
<tr>
<td><strong>Gerente de Projeto</strong></td>
<td>A definir</td>
<td>-</td>
</tr>
<tr>
<td><strong>Arquiteto de Solução</strong></td>
<td>Equipe de Arquitetura</td>
<td>-</td>
</tr>
<tr>
<td><strong>Product Owner</strong></td>
<td>Área de Sinistros</td>
<td>-</td>
</tr>
<tr>
<td><strong>Tech Lead</strong></td>
<td>Equipe de Desenvolvimento</td>
<td>-</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Este documento é parte integrante da documentação técnica
completa do sistema SIWEA para fins de migração tecnológica.</em></p>
<p><strong>Versão:</strong> 1.0 <strong>Data:</strong> 27/10/2025
<strong>Classificação:</strong> Confidencial - Uso Interno</p>
<hr />
<h1 id="arquitetura-técnica-sistema-legado-siwea">02 - Arquitetura
Técnica: Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-da-arquitetura">Visão Geral da Arquitetura</h2>
<h3 id="diagrama-de-arquitetura-completa">Diagrama de Arquitetura
Completa</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                     USUÁRIOS EXTERNOS                        │
│                  (200+ Operadores Autorizados)               │
└──────────────────────────┬──────────────────────────────────┘
                           │
                    TN3270 Protocol
                           │
┌──────────────────────────┴──────────────────────────────────┐
│                   CAMADA DE APRESENTAÇÃO                     │
│                  Terminal IBM 3270 / Emulador                │
│     ┌─────────────────────────────────────────────┐        │
│     │ SI11M010 - Tela de Busca de Sinistros      │        │
│     │ SIHM020 - Tela de Autorização de Pagamento │        │
│     └─────────────────────────────────────────────┘        │
└──────────────────────────┬──────────────────────────────────┘
                           │
                    CICS Transaction
                           │
┌──────────────────────────┴──────────────────────────────────┐
│                    CAMADA DE NEGÓCIO                        │
│                 IBM CICS Transaction Server                  │
│     ┌─────────────────────────────────────────────┐        │
│     │        SIWEA-V116 (Programa Principal)      │        │
│     │    IBM VisualAge EZEE 4.40 - COBOL/EZEE    │        │
│     ├─────────────────────────────────────────────┤        │
│     │ • Validação de Regras de Negócio (100+)    │        │
│     │ • Cálculo de Valores e Conversão BTNF      │        │
│     │ • Gestão de Fases e Workflow               │        │
│     │ • Integração com Sistemas Externos         │        │
│     │ • Controle Transacional e Rollback         │        │
│     └─────────────────────────────────────────────┘        │
└────────────┬─────────────────────────────┬──────────────────┘
             │                             │
        DB2 SQL/API                   Web Services
             │                             │
┌────────────┴─────────────┐   ┌──────────┴──────────────────┐
│    CAMADA DE DADOS       │   │   INTEGRAÇÕES EXTERNAS       │
│    IBM DB2 for z/OS      │   │                              │
│                          │   │  ┌────────────────────────┐  │
│  ┌──────────────────┐    │   │  │ CNOUA - Consórcio      │  │
│  │ 13 Entidades     │    │   │  ├────────────────────────┤  │
│  │ • TMESTSIN       │    │   │  │ SIPUA - Contratos EFP  │  │
│  │ • THISTSIN       │    │   │  ├────────────────────────┤  │
│  │ • TGERAMO        │    │   │  │ SIMDA - Contratos HB   │  │
│  │ • TGEUNIMO       │    │   │  └────────────────────────┘  │
│  │ • TSISTEMA       │    │   │                              │
│  │ • TAPOLICE       │    │   └──────────────────────────────┘
│  │ • SI_ACOMPANHA   │    │
│  │ • SI_SINISTRO    │    │
│  │ • SI_REL_FASE    │    │
│  │ • EF_CONTR_SEG   │    │
│  └──────────────────┘    │
└──────────────────────────┘</code></pre>
<h3 id="características-arquiteturais">Características
Arquiteturais</h3>
<table>
<thead>
<tr>
<th>Aspecto</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Padrão Arquitetural</strong></td>
<td>3-Tier (Três Camadas)</td>
</tr>
<tr>
<td><strong>Modelo de Processamento</strong></td>
<td>Online Transaction Processing (OLTP)</td>
</tr>
<tr>
<td><strong>Paradigma</strong></td>
<td>Procedural / Batch Processing</td>
</tr>
<tr>
<td><strong>Acoplamento</strong></td>
<td>Fortemente Acoplado (Monolítico)</td>
</tr>
<tr>
<td><strong>Estado</strong></td>
<td>Stateless entre transações</td>
</tr>
<tr>
<td><strong>Comunicação</strong></td>
<td>Síncrona (Request/Response)</td>
</tr>
<tr>
<td><strong>Deployment</strong></td>
<td>Mainframe Centralizado</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="camada-de-apresentação">Camada de Apresentação</h2>
<h3 id="terminal-ibm-3270">Terminal IBM 3270</h3>
<h4 id="especificações-técnicas">Especificações Técnicas</h4>
<table>
<colgroup>
<col style="width: 68%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr>
<th>Característica</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Protocolo</strong></td>
<td>TN3270 (Telnet 3270)</td>
</tr>
<tr>
<td><strong>Resolução</strong></td>
<td>80 colunas × 24 linhas</td>
</tr>
<tr>
<td><strong>Codificação</strong></td>
<td>EBCDIC</td>
</tr>
<tr>
<td><strong>Cores Suportadas</strong></td>
<td>7 cores (verde, amarelo, vermelho, azul, rosa, ciano, branco)</td>
</tr>
<tr>
<td><strong>Buffer de Tela</strong></td>
<td>1920 caracteres (80×24)</td>
</tr>
<tr>
<td><strong>Atributos de Campo</strong></td>
<td>Normal, Intensified, Hidden, Protected</td>
</tr>
<tr>
<td><strong>Teclas de Função</strong></td>
<td>PF1-PF24, PA1-PA3, CLEAR, ENTER</td>
</tr>
</tbody>
</table>
<h4 id="mapa-de-telas-do-sistema">Mapa de Telas do Sistema</h4>
<h5 id="si11m010---busca-de-sinistros">SI11M010 - Busca de
Sinistros</h5>
<pre><code>Linha  1: ┌──────────────────────────────────────────────┐
Linha  2: │ SIWEA - SISTEMA DE LIBERAÇÃO DE PAGAMENTO     │
Linha  3: │ SI11M010 - BUSCA DE SINISTROS                 │
Linha  4: ├──────────────────────────────────────────────┤
Linha  5: │                                                │
Linha  6: │ CRITÉRIO 1 - POR PROTOCOLO:                   │
Linha  7: │   Fonte...: [___] (Protected)                 │
Linha  8: │   Protocolo: [________] (Input)               │
Linha  9: │   DAC.....: [_] (Input)                       │
Linha 10: │                                                │
Linha 11: │ CRITÉRIO 2 - POR SINISTRO:                    │
Linha 12: │   Origem..: [__] (Input)                      │
Linha 13: │   Ramo....: [__] (Input)                      │
Linha 14: │   Número..: [______] (Input)                  │
Linha 15: │                                                │
Linha 16: │ CRITÉRIO 3 - POR CÓDIGO LÍDER:                │
Linha 17: │   Líder...: [___] (Input)                     │
Linha 18: │   Sinistro: [_______] (Input)                 │
Linha 19: │                                                │
Linha 20: │ Mensagem: [_____________________________]     │
Linha 21: ├──────────────────────────────────────────────┤
Linha 22: │ PF3=Sair  PF12=Cancelar  ENTER=Buscar         │
Linha 23: └──────────────────────────────────────────────┘</code></pre>
<h5 id="sihm020---autorização-de-pagamento">SIHM020 - Autorização de
Pagamento</h5>
<pre><code>Linha  1: ┌──────────────────────────────────────────────┐
Linha  2: │ SIWEA - SISTEMA DE LIBERAÇÃO DE PAGAMENTO     │
Linha  3: │ SIHM020 - AUTORIZAÇÃO DE PAGAMENTO            │
Linha  4: ├──────────────────────────────────────────────┤
Linha  5: │ DADOS DO SINISTRO:                            │
Linha  6: │   Protocolo.: 001/0123456-7 (Protected)       │
Linha  7: │   Sinistro..: 10/20/789012 (Protected)        │
Linha  8: │   Ramo......: AUTOMÓVEIS (Protected)          │
Linha  9: │   Segurado..: JOÃO DA SILVA (Protected)       │
Linha 10: │   Saldo.....: R$ 50.000,00 (Protected)        │
Linha 11: │                                                │
Linha 12: │ DADOS DA AUTORIZAÇÃO:                         │
Linha 13: │   Tipo Pagto: [_] (1-5) (Input)              │
Linha 14: │   Tipo Apól.: [_] (1-2) (Input)              │
Linha 15: │   Valor Prin: [___________] (Input)          │
Linha 16: │   Valor Corr: [___________] (Input)          │
Linha 17: │   Favorecido: [_____________________] (Input) │
Linha 18: │                                                │
Linha 19: │ Mensagem: [_____________________________]     │
Linha 20: ├──────────────────────────────────────────────┤
Linha 21: │ PF3=Voltar  PF12=Cancelar  ENTER=Autorizar    │
Linha 22: └──────────────────────────────────────────────┘</code></pre>
<h3 id="fluxo-de-navegação">Fluxo de Navegação</h3>
<pre class="mermaid"><code>graph TD
    A[Menu Principal] --&gt; B[SI11M010 - Busca]
    B --&gt; C{Resultado}
    C --&gt;|Encontrado| D[SIHM020 - Autorização]
    C --&gt;|Não Encontrado| E[Mensagem Erro]
    E --&gt; B
    D --&gt; F{Validação}
    F --&gt;|Sucesso| G[Confirmação]
    F --&gt;|Falha| H[Mensagem Erro]
    H --&gt; D
    G --&gt; I[Atualização BD]
    I --&gt; J[Menu Principal]</code></pre>
<hr />
<h2 id="camada-de-negócio">Camada de Negócio</h2>
<h3 id="ibm-cics-transaction-server">IBM CICS Transaction Server</h3>
<h4 id="configuração-do-ambiente">Configuração do Ambiente</h4>
<table>
<thead>
<tr>
<th>Parâmetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CICS Version</strong></td>
<td>TS 5.x</td>
</tr>
<tr>
<td><strong>Region Type</strong></td>
<td>Application Owning Region (AOR)</td>
</tr>
<tr>
<td><strong>Max Tasks</strong></td>
<td>500</td>
</tr>
<tr>
<td><strong>Transaction Timeout</strong></td>
<td>120 segundos</td>
</tr>
<tr>
<td><strong>Program Language</strong></td>
<td>COBOL/EZEE</td>
</tr>
<tr>
<td><strong>Compile Options</strong></td>
<td>RENT, REUS, APOST</td>
</tr>
</tbody>
</table>
<h4 id="programa-principal-siwea-v116">Programa Principal:
SIWEA-V116</h4>
<h5 id="estrutura-modular">Estrutura Modular</h5>
<pre><code>SIWEA-V116 (Programa Principal)
│
├── MÓDULO DE INICIALIZAÇÃO
│   ├── Validação de Sessão CICS
│   ├── Inicialização de Variáveis
│   └── Obtenção de Data Sistema (TSISTEMA)
│
├── MÓDULO DE BUSCA
│   ├── Validação de Critérios
│   ├── Montagem de Query SQL
│   └── Execução e Retorno de Resultados
│
├── MÓDULO DE VALIDAÇÃO
│   ├── Regras de Negócio (100+)
│   ├── Validação de Limites
│   └── Verificação de Duplicidade
│
├── MÓDULO DE CÁLCULO
│   ├── Conversão Monetária (BTNF)
│   ├── Cálculo de Saldos
│   └── Atualização de Totais
│
├── MÓDULO DE INTEGRAÇÃO
│   ├── CNOUA (Consórcio)
│   ├── SIPUA (EFP)
│   └── SIMDA (HB)
│
├── MÓDULO DE PERSISTÊNCIA
│   ├── INSERT em THISTSIN
│   ├── UPDATE em TMESTSIN
│   └── Gestão de Fases
│
└── MÓDULO DE CONTROLE TRANSACIONAL
    ├── SYNCPOINT (Commit)
    └── ROLLBACK (Abort)</code></pre>
<h5 id="fluxo-de-processamento-principal">Fluxo de Processamento
Principal</h5>
<pre class="cobol"><code>PROCEDURE DIVISION.
    PERFORM INICIALIZA-PROGRAMA
    EVALUATE TRUE
        WHEN BUSCA-SINISTRO
            PERFORM PROCESSA-BUSCA
        WHEN AUTORIZA-PAGAMENTO
            PERFORM PROCESSA-AUTORIZACAO
        WHEN OTHER
            PERFORM ERRO-TRANSACAO
    END-EVALUATE
    PERFORM FINALIZA-PROGRAMA
    GOBACK.

PROCESSA-AUTORIZACAO SECTION.
    PERFORM VALIDA-ENTRADA
    PERFORM VALIDA-REGRAS-NEGOCIO
    PERFORM CALCULA-VALORES
    PERFORM INTEGRA-SISTEMAS-EXTERNOS
    IF WS-VALIDACAO-OK
        PERFORM GRAVA-HISTORICO
        PERFORM ATUALIZA-MESTRE
        PERFORM ATUALIZA-FASES
        EXEC CICS SYNCPOINT END-EXEC
    ELSE
        EXEC CICS SYNCPOINT ROLLBACK END-EXEC
    END-IF.</code></pre>
<h3 id="gestão-de-transações-cics">Gestão de Transações CICS</h3>
<h4 id="definição-de-transações">Definição de Transações</h4>
<table>
<thead>
<tr>
<th>Transaction ID</th>
<th>Program</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SI10</strong></td>
<td>SIWEA-V116</td>
<td>Busca de Sinistros</td>
</tr>
<tr>
<td><strong>SI20</strong></td>
<td>SIWEA-V116</td>
<td>Autorização de Pagamento</td>
</tr>
<tr>
<td><strong>SI30</strong></td>
<td>SIWEA-V116</td>
<td>Consulta Histórico</td>
</tr>
<tr>
<td><strong>SI99</strong></td>
<td>SIWEA-V116</td>
<td>Manutenção Sistema</td>
</tr>
</tbody>
</table>
<h4 id="controle-de-concorrência">Controle de Concorrência</h4>
<pre><code>Estratégia: Pessimistic Locking com DB2

1. SELECT FOR UPDATE ao ler TMESTSIN
2. Lock mantido durante toda a transação
3. COMMIT ou ROLLBACK libera o lock
4. Timeout de 120 segundos força ROLLBACK</code></pre>
<hr />
<h2 id="camada-de-dados">Camada de Dados</h2>
<h3 id="ibm-db2-for-zos">IBM DB2 for z/OS</h3>
<h4 id="configuração-do-banco">Configuração do Banco</h4>
<table>
<thead>
<tr>
<th>Parâmetro</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DB2 Version</strong></td>
<td>12 for z/OS</td>
</tr>
<tr>
<td><strong>Buffer Pool</strong></td>
<td>BP1 (32MB)</td>
</tr>
<tr>
<td><strong>Lock Size</strong></td>
<td>ROW</td>
</tr>
<tr>
<td><strong>Isolation Level</strong></td>
<td>CS (Cursor Stability)</td>
</tr>
<tr>
<td><strong>Max Connections</strong></td>
<td>200</td>
</tr>
<tr>
<td><strong>Tablespace Type</strong></td>
<td>Segmented</td>
</tr>
</tbody>
</table>
<h4 id="schema-principal">Schema Principal</h4>
<div class="sourceCode" id="cb8"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Database: DBSIWEA</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Schema: SINISTROS</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> DBSIWEA</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    STOGROUP SGPROD01</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    BUFFERPOOL BP1;</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">USE</span> DBSIWEA;</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">-- Tabelas Principais (resumo)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">-- Ver documento 04-database-model.md para detalhes completos</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> SINISTROS.TMESTSIN (</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Tabela mestre de sinistros</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- 45 colunas, chave: (ORGSIN, RMOSIN, NUMSIN)</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> SINISTROS.THISTSIN (</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Histórico de pagamentos</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- 30 colunas, chave: (ORGSIN, RMOSIN, NUMSIN, SEQHIS)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">-- Índices otimizados</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">UNIQUE</span> <span class="kw">INDEX</span> IX_TMESTSIN_PK</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> TMESTSIN (ORGSIN, RMOSIN, NUMSIN);</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_PROTOCOLO</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> TMESTSIN (FONTE, PROTSINI, DAC);</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_LIDER</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ON</span> TMESTSIN (CODLIDER, SINLID);</span></code></pre></div>
<h4 id="estratégia-de-backup">Estratégia de Backup</h4>
<table>
<thead>
<tr>
<th>Tipo</th>
<th>Frequência</th>
<th>Retenção</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Full Backup</strong></td>
<td>Semanal (Domingo)</td>
<td>90 dias</td>
</tr>
<tr>
<td><strong>Incremental</strong></td>
<td>Diário</td>
<td>30 dias</td>
</tr>
<tr>
<td><strong>Log Backup</strong></td>
<td>A cada 4 horas</td>
<td>7 dias</td>
</tr>
<tr>
<td><strong>Archive Log</strong></td>
<td>Mensal</td>
<td>7 anos</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="integrações-externas">Integrações Externas</h2>
<h3 id="sistemas-de-validação">Sistemas de Validação</h3>
<h4 id="cnoua---sistema-de-consórcio">CNOUA - Sistema de Consórcio</h4>
<pre><code>Protocolo: SOAP/HTTP
Endpoint: http://cnoua.caixaseguradora.com.br:8080/validacao
Timeout: 30 segundos
Retry: 3 tentativas com backoff exponencial

Request:
&lt;validarConsorcio&gt;
    &lt;codigoProduto&gt;6814&lt;/codigoProduto&gt;
    &lt;numeroContrato&gt;123456&lt;/numeroContrato&gt;
    &lt;valorSolicitado&gt;50000.00&lt;/valorSolicitado&gt;
&lt;/validarConsorcio&gt;

Response:
&lt;resultadoValidacao&gt;
    &lt;status&gt;APROVADO&lt;/status&gt;
    &lt;limiteDisponivel&gt;100000.00&lt;/limiteDisponivel&gt;
    &lt;mensagem&gt;Validação aprovada&lt;/mensagem&gt;
&lt;/resultadoValidacao&gt;</code></pre>
<h4 id="sipua---contratos-efp">SIPUA - Contratos EFP</h4>
<pre><code>Protocolo: REST/JSON
Endpoint: https://sipua.caixaseguradora.com.br/api/v1/validate
Method: POST
Timeout: 20 segundos

Request Body:
{
    &quot;contractType&quot;: &quot;EFP&quot;,
    &quot;contractNumber&quot;: &quot;789012&quot;,
    &quot;amount&quot;: 25000.00,
    &quot;claimNumber&quot;: &quot;10/20/789012&quot;
}

Response:
{
    &quot;validated&quot;: true,
    &quot;availableLimit&quot;: 75000.00,
    &quot;expirationDate&quot;: &quot;2025-12-31&quot;
}</code></pre>
<h4 id="simda---contratos-hb">SIMDA - Contratos HB</h4>
<pre><code>Protocolo: MQ Series
Queue Manager: QM.SIMDA.PRD
Request Queue: SIMDA.VALIDATION.REQ
Response Queue: SIMDA.VALIDATION.RSP
Format: Fixed-width text

Request (200 bytes):
Pos 001-010: Contract Number
Pos 011-025: Amount (15,2)
Pos 026-035: Claim Number
Pos 036-200: Filler

Response (100 bytes):
Pos 001-001: Status (A=Approved, R=Rejected)
Pos 002-016: Available Amount (15,2)
Pos 017-100: Message</code></pre>
<h3 id="estratégia-de-fallback">Estratégia de Fallback</h3>
<pre class="mermaid"><code>graph TD
    A[Requisição Validação] --&gt; B{Sistema Online?}
    B --&gt;|Sim| C[Processa Validação]
    B --&gt;|Não| D{Modo Contingência?}
    D --&gt;|Habilitado| E[Aprova com Flag]
    D --&gt;|Desabilitado| F[Rejeita Transação]
    C --&gt; G{Timeout?}
    G --&gt;|Sim| H[Retry com Backoff]
    G --&gt;|Não| I[Retorna Resultado]
    H --&gt; J{Max Retries?}
    J --&gt;|Sim| D
    J --&gt;|Não| B</code></pre>
<hr />
<h2 id="segurança-e-auditoria">Segurança e Auditoria</h2>
<h3 id="autenticação-e-autorização">Autenticação e Autorização</h3>
<h4 id="racf-resource-access-control-facility">RACF (Resource Access
Control Facility)</h4>
<pre><code>User Groups:
- SIWEA_ADMIN    - Administradores do sistema
- SIWEA_OPER     - Operadores de sinistros
- SIWEA_AUDIT    - Auditores (read-only)
- SIWEA_BATCH    - Processos batch

Resources:
- SI.TRANS.*     - Transações CICS
- SI.PROG.*      - Programas COBOL
- SI.DB.*        - Acesso DB2
- SI.MQ.*        - Filas MQ</code></pre>
<h4 id="matriz-de-permissões">Matriz de Permissões</h4>
<table>
<thead>
<tr>
<th>Recurso</th>
<th>ADMIN</th>
<th>OPER</th>
<th>AUDIT</th>
<th>BATCH</th>
</tr>
</thead>
<tbody>
<tr>
<td>Busca Sinistro</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>Autoriza Pagamento</td>
<td>✓</td>
<td>✓</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Consulta Histórico</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>Manutenção Sistema</td>
<td>✓</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>Relatórios</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>Backup/Restore</td>
<td>✓</td>
<td>-</td>
<td>-</td>
<td>✓</td>
</tr>
</tbody>
</table>
<h3 id="auditoria">Auditoria</h3>
<h4 id="log-de-transações">Log de Transações</h4>
<div class="sourceCode" id="cb14"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> SINISTROS.TLOGAUDIT (</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    LOGID        <span class="dt">DECIMAL</span>(<span class="dv">15</span>,<span class="dv">0</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">GENERATED</span> ALWAYS <span class="kw">AS</span> IDENTITY,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    USERID       <span class="dt">CHAR</span>(<span class="dv">8</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    TRANSID      <span class="dt">CHAR</span>(<span class="dv">4</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">TIMESTAMP</span>    <span class="dt">TIMESTAMP</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    TERMINAL     <span class="dt">CHAR</span>(<span class="dv">8</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    PROGRAM      <span class="dt">CHAR</span>(<span class="dv">8</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ACTION       <span class="dt">CHAR</span>(<span class="dv">20</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    BEFORE_VALUE <span class="dt">VARCHAR</span>(<span class="dv">1000</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    AFTER_VALUE  <span class="dt">VARCHAR</span>(<span class="dv">1000</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    STATUS       <span class="dt">CHAR</span>(<span class="dv">1</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    ERROR_MSG    <span class="dt">VARCHAR</span>(<span class="dv">255</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<h4 id="eventos-auditados">Eventos Auditados</h4>
<table>
<thead>
<tr>
<th>Evento</th>
<th>Nível</th>
<th>Retenção</th>
</tr>
</thead>
<tbody>
<tr>
<td>Login/Logout</td>
<td>INFO</td>
<td>90 dias</td>
</tr>
<tr>
<td>Busca Sinistro</td>
<td>INFO</td>
<td>180 dias</td>
</tr>
<tr>
<td>Autorização Pagamento</td>
<td>CRITICAL</td>
<td>7 anos</td>
</tr>
<tr>
<td>Alteração Sistema</td>
<td>WARNING</td>
<td>2 anos</td>
</tr>
<tr>
<td>Erro de Validação</td>
<td>ERROR</td>
<td>1 ano</td>
</tr>
<tr>
<td>Tentativa de Fraude</td>
<td>ALERT</td>
<td>Permanente</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="infraestrutura-de-execução">Infraestrutura de Execução</h2>
<h3 id="ambiente-mainframe">Ambiente Mainframe</h3>
<h4 id="hardware">Hardware</h4>
<pre><code>IBM z15 T02 (8 CPUs)
├── Processadores: 8x z15 5.2 GHz
├── Memória: 256 GB
├── Storage: 50 TB (DASD)
├── Network: 10 Gbps Ethernet
└── Backup: IBM TS7700 Virtual Tape</code></pre>
<h4 id="software-stack">Software Stack</h4>
<table>
<thead>
<tr>
<th>Componente</th>
<th>Versão</th>
<th>Função</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>z/OS</strong></td>
<td>2.4</td>
<td>Sistema Operacional</td>
</tr>
<tr>
<td><strong>CICS TS</strong></td>
<td>5.6</td>
<td>Transaction Manager</td>
</tr>
<tr>
<td><strong>DB2</strong></td>
<td>12.1</td>
<td>Database</td>
</tr>
<tr>
<td><strong>MQ Series</strong></td>
<td>9.2</td>
<td>Message Queue</td>
</tr>
<tr>
<td><strong>RACF</strong></td>
<td>2.4</td>
<td>Security</td>
</tr>
<tr>
<td><strong>JES2</strong></td>
<td>2.4</td>
<td>Job Entry Subsystem</td>
</tr>
<tr>
<td><strong>TSO/ISPF</strong></td>
<td>2.4</td>
<td>Development Environment</td>
</tr>
</tbody>
</table>
<h3 id="topologia-de-rede">Topologia de Rede</h3>
<pre><code>                    Internet/VPN
                         │
                    ┌────┴────┐
                    │Firewall │
                    └────┬────┘
                         │
                 ┌───────┴───────┐
                 │Load Balancer  │
                 └───────┬───────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                 │
   ┌────┴────┐     ┌────┴────┐      ┌────┴────┐
   │Terminal │     │Terminal │      │Terminal │
   │Server 1 │     │Server 2 │      │Server 3 │
   └────┬────┘     └────┬────┘      └────┬────┘
        │                │                 │
        └────────────────┼─────────────────┘
                         │
                    ┌────┴────┐
                    │  CICS   │
                    │ Gateway │
                    └────┬────┘
                         │
                ┌────────┴────────┐
                │   Mainframe     │
                │   z/OS + CICS   │
                │   + DB2 + MQ    │
                └─────────────────┘</code></pre>
<hr />
<h2 id="desempenho-e-escalabilidade">Desempenho e Escalabilidade</h2>
<h3 id="métricas-de-performance">Métricas de Performance</h3>
<h4 id="slas-atuais">SLAs Atuais</h4>
<table>
<thead>
<tr>
<th>Operação</th>
<th>SLA</th>
<th>Performance Real</th>
<th>Percentil 95</th>
</tr>
</thead>
<tbody>
<tr>
<td>Busca Simples</td>
<td>&lt; 5s</td>
<td>2.3s</td>
<td>3.8s</td>
</tr>
<tr>
<td>Busca Complexa</td>
<td>&lt; 10s</td>
<td>4.7s</td>
<td>7.2s</td>
</tr>
<tr>
<td>Autorização</td>
<td>&lt; 120s</td>
<td>45s</td>
<td>89s</td>
</tr>
<tr>
<td>Validação Externa</td>
<td>&lt; 30s</td>
<td>12s</td>
<td>25s</td>
</tr>
<tr>
<td>Commit Transação</td>
<td>&lt; 2s</td>
<td>0.8s</td>
<td>1.5s</td>
</tr>
</tbody>
</table>
<h4 id="capacity-planning">Capacity Planning</h4>
<pre><code>Capacidade Atual:
- Transações Simultâneas: 200
- Transações/Segundo: 50
- Usuários Concorrentes: 500
- Volume Diário: 8.000 transações

Capacidade Máxima:
- Transações Simultâneas: 500
- Transações/Segundo: 150
- Usuários Concorrentes: 1.000
- Volume Diário: 25.000 transações

Crescimento Anual: 15-20%</code></pre>
<h3 id="otimizações-implementadas">Otimizações Implementadas</h3>
<h4 id="database">Database</h4>
<ol type="1">
<li><strong>Índices Otimizados</strong>
<ul>
<li>Cobertura completa para queries frequentes</li>
<li>Estatísticas atualizadas semanalmente</li>
<li>Reorganização mensal de tablespaces</li>
</ul></li>
<li><strong>Buffer Pool Tuning</strong>
<ul>
<li>Hit ratio &gt; 95%</li>
<li>Página size otimizado (4K)</li>
<li>Prefetch habilitado</li>
</ul></li>
<li><strong>Query Optimization</strong>
<ul>
<li>Uso de bind variables</li>
<li>Hints de otimização quando necessário</li>
<li>Paralelismo desabilitado (OLTP)</li>
</ul></li>
</ol>
<h4 id="application">Application</h4>
<ol type="1">
<li><strong>Cache de Dados</strong>
<ul>
<li>Tabelas de referência em memória</li>
<li>Taxa de conversão BTNF cached</li>
<li>Timeout de 1 hora</li>
</ul></li>
<li><strong>Connection Pooling</strong>
<ul>
<li>Pool size: 50-200 (dinâmico)</li>
<li>Idle timeout: 5 minutos</li>
<li>Validation query habilitado</li>
</ul></li>
<li><strong>Código Otimizado</strong>
<ul>
<li>Eliminação de loops desnecessários</li>
<li>Uso de arrays para processamento batch</li>
<li>Early exit em validações</li>
</ul></li>
</ol>
<h3 id="monitoramento">Monitoramento</h3>
<h4 id="ferramentas">Ferramentas</h4>
<table>
<thead>
<tr>
<th>Ferramenta</th>
<th>Função</th>
<th>Frequência</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>IBM Omegamon</strong></td>
<td>Performance CICS/DB2</td>
<td>Real-time</td>
</tr>
<tr>
<td><strong>IBM Tivoli</strong></td>
<td>System Monitoring</td>
<td>1 minuto</td>
</tr>
<tr>
<td><strong>CA SYSVIEW</strong></td>
<td>Resource Usage</td>
<td>5 minutos</td>
</tr>
<tr>
<td><strong>BMC MainView</strong></td>
<td>Application Performance</td>
<td>Real-time</td>
</tr>
</tbody>
</table>
<h4 id="kpis-monitorados">KPIs Monitorados</h4>
<pre><code>Sistema:
├── CPU Utilization (&lt; 70%)
├── Memory Usage (&lt; 80%)
├── I/O Wait Time (&lt; 10%)
├── Page Faults/sec (&lt; 100)
└── Network Latency (&lt; 50ms)

Aplicação:
├── Response Time Average
├── Transaction Rate
├── Error Rate (&lt; 1%)
├── Queue Depth
└── Active Sessions

Database:
├── Lock Waits
├── Deadlocks
├── Buffer Hit Ratio
├── Log Write Time
└── Active Connections</code></pre>
<hr />
<h2 id="disaster-recovery-e-continuidade">Disaster Recovery e
Continuidade</h2>
<h3 id="estratégia-de-dr">Estratégia de DR</h3>
<h4 id="rto-e-rpo">RTO e RPO</h4>
<table>
<thead>
<tr>
<th>Componente</th>
<th>RTO</th>
<th>RPO</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sistema Completo</strong></td>
<td>4 horas</td>
<td>1 hora</td>
</tr>
<tr>
<td><strong>Database</strong></td>
<td>2 horas</td>
<td>30 minutos</td>
</tr>
<tr>
<td><strong>Aplicação</strong></td>
<td>1 hora</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Rede</strong></td>
<td>30 minutos</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h4 id="site-de-contingência">Site de Contingência</h4>
<pre><code>Site Principal (São Paulo)
         │
         │ Replicação Síncrona
         │ (PPRC - Peer-to-Peer Remote Copy)
         │
         ↓
Site Contingência (Rio de Janeiro)</code></pre>
<h3 id="procedimentos-de-failover">Procedimentos de Failover</h3>
<ol type="1">
<li><strong>Detecção de Falha</strong> (0-15 min)
<ul>
<li>Alertas automáticos</li>
<li>Validação manual</li>
<li>Decisão de failover</li>
</ul></li>
<li><strong>Ativação DR</strong> (15-60 min)
<ul>
<li>Stop no site principal</li>
<li>Promote site secundário</li>
<li>Redirecionamento de rede</li>
</ul></li>
<li><strong>Validação</strong> (60-120 min)
<ul>
<li>Testes de conectividade</li>
<li>Verificação de integridade</li>
<li>Liberação para produção</li>
</ul></li>
<li><strong>Operação em Contingência</strong> (120-240 min)
<ul>
<li>Monitoramento intensivo</li>
<li>Comunicação aos usuários</li>
<li>Registro de incidentes</li>
</ul></li>
</ol>
<hr />
<h2 id="considerações-para-migração">Considerações para Migração</h2>
<h3 id="desafios-técnicos">Desafios Técnicos</h3>
<ol type="1">
<li><strong>Conversão de Código</strong>
<ul>
<li>COBOL/EZEE → C#/.NET</li>
<li>CICS → ASP.NET Core</li>
<li>3270 → Web/React</li>
</ul></li>
<li><strong>Migração de Dados</strong>
<ul>
<li>EBCDIC → UTF-8</li>
<li>DB2 → SQL Server/PostgreSQL</li>
<li>Tipos de dados específicos</li>
</ul></li>
<li><strong>Mudança de Paradigma</strong>
<ul>
<li>Monolítico → Microserviços</li>
<li>Síncrono → Assíncrono</li>
<li>Batch → Real-time</li>
</ul></li>
</ol>
<h3 id="requisitos-de-paridade">Requisitos de Paridade</h3>
<table>
<thead>
<tr>
<th>Funcionalidade</th>
<th>Criticidade</th>
<th>Complexidade</th>
</tr>
</thead>
<tbody>
<tr>
<td>Busca de Sinistros</td>
<td>Alta</td>
<td>Baixa</td>
</tr>
<tr>
<td>Autorização Pagamento</td>
<td>Crítica</td>
<td>Alta</td>
</tr>
<tr>
<td>Validação Regras</td>
<td>Crítica</td>
<td>Muito Alta</td>
</tr>
<tr>
<td>Integração Externa</td>
<td>Alta</td>
<td>Média</td>
</tr>
<tr>
<td>Gestão de Fases</td>
<td>Média</td>
<td>Alta</td>
</tr>
<tr>
<td>Auditoria</td>
<td>Crítica</td>
<td>Média</td>
</tr>
</tbody>
</table>
<h3 id="estratégia-de-migração-recomendada-1">Estratégia de Migração
Recomendada</h3>
<pre class="mermaid"><code>graph LR
    A[Análise] --&gt; B[POC]
    B --&gt; C[Pilot]
    C --&gt; D[Parallel Run]
    D --&gt; E[Cutover]
    E --&gt; F[Decommission]

    style A fill:#90EE90
    style B fill:#90EE90
    style C fill:#FFFFE0
    style D fill:#FFFFE0
    style E fill:#FFE4B5
    style F fill:#FFE4B5</code></pre>
<ul>
<li><strong>Verde</strong>: Fases concluídas</li>
<li><strong>Amarelo</strong>: Fases em andamento</li>
<li><strong>Laranja</strong>: Fases futuras</li>
</ul>
<hr />
<p><em>Este documento é parte da documentação técnica completa do
sistema SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025 <strong>Próxima
Revisão:</strong> Após conclusão do POC</p>
<hr />
<h1 id="estruturas-de-dados-sistema-legado-siwea">03 - Estruturas de
Dados: Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-das-estruturas">Visão Geral das Estruturas</h2>
<h3 id="categorização-das-estruturas">Categorização das Estruturas</h3>
<table>
<thead>
<tr>
<th>Categoria</th>
<th>Quantidade</th>
<th>Propósito</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Working Storage</strong></td>
<td>45</td>
<td>Variáveis de trabalho e flags</td>
</tr>
<tr>
<td><strong>Copy Books</strong></td>
<td>12</td>
<td>Estruturas reutilizáveis</td>
</tr>
<tr>
<td><strong>Record Layouts</strong></td>
<td>13</td>
<td>Layouts de tabelas DB2</td>
</tr>
<tr>
<td><strong>Screen Maps</strong></td>
<td>2</td>
<td>Mapas de tela CICS</td>
</tr>
<tr>
<td><strong>Interface Areas</strong></td>
<td>8</td>
<td>Comunicação entre programas</td>
</tr>
<tr>
<td><strong>Message Structures</strong></td>
<td>3</td>
<td>Integração com sistemas externos</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="working-storage-section">Working Storage Section</h2>
<h3 id="estrutura-principal-de-controle">Estrutura Principal de
Controle</h3>
<pre class="cobol"><code>01  WS-CONTROL-AREA.
    05  WS-PROGRAM-ID           PIC X(08) VALUE &#39;SIWEA116&#39;.
    05  WS-VERSION              PIC X(03) VALUE &#39;V90&#39;.
    05  WS-TRANSACTION-ID       PIC X(04).
    05  WS-USER-ID              PIC X(08).
    05  WS-TERMINAL-ID          PIC X(08).
    05  WS-CURRENT-DATE         PIC 9(08).
    05  WS-CURRENT-TIME         PIC 9(06).
    05  WS-BUSINESS-DATE        PIC 9(08).
    05  WS-RETURN-CODE          PIC S9(04) COMP.
    05  WS-ERROR-FLAG           PIC X(01).
        88  NO-ERROR            VALUE &#39;N&#39;.
        88  ERROR-OCCURRED      VALUE &#39;Y&#39;.
    05  WS-PROCESS-MODE         PIC X(02).
        88  SEARCH-MODE         VALUE &#39;SE&#39;.
        88  AUTH-MODE           VALUE &#39;AU&#39;.
        88  HISTORY-MODE        VALUE &#39;HI&#39;.</code></pre>
<h3 id="estrutura-de-sinistro-de-trabalho">Estrutura de Sinistro de
Trabalho</h3>
<pre class="cobol"><code>01  WS-CLAIM-WORK-AREA.
    05  WS-CLAIM-KEY.
        10  WS-INSURANCE-TYPE   PIC 9(02).
        10  WS-CLAIM-ORIGIN     PIC 9(02).
        10  WS-CLAIM-BRANCH     PIC 9(02).
        10  WS-CLAIM-NUMBER     PIC 9(06).

    05  WS-PROTOCOL-KEY.
        10  WS-PROTOCOL-SOURCE  PIC 9(03).
        10  WS-PROTOCOL-NUMBER  PIC 9(07).
        10  WS-PROTOCOL-CHECK   PIC 9(01).

    05  WS-LEADER-KEY.
        10  WS-LEADER-CODE      PIC 9(03).
        10  WS-LEADER-CLAIM     PIC 9(07).

    05  WS-FINANCIAL-DATA.
        10  WS-EXPECTED-RESERVE PIC 9(13)V99 COMP-3.
        10  WS-TOTAL-PAID       PIC 9(13)V99 COMP-3.
        10  WS-PENDING-VALUE    PIC 9(13)V99 COMP-3.
        10  WS-PRINCIPAL-VALUE  PIC 9(13)V99 COMP-3.
        10  WS-CORRECTION-VALUE PIC 9(13)V99 COMP-3.
        10  WS-BTNF-VALUE       PIC 9(13)V99 COMP-3.
        10  WS-CONVERSION-RATE  PIC 9(10)V9(8) COMP-3.</code></pre>
<h3 id="estrutura-de-autorização">Estrutura de Autorização</h3>
<pre class="cobol"><code>01  WS-AUTHORIZATION-AREA.
    05  WS-AUTH-HEADER.
        10  WS-AUTH-DATE        PIC 9(08).
        10  WS-AUTH-TIME        PIC 9(06).
        10  WS-AUTH-USER        PIC X(08).
        10  WS-AUTH-TERMINAL    PIC X(08).

    05  WS-AUTH-DATA.
        10  WS-PAYMENT-TYPE     PIC 9(01).
            88  TOTAL-PAYMENT   VALUE 1.
            88  PARTIAL-PAYMENT VALUE 2.
            88  COMPLEMENT-PAY  VALUE 3.
            88  ADJUSTMENT-PAY  VALUE 4.
            88  RECALC-PAYMENT  VALUE 5.

        10  WS-POLICY-TYPE      PIC 9(01).
            88  INDIVIDUAL      VALUE 1.
            88  COLLECTIVE      VALUE 2.

        10  WS-BENEFICIARY      PIC X(50).
        10  WS-OPERATION-CODE   PIC 9(04) VALUE 1098.
        10  WS-CORRECTION-TYPE  PIC X(01) VALUE &#39;5&#39;.</code></pre>
<h3 id="flags-de-controle">Flags de Controle</h3>
<pre class="cobol"><code>01  WS-FLAGS.
    05  WS-SEARCH-FLAGS.
        10  WS-SEARCH-BY-PROTOCOL   PIC X(01).
            88  SEARCH-PROTOCOL      VALUE &#39;Y&#39;.
        10  WS-SEARCH-BY-CLAIM      PIC X(01).
            88  SEARCH-CLAIM         VALUE &#39;Y&#39;.
        10  WS-SEARCH-BY-LEADER     PIC X(01).
            88  SEARCH-LEADER        VALUE &#39;Y&#39;.
        10  WS-CLAIM-FOUND          PIC X(01).
            88  CLAIM-EXISTS         VALUE &#39;Y&#39;.
            88  CLAIM-NOT-FOUND      VALUE &#39;N&#39;.

    05  WS-VALIDATION-FLAGS.
        10  WS-PAYMENT-VALID        PIC X(01).
            88  PAYMENT-OK           VALUE &#39;Y&#39;.
        10  WS-AMOUNT-VALID         PIC X(01).
            88  AMOUNT-OK            VALUE &#39;Y&#39;.
        10  WS-BENEFICIARY-VALID    PIC X(01).
            88  BENEFICIARY-OK       VALUE &#39;Y&#39;.
        10  WS-EXTERNAL-VALID       PIC X(01).
            88  EXTERNAL-OK          VALUE &#39;Y&#39;.

    05  WS-INTEGRATION-FLAGS.
        10  WS-CNOUA-REQUIRED       PIC X(01).
            88  NEEDS-CNOUA          VALUE &#39;Y&#39;.
        10  WS-SIPUA-REQUIRED       PIC X(01).
            88  NEEDS-SIPUA          VALUE &#39;Y&#39;.
        10  WS-SIMDA-REQUIRED       PIC X(01).
            88  NEEDS-SIMDA          VALUE &#39;Y&#39;.
        10  WS-CONTINGENCY-MODE     PIC X(01).
            88  IN-CONTINGENCY       VALUE &#39;Y&#39;.</code></pre>
<hr />
<h2 id="copy-books">Copy Books</h2>
<h3 id="claim-record---layout-do-registro-de-sinistro">CLAIM-RECORD -
Layout do Registro de Sinistro</h3>
<pre class="cobol"><code>      * CLAIM-RECORD.CPY - Layout completo do sinistro
       01  CLAIM-RECORD.
           05  CLM-KEY.
               10  CLM-INSURANCE-TYPE      PIC 9(02).
               10  CLM-ORIGIN              PIC 9(02).
               10  CLM-BRANCH              PIC 9(02).
               10  CLM-NUMBER              PIC 9(06).

           05  CLM-PROTOCOL.
               10  CLM-PROT-SOURCE         PIC 9(03).
               10  CLM-PROT-NUMBER         PIC 9(07).
               10  CLM-PROT-CHECK          PIC 9(01).

           05  CLM-POLICY.
               10  CLM-POL-ORIGIN          PIC 9(02).
               10  CLM-POL-BRANCH          PIC 9(02).
               10  CLM-POL-NUMBER          PIC 9(08).

           05  CLM-FINANCIAL.
               10  CLM-EXPECTED-RESERVE    PIC S9(13)V99 COMP-3.
               10  CLM-TOTAL-PAID          PIC S9(13)V99 COMP-3.
               10  CLM-PRODUCT-CODE        PIC 9(04).
               10  CLM-POLICY-TYPE         PIC X(01).
               10  CLM-INSURANCE-TYPE-POL  PIC 9(02).

           05  CLM-LEADER REDEFINES CLM-FINANCIAL.
               10  CLM-LEADER-CODE         PIC 9(03).
               10  CLM-LEADER-CLAIM        PIC 9(07).
               10  FILLER                  PIC X(25).

           05  CLM-COUNTER                 PIC 9(05).
           05  CLM-STATUS                  PIC X(02).
               88  CLM-ACTIVE              VALUE &#39;AT&#39;.
               88  CLM-CLOSED              VALUE &#39;EN&#39;.
               88  CLM-CANCELLED           VALUE &#39;CA&#39;.</code></pre>
<h3 id="history-record---layout-do-histórico">HISTORY-RECORD - Layout do
Histórico</h3>
<pre class="cobol"><code>      * HISTORY-RECORD.CPY - Layout do registro de histórico
       01  HISTORY-RECORD.
           05  HST-KEY.
               10  HST-INSURANCE-TYPE      PIC 9(02).
               10  HST-ORIGIN              PIC 9(02).
               10  HST-BRANCH              PIC 9(02).
               10  HST-NUMBER              PIC 9(06).
               10  HST-SEQUENCE            PIC 9(05).

           05  HST-AUTHORIZATION.
               10  HST-AUTH-DATE           PIC 9(08).
               10  HST-AUTH-TIME           PIC 9(06).
               10  HST-AUTH-USER           PIC X(08).
               10  HST-AUTH-TERMINAL       PIC X(08).

           05  HST-PAYMENT.
               10  HST-PAYMENT-TYPE        PIC 9(01).
               10  HST-POLICY-TYPE         PIC 9(01).
               10  HST-PRINCIPAL-VALUE     PIC S9(13)V99 COMP-3.
               10  HST-CORRECTION-VALUE    PIC S9(13)V99 COMP-3.
               10  HST-TOTAL-VALUE         PIC S9(13)V99 COMP-3.
               10  HST-BTNF-VALUE          PIC S9(13)V99 COMP-3.
               10  HST-CONVERSION-RATE     PIC 9(10)V9(8) COMP-3.

           05  HST-BENEFICIARY             PIC X(50).
           05  HST-OPERATION-CODE          PIC 9(04).
           05  HST-CORRECTION-TYPE         PIC X(01).
           05  HST-STATUS                  PIC X(02).
               88  HST-APPROVED            VALUE &#39;AP&#39;.
               88  HST-REJECTED            VALUE &#39;RJ&#39;.
               88  HST-PENDING             VALUE &#39;PE&#39;.</code></pre>
<h3 id="error-messages---mensagens-de-erro">ERROR-MESSAGES - Mensagens
de Erro</h3>
<pre class="cobol"><code>      * ERROR-MESSAGES.CPY - Tabela de mensagens
       01  ERROR-MESSAGE-TABLE.
           05  ERROR-ENTRY OCCURS 24 TIMES.
               10  ERR-CODE                PIC X(05).
               10  ERR-SEVERITY            PIC 9(01).
                   88  ERR-INFO            VALUE 1.
                   88  ERR-WARNING         VALUE 2.
                   88  ERR-ERROR           VALUE 3.
                   88  ERR-FATAL           VALUE 4.
               10  ERR-TEXT-PT             PIC X(100).
               10  ERR-TEXT-EN             PIC X(100).

       01  ERROR-MESSAGES-DATA.
           05  FILLER.
               10  FILLER PIC X(05) VALUE &#39;E0001&#39;.
               10  FILLER PIC 9(01) VALUE 3.
               10  FILLER PIC X(100) VALUE
                   &#39;Sinistro não encontrado&#39;.
               10  FILLER PIC X(100) VALUE
                   &#39;Claim not found&#39;.

           05  FILLER.
               10  FILLER PIC X(05) VALUE &#39;E0002&#39;.
               10  FILLER PIC 9(01) VALUE 3.
               10  FILLER PIC X(100) VALUE
                   &#39;Tipo de pagamento inválido (deve ser 1-5)&#39;.
               10  FILLER PIC X(100) VALUE
                   &#39;Invalid payment type (must be 1-5)&#39;.

           05  FILLER.
               10  FILLER PIC X(05) VALUE &#39;E0003&#39;.
               10  FILLER PIC 9(01) VALUE 3.
               10  FILLER PIC X(100) VALUE
                   &#39;Valor principal obrigatório&#39;.
               10  FILLER PIC X(100) VALUE
                   &#39;Principal value required&#39;.</code></pre>
<hr />
<h2 id="interface-com-banco-de-dados">Interface com Banco de Dados</h2>
<h3 id="sql-communication-area">SQL Communication Area</h3>
<pre class="cobol"><code>01  WS-SQL-AREAS.
    05  WS-SQLCODE              PIC S9(09) COMP.
        88  SQL-SUCCESS         VALUE 0.
        88  SQL-NOT-FOUND       VALUE +100.
        88  SQL-DUPLICATE       VALUE -803.
        88  SQL-DEADLOCK        VALUE -911 -913.

    05  WS-SQLSTATE             PIC X(05).
    05  WS-SQLERRM.
        10  WS-SQLERRML         PIC S9(04) COMP.
        10  WS-SQLERRMC         PIC X(70).

    05  WS-ROW-COUNT            PIC S9(09) COMP.</code></pre>
<h3 id="host-variables-para-db2">Host Variables para DB2</h3>
<pre class="cobol"><code>01  HV-TMESTSIN.
    05  HV-TIPSEG               PIC S9(02) COMP.
    05  HV-ORGSIN               PIC S9(02) COMP.
    05  HV-RMOSIN               PIC S9(02) COMP.
    05  HV-NUMSIN               PIC S9(06) COMP.
    05  HV-FONTE                PIC S9(03) COMP.
    05  HV-PROTSINI             PIC S9(07) COMP.
    05  HV-DAC                  PIC S9(01) COMP.
    05  HV-ORGAPO               PIC S9(02) COMP.
    05  HV-RMOAPO               PIC S9(02) COMP.
    05  HV-NUMAPOL              PIC S9(08) COMP.
    05  HV-SDOPAG               PIC S9(13)V99 COMP-3.
    05  HV-TOTPAG               PIC S9(13)V99 COMP-3.
    05  HV-CODPRODU             PIC S9(04) COMP.
    05  HV-TIPREG               PIC X(01).
    05  HV-TPSEGU               PIC S9(02) COMP.
    05  HV-CODLIDER             PIC S9(03) COMP.
    05  HV-SINLID               PIC S9(07) COMP.
    05  HV-OCORHIST             PIC S9(05) COMP.

01  HV-INDICATOR-VARIABLES.
    05  HV-IND-CODLIDER         PIC S9(04) COMP.
    05  HV-IND-SINLID           PIC S9(04) COMP.</code></pre>
<h3 id="cursores-sql">Cursores SQL</h3>
<pre class="cobol"><code>      * Cursor para busca por protocolo
       EXEC SQL
           DECLARE CURSOR-PROTOCOL CURSOR FOR
           SELECT TIPSEG, ORGSIN, RMOSIN, NUMSIN,
                  FONTE, PROTSINI, DAC,
                  ORGAPO, RMOAPO, NUMAPOL,
                  SDOPAG, TOTPAG, CODPRODU,
                  TIPREG, TPSEGU, CODLIDER,
                  SINLID, OCORHIST
           FROM   TMESTSIN
           WHERE  FONTE = :HV-FONTE
           AND    PROTSINI = :HV-PROTSINI
           AND    DAC = :HV-DAC
           FOR READ ONLY
       END-EXEC.

      * Cursor para busca por sinistro
       EXEC SQL
           DECLARE CURSOR-CLAIM CURSOR FOR
           SELECT TIPSEG, ORGSIN, RMOSIN, NUMSIN,
                  FONTE, PROTSINI, DAC,
                  ORGAPO, RMOAPO, NUMAPOL,
                  SDOPAG, TOTPAG, CODPRODU,
                  TIPREG, TPSEGU, CODLIDER,
                  SINLID, OCORHIST
           FROM   TMESTSIN
           WHERE  ORGSIN = :HV-ORGSIN
           AND    RMOSIN = :HV-RMOSIN
           AND    NUMSIN = :HV-NUMSIN
           FOR UPDATE OF TOTPAG, OCORHIST
       END-EXEC.</code></pre>
<hr />
<h2 id="estruturas-de-integração-externa">Estruturas de Integração
Externa</h2>
<h3 id="cnoua---mensagem-de-validação-de-consórcio">CNOUA - Mensagem de
Validação de Consórcio</h3>
<pre class="cobol"><code>01  CNOUA-REQUEST-MESSAGE.
    05  CNOUA-HEADER.
        10  CNOUA-MESSAGE-ID        PIC X(20).
        10  CNOUA-TIMESTAMP         PIC X(26).
        10  CNOUA-SOURCE-SYSTEM     PIC X(10) VALUE &#39;SIWEA&#39;.
        10  CNOUA-VERSION           PIC X(05) VALUE &#39;01.00&#39;.

    05  CNOUA-BODY.
        10  CNOUA-PRODUCT-CODE      PIC 9(04).
        10  CNOUA-CONTRACT-NUMBER   PIC 9(12).
        10  CNOUA-CLAIM-NUMBER      PIC X(12).
        10  CNOUA-REQUESTED-AMOUNT  PIC 9(13)V99.
        10  CNOUA-OPERATION-TYPE    PIC X(03) VALUE &#39;VAL&#39;.

01  CNOUA-RESPONSE-MESSAGE.
    05  CNOUA-RESP-HEADER.
        10  CNOUA-RESP-MESSAGE-ID   PIC X(20).
        10  CNOUA-RESP-TIMESTAMP    PIC X(26).
        10  CNOUA-RESP-STATUS       PIC X(02).
            88  CNOUA-APPROVED       VALUE &#39;AP&#39;.
            88  CNOUA-REJECTED       VALUE &#39;RJ&#39;.
            88  CNOUA-ERROR          VALUE &#39;ER&#39;.

    05  CNOUA-RESP-BODY.
        10  CNOUA-RESP-CODE         PIC X(05).
        10  CNOUA-RESP-MESSAGE      PIC X(100).
        10  CNOUA-AVAILABLE-LIMIT   PIC 9(13)V99.
        10  CNOUA-EXPIRATION-DATE   PIC 9(08).</code></pre>
<h3 id="sipua---mensagem-de-validação-efp">SIPUA - Mensagem de Validação
EFP</h3>
<pre class="cobol"><code>01  SIPUA-REQUEST-RECORD.
    05  SIPUA-CONTRACT-TYPE         PIC X(03) VALUE &#39;EFP&#39;.
    05  SIPUA-CONTRACT-NUMBER       PIC X(12).
    05  SIPUA-AMOUNT                PIC 9(13)V99.
    05  SIPUA-CLAIM-NUMBER          PIC X(12).
    05  SIPUA-REQUEST-DATE          PIC 9(08).
    05  SIPUA-REQUEST-TIME          PIC 9(06).

01  SIPUA-RESPONSE-RECORD.
    05  SIPUA-VALIDATED             PIC X(01).
        88  SIPUA-VALID             VALUE &#39;Y&#39;.
        88  SIPUA-INVALID           VALUE &#39;N&#39;.
    05  SIPUA-AVAILABLE-LIMIT       PIC 9(13)V99.
    05  SIPUA-EXPIRATION-DATE       PIC 9(08).
    05  SIPUA-REJECT-REASON         PIC X(50).</code></pre>
<h3 id="simda---mensagem-de-validação-hb">SIMDA - Mensagem de Validação
HB</h3>
<pre class="cobol"><code>01  SIMDA-MESSAGE-FORMAT.
    05  SIMDA-REQUEST.
        10  SIMDA-CONTRACT-NUM      PIC X(10).
        10  SIMDA-AMOUNT            PIC 9(13)V99.
        10  SIMDA-CLAIM-NUM         PIC X(10).
        10  FILLER                  PIC X(165).

    05  SIMDA-RESPONSE.
        10  SIMDA-STATUS            PIC X(01).
            88  SIMDA-APPROVED      VALUE &#39;A&#39;.
            88  SIMDA-REJECTED      VALUE &#39;R&#39;.
            88  SIMDA-PENDING       VALUE &#39;P&#39;.
        10  SIMDA-AVAILABLE-AMT     PIC 9(13)V99.
        10  SIMDA-MESSAGE           PIC X(84).</code></pre>
<hr />
<h2 id="estruturas-de-comunicação-cics">Estruturas de Comunicação
CICS</h2>
<h3 id="commarea---área-de-comunicação">COMMAREA - Área de
Comunicação</h3>
<pre class="cobol"><code>01  DFHCOMMAREA.
    05  CA-REQUEST-TYPE             PIC X(04).
        88  CA-SEARCH               VALUE &#39;SRCH&#39;.
        88  CA-AUTHORIZE            VALUE &#39;AUTH&#39;.
        88  CA-HISTORY              VALUE &#39;HIST&#39;.
        88  CA-CANCEL               VALUE &#39;CANC&#39;.

    05  CA-RESPONSE-CODE            PIC S9(04) COMP.
        88  CA-SUCCESS              VALUE 0.
        88  CA-NOT-FOUND            VALUE 4.
        88  CA-INVALID-DATA         VALUE 8.
        88  CA-SYSTEM-ERROR         VALUE 12.

    05  CA-CLAIM-DATA.
        10  CA-CLAIM-KEY.
            15  CA-INSURANCE-TYPE   PIC 9(02).
            15  CA-ORIGIN           PIC 9(02).
            15  CA-BRANCH           PIC 9(02).
            15  CA-NUMBER           PIC 9(06).

        10  CA-PROTOCOL-KEY.
            15  CA-PROT-SOURCE      PIC 9(03).
            15  CA-PROT-NUMBER      PIC 9(07).
            15  CA-PROT-CHECK       PIC 9(01).

    05  CA-AUTH-DATA.
        10  CA-PAYMENT-TYPE         PIC 9(01).
        10  CA-POLICY-TYPE          PIC 9(01).
        10  CA-PRINCIPAL-VALUE      PIC 9(13)V99.
        10  CA-CORRECTION-VALUE     PIC 9(13)V99.
        10  CA-BENEFICIARY          PIC X(50).

    05  CA-ERROR-MESSAGE            PIC X(100).
    05  CA-USER-ID                  PIC X(08).
    05  CA-TERMINAL-ID              PIC X(08).</code></pre>
<h3 id="eib---execute-interface-block">EIB - Execute Interface
Block</h3>
<pre class="cobol"><code>      * Estrutura implícita do CICS EIB
      * Acessada via DFHEIBLK

      * Principais campos utilizados:
      * EIBCALEN - Comprimento da COMMAREA
      * EIBAID   - Tecla de atenção pressionada
      * EIBTRNID - ID da transação
      * EIBTRMID - ID do terminal
      * EIBDATE  - Data do sistema
      * EIBTIME  - Hora do sistema
      * EIBRESP  - Código de resposta
      * EIBRESP2 - Código de resposta secundário</code></pre>
<hr />
<h2 id="tabelas-de-configuração">Tabelas de Configuração</h2>
<h3 id="tabela-de-produtos-para-roteamento">Tabela de Produtos para
Roteamento</h3>
<pre class="cobol"><code>01  PRODUCT-ROUTING-TABLE.
    05  PRODUCT-ENTRY OCCURS 50 TIMES
        INDEXED BY PROD-IDX.
        10  PROD-CODE               PIC 9(04).
        10  PROD-SYSTEM             PIC X(05).
            88  ROUTE-TO-CNOUA      VALUE &#39;CNOUA&#39;.
            88  ROUTE-TO-SIPUA      VALUE &#39;SIPUA&#39;.
            88  ROUTE-TO-SIMDA      VALUE &#39;SIMDA&#39;.
            88  NO-ROUTING          VALUE &#39;NONE &#39;.
        10  PROD-DESCRIPTION        PIC X(30).

01  PRODUCT-ROUTING-DATA.
    05  FILLER.
        10  FILLER PIC 9(04) VALUE 6814.
        10  FILLER PIC X(05) VALUE &#39;CNOUA&#39;.
        10  FILLER PIC X(30) VALUE &#39;CONSORCIO TIPO A&#39;.
    05  FILLER.
        10  FILLER PIC 9(04) VALUE 7701.
        10  FILLER PIC X(05) VALUE &#39;CNOUA&#39;.
        10  FILLER PIC X(30) VALUE &#39;CONSORCIO TIPO B&#39;.
    05  FILLER.
        10  FILLER PIC 9(04) VALUE 7709.
        10  FILLER PIC X(05) VALUE &#39;CNOUA&#39;.
        10  FILLER PIC X(30) VALUE &#39;CONSORCIO ESPECIAL&#39;.</code></pre>
<h3 id="tabela-de-fases-e-eventos">Tabela de Fases e Eventos</h3>
<pre class="cobol"><code>01  PHASE-EVENT-TABLE.
    05  PHASE-ENTRY OCCURS 20 TIMES.
        10  PHASE-CODE              PIC 9(03).
        10  PHASE-NAME              PIC X(30).
        10  PHASE-EVENT             PIC 9(03).
        10  PHASE-NEXT              PIC 9(03).
        10  PHASE-AUTO-CLOSE        PIC X(01).
            88  AUTO-CLOSE-YES      VALUE &#39;Y&#39;.
            88  AUTO-CLOSE-NO       VALUE &#39;N&#39;.

01  PHASE-EVENT-DATA.
    05  FILLER.
        10  FILLER PIC 9(03) VALUE 001.
        10  FILLER PIC X(30) VALUE &#39;ABERTURA SINISTRO&#39;.
        10  FILLER PIC 9(03) VALUE 100.
        10  FILLER PIC 9(03) VALUE 002.
        10  FILLER PIC X(01) VALUE &#39;N&#39;.
    05  FILLER.
        10  FILLER PIC 9(03) VALUE 002.
        10  FILLER PIC X(30) VALUE &#39;ANALISE DOCUMENTACAO&#39;.
        10  FILLER PIC 9(03) VALUE 200.
        10  FILLER PIC 9(03) VALUE 003.
        10  FILLER PIC X(01) VALUE &#39;N&#39;.
    05  FILLER.
        10  FILLER PIC 9(03) VALUE 003.
        10  FILLER PIC X(30) VALUE &#39;AUTORIZACAO PAGAMENTO&#39;.
        10  FILLER PIC 9(03) VALUE 300.
        10  FILLER PIC 9(03) VALUE 004.
        10  FILLER PIC X(01) VALUE &#39;Y&#39;.</code></pre>
<hr />
<h2 id="estruturas-de-performance">Estruturas de Performance</h2>
<h3 id="contadores-e-estatísticas">Contadores e Estatísticas</h3>
<pre class="cobol"><code>01  WS-PERFORMANCE-COUNTERS.
    05  WS-TRANSACTION-COUNT        PIC 9(09) COMP.
    05  WS-DB-CALLS                 PIC 9(09) COMP.
    05  WS-DB-READS                 PIC 9(09) COMP.
    05  WS-DB-WRITES                PIC 9(09) COMP.
    05  WS-DB-UPDATES               PIC 9(09) COMP.
    05  WS-EXTERNAL-CALLS           PIC 9(09) COMP.
    05  WS-CACHE-HITS               PIC 9(09) COMP.
    05  WS-CACHE-MISSES             PIC 9(09) COMP.

01  WS-TIMING-AREAS.
    05  WS-START-TIME               PIC 9(08).
    05  WS-END-TIME                 PIC 9(08).
    05  WS-ELAPSED-TIME             PIC 9(08).
    05  WS-DB-TIME                  PIC 9(08).
    05  WS-EXTERNAL-TIME            PIC 9(08).
    05  WS-CPU-TIME                 PIC 9(08).</code></pre>
<hr />
<h2 id="considerações-para-migração-1">Considerações para Migração</h2>
<h3 id="mapeamento-de-tipos">Mapeamento de Tipos</h3>
<table>
<thead>
<tr>
<th>COBOL Type</th>
<th>.NET Type</th>
<th>Observações</th>
</tr>
</thead>
<tbody>
<tr>
<td>PIC 9(n)</td>
<td>int/long</td>
<td>Depende do tamanho</td>
</tr>
<tr>
<td>PIC S9(n) COMP</td>
<td>short/int</td>
<td>Com sinal</td>
</tr>
<tr>
<td>PIC 9(n)V99</td>
<td>decimal</td>
<td>Precisão monetária</td>
</tr>
<tr>
<td>PIC X(n)</td>
<td>string</td>
<td>Máximo length</td>
</tr>
<tr>
<td>COMP-3</td>
<td>decimal</td>
<td>Packed decimal</td>
</tr>
<tr>
<td>88 levels</td>
<td>enum</td>
<td>Valores nomeados</td>
</tr>
</tbody>
</table>
<h3 id="pontos-de-atenção">Pontos de Atenção</h3>
<ol type="1">
<li><strong>REDEFINES</strong>: Requer union types ou classes
separadas</li>
<li><strong>OCCURS</strong>: Mapear para List<T> ou arrays</li>
<li><strong>INDEXED BY</strong>: Usar Dictionary&lt;K,V&gt; quando
apropriado</li>
<li><strong>88 Levels</strong>: Converter para enums ou constants</li>
<li><strong>COMP-3</strong>: Cuidado com conversão de packed
decimal</li>
<li><strong>EBCDIC</strong>: Conversão para UTF-8 necessária</li>
</ol>
<hr />
<p><em>Este documento detalha todas as estruturas de dados utilizadas
pelo sistema SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025 <strong>Próxima
Revisão:</strong> Após implementação das entidades em .NET</p>
<hr />
<h1 id="modelo-de-banco-de-dados-sistema-legado-siwea">04 - Modelo de
Banco de Dados: Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-do-modelo">Visão Geral do Modelo</h2>
<h3 id="estatísticas-do-banco-de-dados">Estatísticas do Banco de
Dados</h3>
<table>
<thead>
<tr>
<th>Métrica</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Total de Tabelas</strong></td>
<td>13</td>
</tr>
<tr>
<td><strong>Tabelas Legadas</strong></td>
<td>10</td>
</tr>
<tr>
<td><strong>Tabelas Dashboard</strong></td>
<td>3</td>
</tr>
<tr>
<td><strong>Total de Campos</strong></td>
<td>287</td>
</tr>
<tr>
<td><strong>Índices</strong></td>
<td>42</td>
</tr>
<tr>
<td><strong>Constraints</strong></td>
<td>68</td>
</tr>
<tr>
<td><strong>Stored Procedures</strong></td>
<td>5</td>
</tr>
<tr>
<td><strong>Views</strong></td>
<td>8</td>
</tr>
<tr>
<td><strong>Tamanho Total</strong></td>
<td>15.8 GB</td>
</tr>
<tr>
<td><strong>Registros (Total)</strong></td>
<td>2.5M+</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="diagrama-er-completo">Diagrama ER Completo</h2>
<pre><code>                        ┌──────────────┐
                        │  TSISTEMA    │
                        │ Data Sistema │
                        └──────┬───────┘
                               │
                ┌──────────────┴──────────────┐
                │                             │
        ┌───────▼────────┐           ┌───────▼────────┐
        │   TMESTSIN     │           │   TGERAMO      │
        │ Sinistro Mestre│◄──────────┤    Ramos       │
        │  PK: 4 partes  │           └────────────────┘
        └───┬────────────┘
            │
    ┌───────┴────────┬──────────┬──────────┬────────────┐
    │                │          │          │            │
┌───▼────┐    ┌─────▼─────┐ ┌──▼──┐  ┌───▼───┐  ┌─────▼──────┐
│THISTSIN│    │SI_ACOMPAN │ │SI_  │  │TAPOLI │  │EF_CONTR_   │
│História│    │HA_SINI    │ │SINI │  │CE     │  │SEG_HABIT   │
│PK: 5pt │    │ Eventos   │ │STRO │  │Apólice│  │ Contratos  │
└────────┘    └───────────┘ │_FASE│  └───────┘  └────────────┘
                             └──┬──┘
                                │
                        ┌───────▼────────┐
                        │SI_REL_FASE_    │
                        │EVENTO          │
                        │ Configuração   │
                        └────────────────┘
                               
                        ┌──────────────┐
                        │  TGEUNIMO    │
                        │  Conversão   │
                        │  Monetária   │
                        └──────────────┘</code></pre>
<hr />
<h2 id="tabelas-detalhadas">Tabelas Detalhadas</h2>
<h3 id="tmestsin---tabela-mestre-de-sinistros">1. TMESTSIN - Tabela
Mestre de Sinistros</h3>
<p><strong>Descrição:</strong> Registro principal de cada sinistro com
dados financeiros e identificação</p>
<p><strong>Volume:</strong> ~500.000 registros ativos</p>
<h4 id="estrutura-de-campos">Estrutura de Campos</h4>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TIPSEG</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Tipo de Seguro (PK1)</td>
</tr>
<tr>
<td><strong>ORGSIN</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Origem Sinistro (PK2)</td>
</tr>
<tr>
<td><strong>RMOSIN</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Ramo Sinistro (PK3)</td>
</tr>
<tr>
<td><strong>NUMSIN</strong></td>
<td>INT</td>
<td>6</td>
<td>N</td>
<td>Número Sinistro (PK4)</td>
</tr>
<tr>
<td>FONTE</td>
<td>INT</td>
<td>3</td>
<td>N</td>
<td>Fonte Protocolo</td>
</tr>
<tr>
<td>PROTSINI</td>
<td>INT</td>
<td>7</td>
<td>N</td>
<td>Número Protocolo</td>
</tr>
<tr>
<td>DAC</td>
<td>INT</td>
<td>1</td>
<td>N</td>
<td>Dígito Verificador</td>
</tr>
<tr>
<td>ORGAPO</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Origem Apólice</td>
</tr>
<tr>
<td>RMOAPO</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Ramo Apólice</td>
</tr>
<tr>
<td>NUMAPOL</td>
<td>INT</td>
<td>8</td>
<td>N</td>
<td>Número Apólice</td>
</tr>
<tr>
<td>SDOPAG</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Saldo a Pagar</td>
</tr>
<tr>
<td>TOTPAG</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Total Pago</td>
</tr>
<tr>
<td>CODPRODU</td>
<td>INT</td>
<td>4</td>
<td>N</td>
<td>Código Produto</td>
</tr>
<tr>
<td>TIPREG</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Tipo Registro</td>
</tr>
<tr>
<td>TPSEGU</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Tipo Seguro Apólice</td>
</tr>
<tr>
<td>CODLIDER</td>
<td>INT</td>
<td>3</td>
<td>Y</td>
<td>Código Líder</td>
</tr>
<tr>
<td>SINLID</td>
<td>INT</td>
<td>7</td>
<td>Y</td>
<td>Sinistro Líder</td>
</tr>
<tr>
<td>OCORHIST</td>
<td>INT</td>
<td>5</td>
<td>N</td>
<td>Contador Ocorrências</td>
</tr>
<tr>
<td>CREATED_BY</td>
<td>VARCHAR</td>
<td>50</td>
<td>N</td>
<td>Criado Por</td>
</tr>
<tr>
<td>CREATED_AT</td>
<td>DATETIME</td>
<td>-</td>
<td>N</td>
<td>Data Criação</td>
</tr>
<tr>
<td>UPDATED_BY</td>
<td>VARCHAR</td>
<td>50</td>
<td>Y</td>
<td>Atualizado Por</td>
</tr>
<tr>
<td>UPDATED_AT</td>
<td>DATETIME</td>
<td>-</td>
<td>Y</td>
<td>Data Atualização</td>
</tr>
<tr>
<td>ROW_VERSION</td>
<td>BINARY</td>
<td>8</td>
<td>N</td>
<td>Versão (Concorrência)</td>
</tr>
</tbody>
</table>
<h4 id="scripts-ddl">Scripts DDL</h4>
<div class="sourceCode" id="cb40"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> TMESTSIN (</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    TIPSEG      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    ORGSIN      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    RMOSIN      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    NUMSIN      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    FONTE       <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    PROTSINI    <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    DAC         <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    ORGAPO      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    RMOAPO      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    NUMAPOL     <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    SDOPAG      <span class="dt">DECIMAL</span>(<span class="dv">15</span>,<span class="dv">2</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    TOTPAG      <span class="dt">DECIMAL</span>(<span class="dv">15</span>,<span class="dv">2</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">0</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    CODPRODU    <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    TIPREG      <span class="dt">CHAR</span>(<span class="dv">1</span>) <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">CHECK</span> (TIPREG <span class="kw">IN</span> (<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>)),</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    TPSEGU      <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    CODLIDER    <span class="dt">INT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    SINLID      <span class="dt">INT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    OCORHIST    <span class="dt">INT</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">0</span>,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    CREATED_BY  <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    CREATED_AT  DATETIME <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> GETDATE(),</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    UPDATED_BY  <span class="dt">VARCHAR</span>(<span class="dv">50</span>) <span class="kw">NULL</span>,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    UPDATED_AT  DATETIME <span class="kw">NULL</span>,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    ROW_VERSION ROWVERSION <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> PK_TMESTSIN <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (TIPSEG, ORGSIN, RMOSIN, NUMSIN),</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">CONSTRAINT</span> CHK_TOTPAG_LE_SDOPAG <span class="kw">CHECK</span> (TOTPAG <span class="op">&lt;=</span> SDOPAG)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co">-- Índices</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_Protocol <span class="kw">ON</span> TMESTSIN(FONTE, PROTSINI, DAC);</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_Leader <span class="kw">ON</span> TMESTSIN(CODLIDER, SINLID) <span class="kw">WHERE</span> CODLIDER <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>;</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_Policy <span class="kw">ON</span> TMESTSIN(ORGAPO, RMOAPO, NUMAPOL);</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_TMESTSIN_Product <span class="kw">ON</span> TMESTSIN(CODPRODU);</span></code></pre></div>
<hr />
<h3 id="thistsin---histórico-de-pagamentos">2. THISTSIN - Histórico de
Pagamentos</h3>
<p><strong>Descrição:</strong> Registro de cada autorização de pagamento
realizada</p>
<p><strong>Volume:</strong> ~2.000.000 registros</p>
<h4 id="estrutura-de-campos-1">Estrutura de Campos</h4>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TIPSEG</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Tipo Seguro (PK1)</td>
</tr>
<tr>
<td><strong>ORGSIN</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Origem (PK2)</td>
</tr>
<tr>
<td><strong>RMOSIN</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Ramo (PK3)</td>
</tr>
<tr>
<td><strong>NUMSIN</strong></td>
<td>INT</td>
<td>6</td>
<td>N</td>
<td>Número (PK4)</td>
</tr>
<tr>
<td><strong>OCORHIST</strong></td>
<td>INT</td>
<td>5</td>
<td>N</td>
<td>Sequência (PK5)</td>
</tr>
<tr>
<td>OPERACAO</td>
<td>INT</td>
<td>4</td>
<td>N</td>
<td>Código Operação (1098)</td>
</tr>
<tr>
<td>DTMOVTO</td>
<td>DATE</td>
<td>-</td>
<td>N</td>
<td>Data Movimento</td>
</tr>
<tr>
<td>HORAOPER</td>
<td>TIME</td>
<td>-</td>
<td>N</td>
<td>Hora Operação</td>
</tr>
<tr>
<td>VALPRI</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Valor Principal</td>
</tr>
<tr>
<td>CRRMON</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Valor Correção</td>
</tr>
<tr>
<td>VALPRIBT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Principal BTNF</td>
</tr>
<tr>
<td>CRRMONBT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Correção BTNF</td>
</tr>
<tr>
<td>VALTOTBT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Total BTNF</td>
</tr>
<tr>
<td>PRIDIABT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Principal Diário</td>
</tr>
<tr>
<td>CRRDIABT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Correção Diária</td>
</tr>
<tr>
<td>TOTDIABT</td>
<td>DECIMAL</td>
<td>15,2</td>
<td>N</td>
<td>Total Diário</td>
</tr>
<tr>
<td>NOMFAV</td>
<td>VARCHAR</td>
<td>255</td>
<td>Y</td>
<td>Nome Favorecido</td>
</tr>
<tr>
<td>TIPCRR</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Tipo Correção (‘5’)</td>
</tr>
<tr>
<td>SITCONTB</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Situação Contábil</td>
</tr>
<tr>
<td>SITUACAO</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Situação Geral</td>
</tr>
<tr>
<td>EZEUSRID</td>
<td>VARCHAR</td>
<td>50</td>
<td>N</td>
<td>ID Operador</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="tgeramo---tabela-de-ramos">3. TGERAMO - Tabela de Ramos</h3>
<p><strong>Descrição:</strong> Cadastro de ramos de seguro</p>
<p><strong>Volume:</strong> ~50 registros</p>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CODIGO</strong></td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Código Ramo (PK)</td>
</tr>
<tr>
<td>DESCRICAO</td>
<td>VARCHAR</td>
<td>100</td>
<td>N</td>
<td>Descrição</td>
</tr>
<tr>
<td>ATIVO</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Status Ativo</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="tgeunimo---conversão-monetária">4. TGEUNIMO - Conversão
Monetária</h3>
<p><strong>Descrição:</strong> Tabela de taxas de conversão para
BTNF</p>
<p><strong>Volume:</strong> ~10.000 registros</p>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DATA_INICIO</strong></td>
<td>DATE</td>
<td>-</td>
<td>N</td>
<td>Data Início (PK)</td>
</tr>
<tr>
<td><strong>DATA_FIM</strong></td>
<td>DATE</td>
<td>-</td>
<td>N</td>
<td>Data Fim (PK)</td>
</tr>
<tr>
<td>VALOR_CONVERSAO</td>
<td>DECIMAL</td>
<td>18,8</td>
<td>N</td>
<td>Taxa Conversão</td>
</tr>
<tr>
<td>MOEDA</td>
<td>VARCHAR</td>
<td>3</td>
<td>N</td>
<td>Código Moeda</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="si_acompanha_sini---eventos-de-acompanhamento">5.
SI_ACOMPANHA_SINI - Eventos de Acompanhamento</h3>
<p><strong>Descrição:</strong> Registro de eventos do workflow</p>
<p><strong>Volume:</strong> ~1.500.000 registros</p>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ID</strong></td>
<td>GUID</td>
<td>-</td>
<td>N</td>
<td>ID Único (PK)</td>
</tr>
<tr>
<td>TIPSEG</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Tipo Seguro (FK)</td>
</tr>
<tr>
<td>ORGSIN</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Origem (FK)</td>
</tr>
<tr>
<td>RMOSIN</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Ramo (FK)</td>
</tr>
<tr>
<td>NUMSIN</td>
<td>INT</td>
<td>6</td>
<td>N</td>
<td>Número (FK)</td>
</tr>
<tr>
<td>COD_EVENTO</td>
<td>INT</td>
<td>3</td>
<td>N</td>
<td>Código Evento</td>
</tr>
<tr>
<td>DATA_EVENTO</td>
<td>DATETIME</td>
<td>-</td>
<td>N</td>
<td>Data/Hora Evento</td>
</tr>
<tr>
<td>USUARIO</td>
<td>VARCHAR</td>
<td>50</td>
<td>N</td>
<td>Usuário</td>
</tr>
<tr>
<td>OBSERVACAO</td>
<td>VARCHAR</td>
<td>500</td>
<td>Y</td>
<td>Observações</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="si_sinistro_fase---fases-do-sinistro">6. SI_SINISTRO_FASE -
Fases do Sinistro</h3>
<p><strong>Descrição:</strong> Controle de fases do processamento</p>
<p><strong>Volume:</strong> ~800.000 registros</p>
<table>
<thead>
<tr>
<th>Campo</th>
<th>Tipo</th>
<th>Tamanho</th>
<th>Null</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ID</strong></td>
<td>GUID</td>
<td>-</td>
<td>N</td>
<td>ID Único (PK)</td>
</tr>
<tr>
<td>TIPSEG</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Tipo Seguro (FK)</td>
</tr>
<tr>
<td>ORGSIN</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Origem (FK)</td>
</tr>
<tr>
<td>RMOSIN</td>
<td>INT</td>
<td>2</td>
<td>N</td>
<td>Ramo (FK)</td>
</tr>
<tr>
<td>NUMSIN</td>
<td>INT</td>
<td>6</td>
<td>N</td>
<td>Número (FK)</td>
</tr>
<tr>
<td>COD_FASE</td>
<td>INT</td>
<td>3</td>
<td>N</td>
<td>Código Fase</td>
</tr>
<tr>
<td>DATA_ABERTURA</td>
<td>DATE</td>
<td>-</td>
<td>N</td>
<td>Data Abertura</td>
</tr>
<tr>
<td>DATA_FECHAMENTO</td>
<td>DATE</td>
<td>-</td>
<td>Y</td>
<td>Data Fechamento</td>
</tr>
<tr>
<td>STATUS</td>
<td>CHAR</td>
<td>1</td>
<td>N</td>
<td>Status</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="índices-e-otimizações">Índices e Otimizações</h2>
<h3 id="índices-críticos-para-performance">Índices Críticos para
Performance</h3>
<div class="sourceCode" id="cb41"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Busca por protocolo (mais frequente)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_PROTOCOL_COVERING <span class="kw">ON</span> TMESTSIN(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    FONTE, PROTSINI, DAC</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>) INCLUDE (</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    TIPSEG, ORGSIN, RMOSIN, NUMSIN,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    SDOPAG, TOTPAG, CODPRODU</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co">-- Histórico por sinistro</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_HISTORY_BY_CLAIM <span class="kw">ON</span> THISTSIN(</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    TIPSEG, ORGSIN, RMOSIN, NUMSIN, OCORHIST <span class="kw">DESC</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>) INCLUDE (</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    DTMOVTO, VALPRI, CRRMON, NOMFAV</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">-- Fases abertas</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> IX_OPEN_PHASES <span class="kw">ON</span> SI_SINISTRO_FASE(</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    DATA_FECHAMENTO, STATUS</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>) <span class="kw">WHERE</span> DATA_FECHAMENTO <span class="kw">IS</span> <span class="kw">NULL</span>;</span></code></pre></div>
<h3 id="estatísticas-de-uso">Estatísticas de Uso</h3>
<table>
<thead>
<tr>
<th>Índice</th>
<th>Uso/Dia</th>
<th>Hit Ratio</th>
<th>Tamanho</th>
</tr>
</thead>
<tbody>
<tr>
<td>PK_TMESTSIN</td>
<td>15.000</td>
<td>99.2%</td>
<td>45 MB</td>
</tr>
<tr>
<td>IX_PROTOCOL_COVERING</td>
<td>8.500</td>
<td>98.5%</td>
<td>62 MB</td>
</tr>
<tr>
<td>IX_HISTORY_BY_CLAIM</td>
<td>5.200</td>
<td>97.8%</td>
<td>125 MB</td>
</tr>
<tr>
<td>IX_LEADER</td>
<td>450</td>
<td>94.2%</td>
<td>8 MB</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="procedures-e-functions">Procedures e Functions</h2>
<h3 id="sp_autorizar_pagamento">SP_AUTORIZAR_PAGAMENTO</h3>
<div class="sourceCode" id="cb42"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">PROCEDURE</span> SP_AUTORIZAR_PAGAMENTO</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    @TIPSEG <span class="dt">INT</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    @ORGSIN <span class="dt">INT</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    @RMOSIN <span class="dt">INT</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    @NUMSIN <span class="dt">INT</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    @VALPRI <span class="dt">DECIMAL</span>(<span class="dv">15</span>,<span class="dv">2</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    @CRRMON <span class="dt">DECIMAL</span>(<span class="dv">15</span>,<span class="dv">2</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    @NOMFAV <span class="dt">VARCHAR</span>(<span class="dv">255</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    @USUARIO <span class="dt">VARCHAR</span>(<span class="dv">50</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="kw">AS</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="cf">BEGIN</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SET</span> NOCOUNT <span class="kw">ON</span>;</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">DECLARE</span> @OCORHIST <span class="dt">INT</span>;</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">DECLARE</span> @TAXA_CONVERSAO <span class="dt">DECIMAL</span>(<span class="dv">18</span>,<span class="dv">8</span>);</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">BEGIN</span> <span class="kw">TRANSACTION</span>;</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">BEGIN</span> TRY</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Obter próximo número de ocorrência</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> @OCORHIST <span class="op">=</span> ISNULL(<span class="fu">MAX</span>(OCORHIST), <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> THISTSIN <span class="kw">WITH</span> (UPDLOCK)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> TIPSEG <span class="op">=</span> @TIPSEG </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> ORGSIN <span class="op">=</span> @ORGSIN</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> RMOSIN <span class="op">=</span> @RMOSIN</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> NUMSIN <span class="op">=</span> @NUMSIN;</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Obter taxa de conversão</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> @TAXA_CONVERSAO <span class="op">=</span> VALOR_CONVERSAO</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> TGEUNIMO</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> GETDATE() <span class="kw">BETWEEN</span> DATA_INICIO <span class="kw">AND</span> DATA_FIM;</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Inserir histórico</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">INSERT</span> <span class="kw">INTO</span> THISTSIN (<span class="op">..</span>.)</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">VALUES</span> (<span class="op">..</span>.);</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Atualizar mestre</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">UPDATE</span> TMESTSIN</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SET</span> TOTPAG <span class="op">=</span> TOTPAG <span class="op">+</span> @VALPRI <span class="op">+</span> @CRRMON,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>            OCORHIST <span class="op">=</span> @OCORHIST,</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>            UPDATED_BY <span class="op">=</span> @USUARIO,</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>            UPDATED_AT <span class="op">=</span> GETDATE()</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> TIPSEG <span class="op">=</span> @TIPSEG </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> ORGSIN <span class="op">=</span> @ORGSIN</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> RMOSIN <span class="op">=</span> @RMOSIN</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>          <span class="kw">AND</span> NUMSIN <span class="op">=</span> @NUMSIN;</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">COMMIT</span> <span class="kw">TRANSACTION</span>;</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">RETURN</span> <span class="dv">0</span>;</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> TRY</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">BEGIN</span> CATCH</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">ROLLBACK</span> <span class="kw">TRANSACTION</span>;</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>        THROW;</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">END</span> CATCH;</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a><span class="cf">END</span></span></code></pre></div>
<hr />
<h2 id="views-importantes">Views Importantes</h2>
<h3 id="vw_sinistros_pendentes">VW_SINISTROS_PENDENTES</h3>
<div class="sourceCode" id="cb43"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">VIEW</span> VW_SINISTROS_PENDENTES <span class="kw">AS</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    T.TIPSEG, T.ORGSIN, T.RMOSIN, T.NUMSIN,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    T.FONTE, T.PROTSINI, T.DAC,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    T.SDOPAG <span class="kw">AS</span> VALOR_ESPERADO,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    T.TOTPAG <span class="kw">AS</span> VALOR_PAGO,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    (T.SDOPAG <span class="op">-</span> T.TOTPAG) <span class="kw">AS</span> SALDO_PENDENTE,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    R.DESCRICAO <span class="kw">AS</span> RAMO_DESCRICAO,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    F.COD_FASE <span class="kw">AS</span> FASE_ATUAL,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    F.DATA_ABERTURA <span class="kw">AS</span> DATA_FASE_ATUAL</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> TMESTSIN T</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">INNER</span> <span class="kw">JOIN</span> TGERAMO R <span class="kw">ON</span> T.RMOSIN <span class="op">=</span> R.CODIGO</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">LEFT</span> <span class="kw">JOIN</span> SI_SINISTRO_FASE F <span class="kw">ON</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        T.TIPSEG <span class="op">=</span> F.TIPSEG </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> T.ORGSIN <span class="op">=</span> F.ORGSIN</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> T.RMOSIN <span class="op">=</span> F.RMOSIN</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> T.NUMSIN <span class="op">=</span> F.NUMSIN</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> F.DATA_FECHAMENTO <span class="kw">IS</span> <span class="kw">NULL</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> T.SDOPAG <span class="op">&gt;</span> T.TOTPAG;</span></code></pre></div>
<hr />
<h2 id="considerações-de-migração">Considerações de Migração</h2>
<h3 id="desafios-identificados">Desafios Identificados</h3>
<ol type="1">
<li><strong>Chaves Compostas</strong>: Migrar para chaves simples
(GUIDs)</li>
<li><strong>EBCDIC para UTF-8</strong>: Conversão de caracteres
especiais</li>
<li><strong>Packed Decimal</strong>: Conversão de COMP-3 para
decimal</li>
<li><strong>Datas 9999-12-31</strong>: Substituir por NULL</li>
<li><strong>Campos CHAR(1)</strong>: Converter para enums em C#</li>
</ol>
<h3 id="estratégia-de-migração-de-dados">Estratégia de Migração de
Dados</h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Script de migração exemplo</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> NEW_CLAIM_MASTER (</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Id</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    InsuranceType,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    ClaimOrigin,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    ClaimBranch,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    ClaimNumber,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- ... outros campos</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    NEWID() <span class="kw">as</span> <span class="kw">Id</span>,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    TIPSEG,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    ORGSIN,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    RMOSIN,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    NUMSIN,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- ... conversões necessárias</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> TMESTSIN;</span></code></pre></div>
<hr />
<p><em>Este documento detalha o modelo completo de banco de dados do
sistema SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="lógica-de-negócio-sistema-legado-siwea">05 - Lógica de Negócio:
Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-das-regras-de-negócio">Visão Geral das Regras de
Negócio</h2>
<h3 id="estatísticas">Estatísticas</h3>
<table>
<thead>
<tr>
<th>Categoria</th>
<th>Quantidade</th>
<th>Criticidade</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Regras de Validação</strong></td>
<td>45</td>
<td>Alta</td>
</tr>
<tr>
<td><strong>Regras de Cálculo</strong></td>
<td>28</td>
<td>Crítica</td>
</tr>
<tr>
<td><strong>Regras de Workflow</strong></td>
<td>22</td>
<td>Média</td>
</tr>
<tr>
<td><strong>Regras de Integração</strong></td>
<td>15</td>
<td>Alta</td>
</tr>
<tr>
<td><strong>Regras de Auditoria</strong></td>
<td>12</td>
<td>Média</td>
</tr>
<tr>
<td><strong>TOTAL</strong></td>
<td><strong>122</strong></td>
<td>-</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="regras-críticas-de-sistema">Regras Críticas de Sistema</h2>
<h3 id="br-001-validação-de-tipo-de-pagamento">BR-001: Validação de Tipo
de Pagamento</h3>
<p><strong>Categoria:</strong> Validação <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>REGRA:
    O tipo de pagamento DEVE ser um valor entre 1 e 5
    
VALORES:
    1 = Pagamento Total
    2 = Pagamento Parcial
    3 = Pagamento Complementar
    4 = Pagamento de Ajuste
    5 = Pagamento Recalculado
    
AÇÃO SE INVÁLIDO:
    Rejeitar transação com erro E0002
    Log de tentativa de fraude se valor &gt; 5</code></pre>
<h3 id="br-002-valor-principal-obrigatório">BR-002: Valor Principal
Obrigatório</h3>
<p><strong>Categoria:</strong> Validação <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>REGRA:
    Valor principal (VALPRI) DEVE ser &gt; 0
    
EXCEÇÃO:
    Permitido = 0 apenas se tipo pagamento = 4 (Ajuste)
    E valor correção &gt; 0
    
VALIDAÇÃO:
    IF VALPRI &lt;= 0 AND (TIPPAG &lt;&gt; 4 OR CRRMON &lt;= 0) THEN
        ERRO E0003</code></pre>
<h3 id="br-003-beneficiário-obrigatório-condicional">BR-003:
Beneficiário Obrigatório Condicional</h3>
<p><strong>Categoria:</strong> Validação <strong>Criticidade:</strong>
ALTA</p>
<pre><code>REGRA:
    Beneficiário (NOMFAV) é obrigatório SE:
    - Tipo de seguro da apólice (TPSEGU) != 0
    
LÓGICA:
    IF TPSEGU &lt;&gt; 0 AND (NOMFAV IS NULL OR TRIM(NOMFAV) = &#39;&#39;) THEN
        ERRO E0004 &quot;Beneficiário obrigatório para este tipo de seguro&quot;</code></pre>
<hr />
<h2 id="regras-de-cálculo-financeiro">Regras de Cálculo Financeiro</h2>
<h3 id="br-010-conversão-para-btnf">BR-010: Conversão para BTNF</h3>
<p><strong>Categoria:</strong> Cálculo <strong>Criticidade:</strong>
CRÍTICA</p>
<pre class="cobol"><code>COMPUTE VALPRIBT = VALPRI * TAXA-CONVERSAO
COMPUTE CRRMONBT = CRRMON * TAXA-CONVERSAO
COMPUTE VALTOTBT = VALPRIBT + CRRMONBT

ONDE:
    TAXA-CONVERSAO vem de TGEUNIMO
    baseado na data de movimento (DTMOVTO)
    
PRECISÃO:
    Todas as operações com DECIMAL(15,2)
    Arredondamento: ROUND_HALF_UP</code></pre>
<h3 id="br-011-cálculo-de-saldo-pendente">BR-011: Cálculo de Saldo
Pendente</h3>
<p><strong>Categoria:</strong> Cálculo <strong>Criticidade:</strong>
ALTA</p>
<pre><code>SALDO_PENDENTE = SDOPAG - TOTPAG

VALIDAÇÕES:
    1. SALDO_PENDENTE não pode ser negativo
    2. Novo pagamento não pode exceder SALDO_PENDENTE
    3. Se SALDO_PENDENTE = 0, sinistro deve ser fechado</code></pre>
<h3 id="br-012-atualização-de-total-pago">BR-012: Atualização de Total
Pago</h3>
<p><strong>Categoria:</strong> Cálculo <strong>Criticidade:</strong>
CRÍTICA</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">UPDATE</span> TMESTSIN</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SET</span> TOTPAG <span class="op">=</span> TOTPAG <span class="op">+</span> (VALPRI <span class="op">+</span> CRRMON)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> <span class="op">&lt;</span>chave_sinistro<span class="op">&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CONSTRAINT</span>:</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    TOTPAG nunca pode exceder SDOPAG</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    Se exceder, <span class="kw">ROLLBACK</span> completo</span></code></pre></div>
<hr />
<h2 id="regras-de-workflow-e-fases">Regras de Workflow e Fases</h2>
<h3 id="br-020-abertura-automática-de-fase">BR-020: Abertura Automática
de Fase</h3>
<p><strong>Categoria:</strong> Workflow <strong>Criticidade:</strong>
ALTA</p>
<pre><code>QUANDO: Autorização de pagamento aprovada

AÇÃO:
    1. Verificar se existe fase aberta (DATA_FECHAMENTO = NULL)
    2. Se não existe, criar fase com código 300 (Autorização)
    3. DATA_ABERTURA = data atual
    4. DATA_FECHAMENTO = NULL (aberta)
    
SQL:
    IF NOT EXISTS (fase aberta) THEN
        INSERT INTO SI_SINISTRO_FASE
        VALUES (sinistro, 300, GETDATE(), NULL, &#39;A&#39;)</code></pre>
<h3 id="br-021-fechamento-automático-de-fase">BR-021: Fechamento
Automático de Fase</h3>
<p><strong>Categoria:</strong> Workflow <strong>Criticidade:</strong>
MÉDIA</p>
<pre><code>QUANDO: 
    - Pagamento total realizado (TOTPAG = SDOPAG)
    - OU evento de encerramento manual

AÇÃO:
    UPDATE SI_SINISTRO_FASE
    SET DATA_FECHAMENTO = GETDATE(),
        STATUS = &#39;F&#39;
    WHERE &lt;sinistro&gt; AND DATA_FECHAMENTO IS NULL</code></pre>
<h3 id="br-022-sequência-de-fases">BR-022: Sequência de Fases</h3>
<p><strong>Categoria:</strong> Workflow <strong>Criticidade:</strong>
ALTA</p>
<pre><code>SEQUÊNCIA OBRIGATÓRIA:
    001 → 002 → 003 → 004 → 005 → 006 → 007 → 008

FASES:
    001 = Abertura
    002 = Análise Documentação
    003 = Autorização Pagamento
    004 = Pagamento Realizado
    005 = Aguardando Comprovação
    006 = Comprovação Recebida
    007 = Análise Final
    008 = Encerramento

REGRA:
    Não é possível pular fases
    Fase anterior deve estar fechada</code></pre>
<hr />
<h2 id="regras-de-integração-externa">Regras de Integração Externa</h2>
<h3 id="br-030-roteamento-por-produto">BR-030: Roteamento por
Produto</h3>
<p><strong>Categoria:</strong> Integração <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>REGRA DE ROTEAMENTO:
    
SE CODPRODU IN (6814, 7701, 7709) ENTÃO
    → Validar com CNOUA (Consórcio)
    
SE CODPRODU BETWEEN 5000 AND 5999 ENTÃO
    → Validar com SIPUA (EFP)
    
SE CODPRODU BETWEEN 8000 AND 8999 ENTÃO
    → Validar com SIMDA (HB)
    
SENÃO
    → Sem validação externa necessária</code></pre>
<h3 id="br-031-timeout-de-integração">BR-031: Timeout de Integração</h3>
<p><strong>Categoria:</strong> Integração <strong>Criticidade:</strong>
ALTA</p>
<pre><code>TIMEOUTS:
    CNOUA: 30 segundos
    SIPUA: 20 segundos
    SIMDA: 25 segundos

RETRY:
    Máximo 3 tentativas
    Backoff exponencial: 1s, 2s, 4s

CONTINGÊNCIA:
    Se todas falham E modo contingência ativo:
        Aprovar com flag CONTINGENCY = &#39;Y&#39;
    Senão:
        Rejeitar com erro E0010</code></pre>
<h3 id="br-032-validação-de-resposta-externa">BR-032: Validação de
Resposta Externa</h3>
<p><strong>Categoria:</strong> Integração <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>RESPOSTAS VÁLIDAS:
    APROVADO: Continuar processamento
    REJEITADO: Abortar com erro específico
    PENDENTE: Aguardar callback (máx 24h)
    ERRO: Aplicar regra de retry

VALIDAÇÃO DE LIMITE:
    Se sistema retorna limite disponível:
        Valor solicitado não pode exceder limite</code></pre>
<hr />
<h2 id="regras-de-auditoria-e-compliance">Regras de Auditoria e
Compliance</h2>
<h3 id="br-040-registro-de-operador">BR-040: Registro de Operador</h3>
<p><strong>Categoria:</strong> Auditoria <strong>Criticidade:</strong>
ALTA</p>
<pre><code>TODA transação DEVE registrar:
    - EZEUSRID (ID do operador CICS)
    - Terminal ID
    - Data/Hora da operação
    - IP de origem (se disponível)

IMUTABILIDADE:
    Após gravado, EZEUSRID não pode ser alterado</code></pre>
<h3 id="br-041-log-de-alterações-críticas">BR-041: Log de Alterações
Críticas</h3>
<p><strong>Categoria:</strong> Auditoria <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>EVENTOS QUE DEVEM SER LOGADOS:
    1. Autorização de pagamento &gt; R$ 100.000
    2. Alteração manual de valores
    3. Override de validação
    4. Operação em modo contingência
    5. Tentativa de fraude detectada

RETENÇÃO:
    Logs críticos: 7 anos
    Logs normais: 2 anos</code></pre>
<hr />
<h2 id="regras-de-validação-de-dados">Regras de Validação de Dados</h2>
<h3 id="br-050-validação-de-protocolo">BR-050: Validação de
Protocolo</h3>
<p><strong>Categoria:</strong> Validação <strong>Criticidade:</strong>
ALTA</p>
<pre><code>FORMATO: XXX/NNNNNNN-D

ONDE:
    XXX = Fonte (3 dígitos)
    NNNNNNN = Número (7 dígitos)
    D = Dígito verificador (1 dígito)

CÁLCULO DO DÍGITO:
    Módulo 11 dos 10 dígitos anteriores</code></pre>
<h3 id="br-051-validação-de-sinistro">BR-051: Validação de Sinistro</h3>
<p><strong>Categoria:</strong> Validação <strong>Criticidade:</strong>
ALTA</p>
<pre><code>FORMATO: OO/RR/NNNNNN

ONDE:
    OO = Origem (2 dígitos, 01-99)
    RR = Ramo (2 dígitos, 01-50)
    NNNNNN = Número (6 dígitos)

VALIDAÇÕES:
    - Origem deve existir em tabela
    - Ramo deve existir em TGERAMO
    - Número sequencial único por origem/ramo</code></pre>
<hr />
<h2 id="regras-de-controle-de-concorrência">Regras de Controle de
Concorrência</h2>
<h3 id="br-060-lock-pessimista">BR-060: Lock Pessimista</h3>
<p><strong>Categoria:</strong> Concorrência
<strong>Criticidade:</strong> CRÍTICA</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Ao iniciar autorização</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> TMESTSIN <span class="kw">WITH</span> (UPDLOCK)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> <span class="op">&lt;</span>chave_sinistro<span class="op">&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- Lock mantido até:</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="kw">COMMIT</span> (sucesso)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="kw">ROLLBACK</span> (erro)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="kw">Timeout</span> (<span class="dv">120</span> segundos)</span></code></pre></div>
<h3 id="br-061-detecção-de-conflito">BR-061: Detecção de Conflito</h3>
<p><strong>Categoria:</strong> Concorrência
<strong>Criticidade:</strong> ALTA</p>
<pre><code>USANDO ROW_VERSION:
    1. Ler ROW_VERSION no SELECT
    2. Incluir no WHERE do UPDATE
    3. Se afetou 0 linhas = conflito
    4. Recarregar e tentar novamente (máx 3x)</code></pre>
<hr />
<h2 id="regras-de-performance">Regras de Performance</h2>
<h3 id="br-070-cache-de-dados-estáticos">BR-070: Cache de Dados
Estáticos</h3>
<p><strong>Categoria:</strong> Performance <strong>Criticidade:</strong>
MÉDIA</p>
<pre><code>DADOS PARA CACHE (TTL = 1 hora):
    - TGERAMO (ramos)
    - TGEUNIMO (taxas do dia)
    - SI_REL_FASE_EVENTO (configuração)
    
INVALIDAÇÃO:
    - Por timeout
    - Por comando administrativo
    - Por mudança detectada</code></pre>
<h3 id="br-071-paginação-de-resultados">BR-071: Paginação de
Resultados</h3>
<p><strong>Categoria:</strong> Performance <strong>Criticidade:</strong>
MÉDIA</p>
<pre><code>BUSCA DE SINISTROS:
    - Máximo 100 registros por página
    - Ordenação por data descendente
    - Usar OFFSET/FETCH (SQL Server)
    - Ou ROWNUM (Oracle/DB2)</code></pre>
<hr />
<h2 id="regras-de-segurança">Regras de Segurança</h2>
<h3 id="br-080-autorização-por-alçada">BR-080: Autorização por
Alçada</h3>
<p><strong>Categoria:</strong> Segurança <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>NÍVEIS DE ALÇADA:
    Operador Jr: até R$ 10.000
    Operador Pleno: até R$ 50.000
    Operador Senior: até R$ 200.000
    Supervisor: até R$ 1.000.000
    Gerente: sem limite

VALIDAÇÃO:
    IF valor_total &gt; alçada_usuario THEN
        Requer aprovação superior</code></pre>
<h3 id="br-081-prevenção-de-fraude">BR-081: Prevenção de Fraude</h3>
<p><strong>Categoria:</strong> Segurança <strong>Criticidade:</strong>
CRÍTICA</p>
<pre><code>INDICADORES DE FRAUDE:
    1. Múltiplos pagamentos mesmo beneficiário/dia
    2. Valor 50% acima da média do ramo
    3. Beneficiário em blacklist
    4. Padrão anormal de horário
    
AÇÃO:
    Flag para análise manual
    Notificação ao compliance</code></pre>
<hr />
<h2 id="matriz-de-dependência-de-regras">Matriz de Dependência de
Regras</h2>
<table>
<thead>
<tr>
<th>Regra</th>
<th>Depende de</th>
<th>É pré-requisito para</th>
</tr>
</thead>
<tbody>
<tr>
<td>BR-001</td>
<td>-</td>
<td>BR-010, BR-020</td>
</tr>
<tr>
<td>BR-002</td>
<td>-</td>
<td>BR-011, BR-012</td>
</tr>
<tr>
<td>BR-003</td>
<td>BR-051</td>
<td>BR-040</td>
</tr>
<tr>
<td>BR-010</td>
<td>BR-002</td>
<td>BR-012</td>
</tr>
<tr>
<td>BR-011</td>
<td>BR-010</td>
<td>BR-021</td>
</tr>
<tr>
<td>BR-012</td>
<td>BR-011</td>
<td>BR-020, BR-021</td>
</tr>
<tr>
<td>BR-020</td>
<td>BR-012</td>
<td>BR-022</td>
</tr>
<tr>
<td>BR-030</td>
<td>BR-001</td>
<td>BR-031, BR-032</td>
</tr>
<tr>
<td>BR-040</td>
<td>Todas</td>
<td>-</td>
</tr>
<tr>
<td>BR-060</td>
<td>-</td>
<td>BR-012, BR-020</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="implementação-em-.net">Implementação em .NET</h2>
<h3 id="exemplo-de-implementação">Exemplo de Implementação</h3>
<div class="sourceCode" id="cb67"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> PaymentAuthorizationService</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BR-001: Validação de Tipo de Pagamento</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">ValidatePaymentType</span><span class="op">(</span><span class="dt">int</span> paymentType<span class="op">)</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>paymentType <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">||</span> paymentType <span class="op">&gt;</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">BusinessRuleException</span><span class="op">(</span><span class="st">&quot;E0002&quot;</span><span class="op">,</span> </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Tipo de pagamento inválido&quot;</span><span class="op">);</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BR-010: Conversão BTNF</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">decimal</span> <span class="fu">ConvertToBTNF</span><span class="op">(</span><span class="dt">decimal</span> value<span class="op">,</span> DateTime date<span class="op">)</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">var</span> rate <span class="op">=</span> _currencyService<span class="op">.</span><span class="fu">GetConversionRate</span><span class="op">(</span>date<span class="op">);</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> Math<span class="op">.</span><span class="fu">Round</span><span class="op">(</span>value <span class="op">*</span> rate<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>            MidpointRounding<span class="op">.</span><span class="fu">ToEven</span><span class="op">);</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BR-030: Roteamento por Produto</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> async Task<span class="op">&lt;</span>ValidationResult<span class="op">&gt;</span> <span class="fu">ValidateExternal</span><span class="op">(</span></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> productCode<span class="op">,</span> <span class="dt">decimal</span> amount<span class="op">)</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> productCode <span class="kw">switch</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6814</span> or <span class="dv">7701</span> or <span class="dv">7709</span> <span class="op">=&gt;</span> </span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>                await _cnouaService<span class="op">.</span><span class="fu">ValidateAsync</span><span class="op">(</span>amount<span class="op">),</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;=</span> <span class="dv">5000</span> and <span class="op">&lt;=</span> <span class="dv">5999</span> <span class="op">=&gt;</span> </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>                await _sipuaService<span class="op">.</span><span class="fu">ValidateAsync</span><span class="op">(</span>amount<span class="op">),</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;=</span> <span class="dv">8000</span> and <span class="op">&lt;=</span> <span class="dv">8999</span> <span class="op">=&gt;</span> </span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>                await _simdaService<span class="op">.</span><span class="fu">ValidateAsync</span><span class="op">(</span>amount<span class="op">),</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>            _ <span class="op">=&gt;</span> ValidationResult<span class="op">.</span><span class="fu">Approved</span><span class="op">()</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<p><em>Este documento detalha toda a lógica de negócio do sistema
SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="integrações-externas-sistema-legado-siwea">06 - Integrações
Externas: Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-das-integrações">Visão Geral das Integrações</h2>
<h3 id="sistemas-integrados">Sistemas Integrados</h3>
<table>
<thead>
<tr>
<th>Sistema</th>
<th>Tipo</th>
<th>Protocolo</th>
<th>Criticidade</th>
<th>Volume/Dia</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CNOUA</strong></td>
<td>Validação Consórcio</td>
<td>SOAP/HTTP</td>
<td>Alta</td>
<td>500</td>
</tr>
<tr>
<td><strong>SIPUA</strong></td>
<td>Validação EFP</td>
<td>REST/JSON</td>
<td>Alta</td>
<td>300</td>
</tr>
<tr>
<td><strong>SIMDA</strong></td>
<td>Validação HB</td>
<td>MQ Series</td>
<td>Média</td>
<td>200</td>
</tr>
<tr>
<td><strong>RACF</strong></td>
<td>Autenticação</td>
<td>Native</td>
<td>Crítica</td>
<td>8.000</td>
</tr>
<tr>
<td><strong>DB2</strong></td>
<td>Banco de Dados</td>
<td>SQL/JDBC</td>
<td>Crítica</td>
<td>50.000</td>
</tr>
<tr>
<td><strong>CICS</strong></td>
<td>Transaction Manager</td>
<td>Native</td>
<td>Crítica</td>
<td>10.000</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="cnoua---sistema-de-validação-de-consórcio">CNOUA - Sistema de
Validação de Consórcio</h2>
<h3 id="especificação-técnica">Especificação Técnica</h3>
<table>
<colgroup>
<col style="width: 58%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Atributo</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Endpoint Produção</strong></td>
<td>http://cnoua.caixaseguradora.com.br:8080/validacao</td>
</tr>
<tr>
<td><strong>Endpoint Homologação</strong></td>
<td>http://cnoua-hom.caixaseguradora.com.br:8080/validacao</td>
</tr>
<tr>
<td><strong>Protocolo</strong></td>
<td>SOAP 1.1</td>
</tr>
<tr>
<td><strong>Autenticação</strong></td>
<td>WS-Security UsernameToken</td>
</tr>
<tr>
<td><strong>Timeout</strong></td>
<td>30 segundos</td>
</tr>
<tr>
<td><strong>Retry Policy</strong></td>
<td>3 tentativas, backoff exponencial</td>
</tr>
</tbody>
</table>
<h3 id="wsdl-simplificado">WSDL Simplificado</h3>
<div class="sourceCode" id="cb68"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span> <span class="ot">version=</span><span class="st">&quot;1.0&quot;</span> <span class="ot">encoding=</span><span class="st">&quot;UTF-8&quot;</span><span class="fu">?&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">definitions</span> <span class="ot">xmlns=</span><span class="st">&quot;http://schemas.xmlsoap.org/wsdl/&quot;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>             <span class="ot">targetNamespace=</span><span class="st">&quot;http://cnoua.caixaseguradora.com.br/validacao&quot;</span>&gt;</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">types</span>&gt;</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">schema</span> <span class="ot">targetNamespace=</span><span class="st">&quot;http://cnoua.caixaseguradora.com.br/validacao&quot;</span>&gt;</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;ValidarConsorcioRequest&quot;</span>&gt;</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">complexType</span>&gt;</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">sequence</span>&gt;</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;codigoProduto&quot;</span> <span class="ot">type=</span><span class="st">&quot;int&quot;</span>/&gt;</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;numeroContrato&quot;</span> <span class="ot">type=</span><span class="st">&quot;string&quot;</span>/&gt;</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;numeroSinistro&quot;</span> <span class="ot">type=</span><span class="st">&quot;string&quot;</span>/&gt;</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;valorSolicitado&quot;</span> <span class="ot">type=</span><span class="st">&quot;decimal&quot;</span>/&gt;</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;dataMovimento&quot;</span> <span class="ot">type=</span><span class="st">&quot;date&quot;</span>/&gt;</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">sequence</span>&gt;</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">complexType</span>&gt;</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">element</span>&gt;</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;ValidarConsorcioResponse&quot;</span>&gt;</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">complexType</span>&gt;</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">sequence</span>&gt;</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;status&quot;</span> <span class="ot">type=</span><span class="st">&quot;string&quot;</span>/&gt;</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;codigo&quot;</span> <span class="ot">type=</span><span class="st">&quot;string&quot;</span>/&gt;</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;mensagem&quot;</span> <span class="ot">type=</span><span class="st">&quot;string&quot;</span>/&gt;</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;limiteDisponivel&quot;</span> <span class="ot">type=</span><span class="st">&quot;decimal&quot;</span>/&gt;</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">element</span> <span class="ot">name=</span><span class="st">&quot;dataExpiracao&quot;</span> <span class="ot">type=</span><span class="st">&quot;date&quot;</span>/&gt;</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">sequence</span>&gt;</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">complexType</span>&gt;</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">element</span>&gt;</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">schema</span>&gt;</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">types</span>&gt;</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">message</span> <span class="ot">name=</span><span class="st">&quot;ValidarConsorcioInput&quot;</span>&gt;</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">part</span> <span class="ot">name=</span><span class="st">&quot;parameters&quot;</span> <span class="ot">element=</span><span class="st">&quot;ValidarConsorcioRequest&quot;</span>/&gt;</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">message</span>&gt;</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">message</span> <span class="ot">name=</span><span class="st">&quot;ValidarConsorcioOutput&quot;</span>&gt;</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">part</span> <span class="ot">name=</span><span class="st">&quot;parameters&quot;</span> <span class="ot">element=</span><span class="st">&quot;ValidarConsorcioResponse&quot;</span>/&gt;</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">message</span>&gt;</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">portType</span> <span class="ot">name=</span><span class="st">&quot;ValidacaoConsorcioPortType&quot;</span>&gt;</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">operation</span> <span class="ot">name=</span><span class="st">&quot;validarConsorcio&quot;</span>&gt;</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">input</span> <span class="ot">message=</span><span class="st">&quot;ValidarConsorcioInput&quot;</span>/&gt;</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">output</span> <span class="ot">message=</span><span class="st">&quot;ValidarConsorcioOutput&quot;</span>/&gt;</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">operation</span>&gt;</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">portType</span>&gt;</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">binding</span> <span class="ot">name=</span><span class="st">&quot;ValidacaoConsorcioBinding&quot;</span> <span class="ot">type=</span><span class="st">&quot;ValidacaoConsorcioPortType&quot;</span>&gt;</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">soap:binding</span> <span class="ot">transport=</span><span class="st">&quot;http://schemas.xmlsoap.org/soap/http&quot;</span>/&gt;</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">operation</span> <span class="ot">name=</span><span class="st">&quot;validarConsorcio&quot;</span>&gt;</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">soap:operation</span> <span class="ot">soapAction=</span><span class="st">&quot;validarConsorcio&quot;</span>/&gt;</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">input</span>&gt;&lt;<span class="kw">soap:body</span> <span class="ot">use=</span><span class="st">&quot;literal&quot;</span>/&gt;&lt;/<span class="kw">input</span>&gt;</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">output</span>&gt;&lt;<span class="kw">soap:body</span> <span class="ot">use=</span><span class="st">&quot;literal&quot;</span>/&gt;&lt;/<span class="kw">output</span>&gt;</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">operation</span>&gt;</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">binding</span>&gt;</span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">service</span> <span class="ot">name=</span><span class="st">&quot;ValidacaoConsorcioService&quot;</span>&gt;</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">port</span> <span class="ot">name=</span><span class="st">&quot;ValidacaoConsorcioPort&quot;</span> <span class="ot">binding=</span><span class="st">&quot;ValidacaoConsorcioBinding&quot;</span>&gt;</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">soap:address</span> <span class="ot">location=</span><span class="st">&quot;http://cnoua.caixaseguradora.com.br:8080/validacao&quot;</span>/&gt;</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">port</span>&gt;</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">service</span>&gt;</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">definitions</span>&gt;</span></code></pre></div>
<h3 id="exemplo-de-requestresponse">Exemplo de Request/Response</h3>
<p><strong>Request:</strong></p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">soap:Envelope</span> <span class="ot">xmlns:soap=</span><span class="st">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Header</span>&gt;</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsse:Security</span> <span class="ot">xmlns:wsse=</span><span class="st">&quot;http://schemas.xmlsoap.org/ws/2002/07/secext&quot;</span>&gt;</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">wsse:UsernameToken</span>&gt;</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">wsse:Username</span>&gt;SIWEA_USER&lt;/<span class="kw">wsse:Username</span>&gt;</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">wsse:Password</span>&gt;encrypted_password&lt;/<span class="kw">wsse:Password</span>&gt;</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">wsse:UsernameToken</span>&gt;</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">wsse:Security</span>&gt;</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Header</span>&gt;</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Body</span>&gt;</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">ValidarConsorcioRequest</span>&gt;</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">codigoProduto</span>&gt;6814&lt;/<span class="kw">codigoProduto</span>&gt;</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">numeroContrato</span>&gt;CON123456789&lt;/<span class="kw">numeroContrato</span>&gt;</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">numeroSinistro</span>&gt;10/20/789012&lt;/<span class="kw">numeroSinistro</span>&gt;</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">valorSolicitado</span>&gt;50000.00&lt;/<span class="kw">valorSolicitado</span>&gt;</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">dataMovimento</span>&gt;2025-10-27&lt;/<span class="kw">dataMovimento</span>&gt;</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">ValidarConsorcioRequest</span>&gt;</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Body</span>&gt;</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">soap:Envelope</span>&gt;</span></code></pre></div>
<p><strong>Response (Sucesso):</strong></p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">soap:Envelope</span> <span class="ot">xmlns:soap=</span><span class="st">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Body</span>&gt;</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">ValidarConsorcioResponse</span>&gt;</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">status</span>&gt;APROVADO&lt;/<span class="kw">status</span>&gt;</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">codigo</span>&gt;VAL-001&lt;/<span class="kw">codigo</span>&gt;</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">mensagem</span>&gt;Validação aprovada com sucesso&lt;/<span class="kw">mensagem</span>&gt;</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">limiteDisponivel</span>&gt;150000.00&lt;/<span class="kw">limiteDisponivel</span>&gt;</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">dataExpiracao</span>&gt;2025-12-31&lt;/<span class="kw">dataExpiracao</span>&gt;</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">ValidarConsorcioResponse</span>&gt;</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Body</span>&gt;</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">soap:Envelope</span>&gt;</span></code></pre></div>
<h3 id="códigos-de-retorno">Códigos de Retorno</h3>
<table>
<thead>
<tr>
<th>Código</th>
<th>Status</th>
<th>Descrição</th>
<th>Ação</th>
</tr>
</thead>
<tbody>
<tr>
<td>VAL-001</td>
<td>APROVADO</td>
<td>Validação aprovada</td>
<td>Continuar</td>
</tr>
<tr>
<td>VAL-002</td>
<td>REJEITADO</td>
<td>Limite excedido</td>
<td>Abortar</td>
</tr>
<tr>
<td>VAL-003</td>
<td>REJEITADO</td>
<td>Contrato inválido</td>
<td>Abortar</td>
</tr>
<tr>
<td>VAL-004</td>
<td>PENDENTE</td>
<td>Análise manual necessária</td>
<td>Aguardar</td>
</tr>
<tr>
<td>ERR-001</td>
<td>ERRO</td>
<td>Erro de sistema</td>
<td>Retry</td>
</tr>
<tr>
<td>ERR-002</td>
<td>ERRO</td>
<td>Timeout</td>
<td>Retry</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="sipua---sistema-de-validação-efp">SIPUA - Sistema de Validação
EFP</h2>
<h3 id="especificação-técnica-1">Especificação Técnica</h3>
<table>
<colgroup>
<col style="width: 58%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr>
<th>Atributo</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Endpoint Produção</strong></td>
<td>https://sipua.caixaseguradora.com.br/api/v1/validate</td>
</tr>
<tr>
<td><strong>Endpoint Homologação</strong></td>
<td>https://sipua-hom.caixaseguradora.com.br/api/v1/validate</td>
</tr>
<tr>
<td><strong>Protocolo</strong></td>
<td>REST/JSON</td>
</tr>
<tr>
<td><strong>Autenticação</strong></td>
<td>Bearer Token (JWT)</td>
</tr>
<tr>
<td><strong>Timeout</strong></td>
<td>20 segundos</td>
</tr>
<tr>
<td><strong>Rate Limit</strong></td>
<td>100 requests/minute</td>
</tr>
</tbody>
</table>
<h3 id="openapi-specification">OpenAPI Specification</h3>
<div class="sourceCode" id="cb71"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">openapi</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.0.0</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">info</span><span class="kw">:</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> SIPUA Validation API</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0.0</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">servers</span><span class="kw">:</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> https://sipua.caixaseguradora.com.br/api/v1</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Production</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> https://sipua-hom.caixaseguradora.com.br/api/v1</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Homologation</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">/validate</span><span class="kw">:</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">post</span><span class="kw">:</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">summary</span><span class="kw">:</span><span class="at"> Validate EFP Contract</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">security</span><span class="kw">:</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">bearerAuth</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">requestBody</span><span class="kw">:</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">content</span><span class="kw">:</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">application/json</span><span class="kw">:</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">schema</span><span class="kw">:</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">type</span><span class="kw">:</span><span class="at"> object</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">required</span><span class="kw">:</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="kw">-</span><span class="at"> contractType</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="kw">-</span><span class="at"> contractNumber</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="kw">-</span><span class="at"> amount</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="kw">-</span><span class="at"> claimNumber</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">contractType</span><span class="kw">:</span></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">enum</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">EFP</span><span class="kw">]</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">contractNumber</span><span class="kw">:</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">pattern</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;^EFP[0-9]{9}$&#39;</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">amount</span><span class="kw">:</span></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">format</span><span class="kw">:</span><span class="at"> decimal</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">minimum</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.01</span></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">claimNumber</span><span class="kw">:</span></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">requestDate</span><span class="kw">:</span></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">format</span><span class="kw">:</span><span class="at"> date</span></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">responses</span><span class="kw">:</span></span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;200&#39;</span><span class="kw">:</span></span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Validation successful</span></span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">content</span><span class="kw">:</span></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="fu">application/json</span><span class="kw">:</span></span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a><span class="at">              </span><span class="fu">schema</span><span class="kw">:</span></span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">type</span><span class="kw">:</span><span class="at"> object</span></span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a><span class="at">                </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">validated</span><span class="kw">:</span></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> boolean</span></span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">status</span><span class="kw">:</span></span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">enum</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">APPROVED</span><span class="kw">,</span><span class="at"> REJECTED</span><span class="kw">,</span><span class="at"> PENDING</span><span class="kw">]</span></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">availableLimit</span><span class="kw">:</span></span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> number</span></span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> decimal</span></span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">expirationDate</span><span class="kw">:</span></span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> date</span></span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a><span class="at">                  </span><span class="fu">message</span><span class="kw">:</span></span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a><span class="at">                    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;400&#39;</span><span class="kw">:</span></span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Invalid request</span></span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;401&#39;</span><span class="kw">:</span></span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Unauthorized</span></span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;429&#39;</span><span class="kw">:</span></span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Rate limit exceeded</span></span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">&#39;500&#39;</span><span class="kw">:</span></span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Internal server error</span></span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a><span class="fu">components</span><span class="kw">:</span></span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">securitySchemes</span><span class="kw">:</span></span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">bearerAuth</span><span class="kw">:</span></span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> http</span></span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">scheme</span><span class="kw">:</span><span class="at"> bearer</span></span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">bearerFormat</span><span class="kw">:</span><span class="at"> JWT</span></span></code></pre></div>
<h3 id="exemplo-de-integração">Exemplo de Integração</h3>
<p><strong>Request:</strong></p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST https://sipua.caixaseguradora.com.br/api/v1/validate <span class="dt">\</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;</span> <span class="dt">\</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">&#39;{</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;contractType&quot;: &quot;EFP&quot;,</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;contractNumber&quot;: &quot;EFP123456789&quot;,</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;amount&quot;: 25000.00,</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;claimNumber&quot;: &quot;10/20/789012&quot;,</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;requestDate&quot;: &quot;2025-10-27&quot;</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">  }&#39;</span></span></code></pre></div>
<p><strong>Response:</strong></p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;validated&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;APPROVED&quot;</span><span class="fu">,</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;availableLimit&quot;</span><span class="fu">:</span> <span class="fl">75000.00</span><span class="fu">,</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;expirationDate&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Contract validated successfully&quot;</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="fluxo-de-autenticação">Fluxo de Autenticação</h3>
<pre class="mermaid"><code>sequenceDiagram
    participant SIWEA
    participant Auth as SIPUA Auth
    participant API as SIPUA API
    
    SIWEA-&gt;&gt;Auth: POST /auth/token (credentials)
    Auth--&gt;&gt;SIWEA: JWT Token (expires in 1h)
    SIWEA-&gt;&gt;API: POST /validate (with Bearer token)
    API--&gt;&gt;SIWEA: Validation result</code></pre>
<hr />
<h2 id="simda---sistema-de-validação-hb">SIMDA - Sistema de Validação
HB</h2>
<h3 id="especificação-técnica-2">Especificação Técnica</h3>
<table>
<thead>
<tr>
<th>Atributo</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Queue Manager</strong></td>
<td>QM.SIMDA.PRD</td>
</tr>
<tr>
<td><strong>Request Queue</strong></td>
<td>SIMDA.VALIDATION.REQ</td>
</tr>
<tr>
<td><strong>Response Queue</strong></td>
<td>SIMDA.VALIDATION.RSP</td>
</tr>
<tr>
<td><strong>Reply Queue</strong></td>
<td>SIMDA.VALIDATION.REPLY</td>
</tr>
<tr>
<td><strong>Protocol</strong></td>
<td>IBM MQ Series</td>
</tr>
<tr>
<td><strong>Format</strong></td>
<td>Fixed-width text</td>
</tr>
<tr>
<td><strong>Encoding</strong></td>
<td>EBCDIC</td>
</tr>
<tr>
<td><strong>Timeout</strong></td>
<td>25 segundos</td>
</tr>
</tbody>
</table>
<h3 id="formato-de-mensagem">Formato de Mensagem</h3>
<h4 id="request-message-200-bytes">Request Message (200 bytes)</h4>
<pre><code>Position  Length  Field           Type      Description
001-010   10      Contract#       CHAR      Contract number
011-025   15      Amount          DEC(15,2) Amount (packed)
026-035   10      ClaimNumber     CHAR      Claim reference
036-043   8       RequestDate     DATE      YYYYMMDD
044-051   8       RequestTime     TIME      HHMMSSTH
052-059   8       CorrelationID   CHAR      Unique ID
060-200   141     Filler          CHAR      Spaces</code></pre>
<h4 id="response-message-100-bytes">Response Message (100 bytes)</h4>
<pre><code>Position  Length  Field           Type      Description
001-001   1       Status          CHAR      A=Approved, R=Rejected
002-016   15      AvailableAmt    DEC(15,2) Available amount
017-024   8       ExpiryDate      DATE      YYYYMMDD
025-032   8       CorrelationID   CHAR      Same as request
033-082   50      Message         CHAR      Status message
083-100   18      Filler          CHAR      Spaces</code></pre>
<h3 id="código-de-integração-cobol">Código de Integração COBOL</h3>
<pre class="cobol"><code>WORKING-STORAGE SECTION.
01  MQ-CONSTANTS.
    05  MQ-CONN-HANDLE      PIC S9(9) BINARY.
    05  MQ-OBJECT-HANDLE    PIC S9(9) BINARY.
    05  MQ-COMP-CODE        PIC S9(9) BINARY.
    05  MQ-REASON           PIC S9(9) BINARY.

01  SIMDA-REQUEST.
    05  SIMDA-CONTRACT      PIC X(10).
    05  SIMDA-AMOUNT        PIC S9(13)V99 COMP-3.
    05  SIMDA-CLAIM         PIC X(10).
    05  SIMDA-REQ-DATE      PIC 9(08).
    05  SIMDA-REQ-TIME      PIC 9(08).
    05  SIMDA-CORREL-ID     PIC X(08).
    05  FILLER              PIC X(141).

01  SIMDA-RESPONSE.
    05  SIMDA-STATUS        PIC X(01).
        88  SIMDA-APPROVED  VALUE &#39;A&#39;.
        88  SIMDA-REJECTED  VALUE &#39;R&#39;.
    05  SIMDA-AVAIL-AMT     PIC S9(13)V99 COMP-3.
    05  SIMDA-EXPIRY        PIC 9(08).
    05  SIMDA-RESP-CORR     PIC X(08).
    05  SIMDA-MESSAGE       PIC X(50).
    05  FILLER              PIC X(18).

PROCEDURE DIVISION.
VALIDATE-WITH-SIMDA SECTION.
    PERFORM CONNECT-TO-MQ
    PERFORM BUILD-REQUEST
    PERFORM SEND-TO-MQ
    PERFORM RECEIVE-FROM-MQ
    PERFORM PROCESS-RESPONSE
    PERFORM DISCONNECT-FROM-MQ.

CONNECT-TO-MQ.
    CALL &#39;MQCONN&#39; USING QM-NAME
                        MQ-CONN-HANDLE
                        MQ-COMP-CODE
                        MQ-REASON.

SEND-TO-MQ.
    CALL &#39;MQPUT&#39; USING MQ-CONN-HANDLE
                       MQ-OBJECT-HANDLE
                       MQ-MSG-DESC
                       MQ-PUT-OPTIONS
                       SIMDA-REQUEST-LENGTH
                       SIMDA-REQUEST
                       MQ-COMP-CODE
                       MQ-REASON.</code></pre>
<hr />
<h2 id="estratégias-de-resiliência">Estratégias de Resiliência</h2>
<h3 id="circuit-breaker-pattern">Circuit Breaker Pattern</h3>
<pre><code>Estados:
    CLOSED: Sistema funcionando normalmente
    OPEN: Sistema com falha, requisições rejeitadas
    HALF_OPEN: Testando recuperação

Transições:
    CLOSED → OPEN: 5 falhas consecutivas
    OPEN → HALF_OPEN: Após 30 segundos
    HALF_OPEN → CLOSED: 1 sucesso
    HALF_OPEN → OPEN: 1 falha</code></pre>
<h3 id="retry-policy">Retry Policy</h3>
<div class="sourceCode" id="cb79"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">retryPolicy</span><span class="kw">:</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">maxAttempts</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">backoffStrategy</span><span class="kw">:</span><span class="at"> exponential</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">initialDelay</span><span class="kw">:</span><span class="at"> 1000ms</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">maxDelay</span><span class="kw">:</span><span class="at"> 8000ms</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">multiplier</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">retryableErrors</span><span class="kw">:</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> TIMEOUT</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> CONNECTION_REFUSED</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> SERVICE_UNAVAILABLE</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nonRetryableErrors</span><span class="kw">:</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> INVALID_CONTRACT</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> INSUFFICIENT_FUNDS</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> AUTHENTICATION_FAILED</span></span></code></pre></div>
<h3 id="modo-contingência">Modo Contingência</h3>
<pre><code>ATIVAÇÃO:
    - Todos os sistemas externos indisponíveis
    - Autorização manual do supervisor
    - Horário de contingência (22h-6h)

COMPORTAMENTO:
    - Aprovar até R$ 10.000 automaticamente
    - Valores maiores requerem dupla aprovação
    - Flag CONTINGENCY = &#39;Y&#39; no registro
    - Revalidação posterior obrigatória

DESATIVAÇÃO:
    - Sistemas voltam online
    - Processamento de backlog
    - Reconciliação de transações</code></pre>
<hr />
<h2 id="monitoramento-e-alertas">Monitoramento e Alertas</h2>
<h3 id="métricas-monitoradas">Métricas Monitoradas</h3>
<table>
<thead>
<tr>
<th>Métrica</th>
<th>Threshold</th>
<th>Alerta</th>
<th>Ação</th>
</tr>
</thead>
<tbody>
<tr>
<td>Response Time CNOUA</td>
<td>&gt; 10s</td>
<td>Warning</td>
<td>Check network</td>
</tr>
<tr>
<td>Response Time SIPUA</td>
<td>&gt; 8s</td>
<td>Warning</td>
<td>Check load</td>
</tr>
<tr>
<td>Response Time SIMDA</td>
<td>&gt; 12s</td>
<td>Warning</td>
<td>Check queue</td>
</tr>
<tr>
<td>Error Rate</td>
<td>&gt; 5%</td>
<td>Critical</td>
<td>Activate contingency</td>
</tr>
<tr>
<td>Timeout Rate</td>
<td>&gt; 10%</td>
<td>Critical</td>
<td>Increase timeout</td>
</tr>
<tr>
<td>Queue Depth SIMDA</td>
<td>&gt; 1000</td>
<td>Warning</td>
<td>Scale consumers</td>
</tr>
</tbody>
</table>
<h3 id="dashboard-de-integração">Dashboard de Integração</h3>
<pre><code>┌─────────────────────────────────────────────┐
│         INTEGRATION DASHBOARD                │
├─────────────────────────────────────────────┤
│                                             │
│ CNOUA    [████████░░] 85% Available        │
│          Avg: 2.3s | P99: 8.5s             │
│                                             │
│ SIPUA    [██████████] 100% Available       │
│          Avg: 1.8s | P99: 5.2s             │
│                                             │
│ SIMDA    [███████░░░] 70% Available        │
│          Avg: 3.1s | P99: 12.3s            │
│          Queue: 234 messages               │
│                                             │
│ Circuit Breaker States:                     │
│   CNOUA: CLOSED                            │
│   SIPUA: CLOSED                            │
│   SIMDA: HALF_OPEN                         │
│                                             │
│ Last 24h: 1,245 validations               │
│   Success: 1,198 (96.2%)                   │
│   Failed: 47 (3.8%)                        │
└─────────────────────────────────────────────┘</code></pre>
<hr />
<h2 id="configuração-de-ambientes">Configuração de Ambientes</h2>
<h3 id="desenvolvimento">Desenvolvimento</h3>
<pre class="properties"><code># DEV Environment
cnoua.endpoint=http://cnoua-dev.internal:8080/validacao
cnoua.timeout=60000
cnoua.mock=true

sipua.endpoint=http://localhost:8081/mock/sipua
sipua.timeout=30000
sipua.mock=true

simda.queueManager=QM.SIMDA.DEV
simda.mock=true</code></pre>
<h3 id="homologação">Homologação</h3>
<pre class="properties"><code># HOM Environment
cnoua.endpoint=http://cnoua-hom.caixaseguradora.com.br:8080/validacao
cnoua.timeout=30000
cnoua.mock=false

sipua.endpoint=https://sipua-hom.caixaseguradora.com.br/api/v1
sipua.timeout=20000
sipua.mock=false

simda.queueManager=QM.SIMDA.HOM
simda.mock=false</code></pre>
<h3 id="produção">Produção</h3>
<pre class="properties"><code># PRD Environment
cnoua.endpoint=http://cnoua.caixaseguradora.com.br:8080/validacao
cnoua.timeout=30000
cnoua.mock=false
cnoua.circuitBreaker=true

sipua.endpoint=https://sipua.caixaseguradora.com.br/api/v1
sipua.timeout=20000
sipua.mock=false
sipua.circuitBreaker=true

simda.queueManager=QM.SIMDA.PRD
simda.mock=false
simda.circuitBreaker=true</code></pre>
<hr />
<h2 id="testes-de-integração">Testes de Integração</h2>
<h3 id="cenários-de-teste">Cenários de Teste</h3>
<ol type="1">
<li><strong>Happy Path</strong>
<ul>
<li>Validação aprovada</li>
<li>Response time &lt; SLA</li>
<li>Dados corretos retornados</li>
</ul></li>
<li><strong>Validação Rejeitada</strong>
<ul>
<li>Limite excedido</li>
<li>Contrato inválido</li>
<li>Produto não elegível</li>
</ul></li>
<li><strong>Timeout</strong>
<ul>
<li>Sistema não responde</li>
<li>Retry funciona</li>
<li>Circuit breaker ativa</li>
</ul></li>
<li><strong>Erro de Sistema</strong>
<ul>
<li>Sistema retorna erro 500</li>
<li>Mensagem de erro tratada</li>
<li>Fallback ativado</li>
</ul></li>
<li><strong>Modo Contingência</strong>
<ul>
<li>Todos sistemas offline</li>
<li>Aprovação manual</li>
<li>Flag contingência setada</li>
</ul></li>
</ol>
<h3 id="scripts-de-teste">Scripts de Teste</h3>
<div class="sourceCode" id="cb85"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test CNOUA Integration</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test successful validation</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST http://cnoua-test:8080/validacao <span class="dt">\</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: text/xml&quot;</span> <span class="dt">\</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> @test-data/cnoua-success.xml</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test timeout scenario</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">timeout</span> 5 curl <span class="at">-X</span> POST http://cnoua-test:8080/validacao <span class="dt">\</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">&quot;Content-Type: text/xml&quot;</span> <span class="dt">\</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> @test-data/cnoua-timeout.xml</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Test circuit breaker</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">10</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="ex">curl</span> <span class="at">-X</span> POST http://cnoua-test:8080/validacao <span class="dt">\</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;Content-Type: text/xml&quot;</span> <span class="dt">\</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">-d</span> @test-data/cnoua-error.xml</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<hr />
<p><em>Este documento detalha todas as integrações externas do sistema
SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="guia-de-operações-sistema-legado-siwea">07 - Guia de Operações:
Sistema Legado SIWEA</h1>
<hr />
<h2 id="procedimentos-operacionais">Procedimentos Operacionais</h2>
<h3 id="inicialização-do-sistema">Inicialização do Sistema</h3>
<h4 id="startup-sequence">Startup Sequence</h4>
<pre><code>1. Verificar DB2 está online
2. Verificar CICS region está ativo
3. Verificar conectividade MQ Series
4. Carregar programas COBOL
5. Inicializar pools de conexão
6. Validar integrações externas
7. Liberar transações para usuários</code></pre>
<h4 id="comandos-cics">Comandos CICS</h4>
<pre><code>CEMT SET PROGRAM(SIWEA116) ENABLED
CEMT SET TRANSACTION(SI10) ENABLED
CEMT SET TRANSACTION(SI20) ENABLED
CEMT INQ TRANSACTION(SI*) </code></pre>
<h3 id="shutdown-procedures">Shutdown Procedures</h3>
<pre><code>1. Bloquear novas transações
2. Aguardar transações em andamento
3. Fazer checkpoint do banco
4. Desconectar integrações
5. Shutdown CICS region
6. Backup incremental</code></pre>
<hr />
<h2 id="monitoramento-1">Monitoramento</h2>
<h3 id="indicadores-críticos">Indicadores Críticos</h3>
<table>
<thead>
<tr>
<th>Indicador</th>
<th>Normal</th>
<th>Warning</th>
<th>Critical</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU Usage</td>
<td>&lt; 60%</td>
<td>60-80%</td>
<td>&gt; 80%</td>
</tr>
<tr>
<td>Memory Usage</td>
<td>&lt; 70%</td>
<td>70-85%</td>
<td>&gt; 85%</td>
</tr>
<tr>
<td>Response Time</td>
<td>&lt; 3s</td>
<td>3-5s</td>
<td>&gt; 5s</td>
</tr>
<tr>
<td>DB Connections</td>
<td>&lt; 150</td>
<td>150-180</td>
<td>&gt; 180</td>
</tr>
<tr>
<td>Queue Depth</td>
<td>&lt; 100</td>
<td>100-500</td>
<td>&gt; 500</td>
</tr>
<tr>
<td>Error Rate</td>
<td>&lt; 1%</td>
<td>1-3%</td>
<td>&gt; 3%</td>
</tr>
</tbody>
</table>
<h3 id="comandos-de-monitoramento">Comandos de Monitoramento</h3>
<div class="sourceCode" id="cb89"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar status CICS</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="ex">CEMT</span> INQ SYSTEM</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar transações ativas</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="ex">CEMT</span> INQ TASK</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar DB2 connections</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="ex">-DIS</span> DDF DETAIL</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar MQ queues</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;DISPLAY QSTATUS(SIMDA.VALIDATION.REQ) CURDEPTH&quot;</span> <span class="kw">|</span> <span class="ex">runmqsc</span> QM.SIMDA.PRD</span></code></pre></div>
<hr />
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="problemas-comuns">Problemas Comuns</h3>
<h4 id="timeout-em-busca">1. Timeout em Busca</h4>
<p><strong>Sintomas:</strong> - Busca demora mais de 10 segundos -
Timeout error na tela</p>
<p><strong>Diagnóstico:</strong></p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verificar locks</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> SYSIBM.SYSLOCKS <span class="kw">WHERE</span> TABLENAME <span class="op">=</span> <span class="st">&#39;TMESTSIN&#39;</span>;</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Verificar índices</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>RUNSTATS <span class="kw">TABLESPACE</span> DBSIWEA.TSTMEST <span class="kw">INDEX</span> <span class="kw">ALL</span>;</span></code></pre></div>
<p><strong>Solução:</strong> 1. Verificar e resolver locks 2.
Reorganizar índices 3. Atualizar estatísticas</p>
<h4 id="falha-na-integração">2. Falha na Integração</h4>
<p><strong>Sintomas:</strong> - Erro E0010 na autorização - Validação
externa não responde</p>
<p><strong>Diagnóstico:</strong></p>
<div class="sourceCode" id="cb91"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test connectivity</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ping</span> cnoua.caixaseguradora.com.br</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="ex">telnet</span> sipua.caixaseguradora.com.br 443</span></code></pre></div>
<p><strong>Solução:</strong> 1. Verificar conectividade 2. Verificar
certificados SSL 3. Ativar modo contingência se necessário</p>
<h4 id="erro-de-concorrência">3. Erro de Concorrência</h4>
<p><strong>Sintomas:</strong> - “Record locked by another user” -
Deadlock detected</p>
<p><strong>Diagnóstico:</strong></p>
<div class="sourceCode" id="cb92"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Identificar locks</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> AGENT_ID, LOCK_OBJECT_NAME, LOCK_MODE</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> <span class="kw">TABLE</span>(SNAP_GET_LOCK(<span class="st">&#39;&#39;</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="kw">AS</span> T</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> LOCK_OBJECT_TYPE <span class="op">=</span> <span class="st">&#39;TABLE&#39;</span>;</span></code></pre></div>
<p><strong>Solução:</strong> 1. Identificar transação bloqueadora 2.
Fazer rollback se necessário 3. Implementar retry logic</p>
<hr />
<h2 id="backup-e-recovery">Backup e Recovery</h2>
<h3 id="estratégia-de-backup-1">Estratégia de Backup</h3>
<table>
<thead>
<tr>
<th>Tipo</th>
<th>Frequência</th>
<th>Retenção</th>
<th>Janela</th>
</tr>
</thead>
<tbody>
<tr>
<td>Full</td>
<td>Semanal (Dom)</td>
<td>90 dias</td>
<td>00:00-06:00</td>
</tr>
<tr>
<td>Incremental</td>
<td>Diário</td>
<td>30 dias</td>
<td>02:00-04:00</td>
</tr>
<tr>
<td>Log</td>
<td>4 horas</td>
<td>7 dias</td>
<td>Contínuo</td>
</tr>
<tr>
<td>Archive</td>
<td>Mensal</td>
<td>7 anos</td>
<td>1º domingo</td>
</tr>
</tbody>
</table>
<h3 id="procedimento-de-restore">Procedimento de Restore</h3>
<div class="sourceCode" id="cb93"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Stop application</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="ex">CEMT</span> SET TRANSACTION<span class="er">(</span><span class="ex">SI*</span><span class="kw">)</span> <span class="ex">DISABLED</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Restore database</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="ex">db2</span> restore database DBSIWEA from /backup/full taken at 20251027</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Roll forward logs</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="ex">db2</span> rollforward database DBSIWEA to end of logs</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Verify integrity</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="ex">db2</span> connect to DBSIWEA</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="ex">db2</span> <span class="st">&quot;SELECT COUNT(*) FROM TMESTSIN&quot;</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Restart application</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="ex">CEMT</span> SET TRANSACTION<span class="er">(</span><span class="ex">SI*</span><span class="kw">)</span> <span class="ex">ENABLED</span></span></code></pre></div>
<hr />
<h2 id="manutenção-programada">Manutenção Programada</h2>
<h3 id="tarefas-diárias">Tarefas Diárias</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Verificar logs de erro</label></li>
<li><label><input type="checkbox" />Monitorar performance</label></li>
<li><label><input type="checkbox" />Verificar backup
noturno</label></li>
<li><label><input type="checkbox" />Revisar alertas</label></li>
</ul>
<h3 id="tarefas-semanais">Tarefas Semanais</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Reorganizar índices</label></li>
<li><label><input type="checkbox" />Atualizar estatísticas</label></li>
<li><label><input type="checkbox" />Limpar logs antigos</label></li>
<li><label><input type="checkbox" />Revisar capacity
planning</label></li>
</ul>
<h3 id="tarefas-mensais">Tarefas Mensais</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Teste de restore</label></li>
<li><label><input type="checkbox" />Análise de performance</label></li>
<li><label><input type="checkbox" />Atualização de
documentação</label></li>
<li><label><input type="checkbox" />Simulação de DR</label></li>
</ul>
<hr />
<h2 id="segurança-operacional">Segurança Operacional</h2>
<h3 id="checklist-de-segurança">Checklist de Segurança</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Patches de segurança
aplicados</label></li>
<li><label><input type="checkbox" />Certificados SSL
válidos</label></li>
<li><label><input type="checkbox" />Senhas dentro da
política</label></li>
<li><label><input type="checkbox" />Logs de auditoria
ativos</label></li>
<li><label><input type="checkbox" />Backups criptografados</label></li>
<li><label><input type="checkbox" />Acesso restrito a
produção</label></li>
</ul>
<h3 id="resposta-a-incidentes">Resposta a Incidentes</h3>
<pre><code>1. DETECÇÃO
   - Alerta automático
   - Relato de usuário
   
2. CONTENÇÃO
   - Isolar sistema afetado
   - Bloquear acesso suspeito
   
3. INVESTIGAÇÃO
   - Coletar logs
   - Analisar root cause
   
4. REMEDIAÇÃO
   - Aplicar correção
   - Testar solução
   
5. DOCUMENTAÇÃO
   - Registrar incidente
   - Atualizar procedimentos</code></pre>
<hr />
<p><em>Este documento contém os procedimentos operacionais do sistema
SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="interface-e-telas-sistema-legado-siwea">08 - Interface e Telas:
Sistema Legado SIWEA</h1>
<hr />
<h2 id="visão-geral-da-interface">Visão Geral da Interface</h2>
<h3 id="características-do-terminal-3270">Características do Terminal
3270</h3>
<table>
<thead>
<tr>
<th>Propriedade</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Resolução</strong></td>
<td>80 colunas × 24 linhas</td>
</tr>
<tr>
<td><strong>Caracteres</strong></td>
<td>EBCDIC</td>
</tr>
<tr>
<td><strong>Cores</strong></td>
<td>Verde sobre preto (monocromático)</td>
</tr>
<tr>
<td><strong>Navegação</strong></td>
<td>Teclado apenas (sem mouse)</td>
</tr>
<tr>
<td><strong>Atributos</strong></td>
<td>Normal, Bright, Hidden, Protected</td>
</tr>
<tr>
<td><strong>Teclas Função</strong></td>
<td>PF1-PF24</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="mapa-de-navegação">Mapa de Navegação</h2>
<pre><code>                Menu Principal
                     SI00M000
                        │
        ┌───────────────┼───────────────┐
        │               │               │
    SI11M010        SI11M020        SI11M030
    Busca           Histórico       Relatórios
    Sinistro        Sinistro           │
        │               │               │
        └───────┬───────┘               │
                │                       │
            SIHM020                 SI11M040
          Autorização               Dashboard
           Pagamento                Gerencial</code></pre>
<hr />
<h2 id="telas-detalhadas">Telas Detalhadas</h2>
<h3 id="si00m000---menu-principal">SI00M000 - Menu Principal</h3>
<pre><code>================================================================================
                    SIWEA - SISTEMA DE LIBERAÇÃO DE PAGAMENTOS                 
                              MENU PRINCIPAL                                   
================================================================================

    SELECIONE A OPÇÃO DESEJADA:

    1. BUSCAR SINISTRO............................ SI11M010
    2. CONSULTAR HISTÓRICO........................ SI11M020  
    3. AUTORIZAR PAGAMENTO....................... SIHM020
    4. RELATÓRIOS................................ SI11M030
    5. DASHBOARD GERENCIAL....................... SI11M040
    6. MANUTENÇÃO DE TABELAS.................... SI11M050
    7. CONFIGURAÇÕES............................ SI11M060
    8. SAIR DO SISTEMA.......................... 

    OPÇÃO: [ ]

    USUÁRIO: OPER001              TERMINAL: TERM01
    DATA: 27/10/2025              HORA: 14:35:22

================================================================================
 PF1=AJUDA  PF3=SAIR  PF12=CANCELAR  ENTER=CONFIRMAR
================================================================================</code></pre>
<h3 id="si11m010---busca-de-sinistros-1">SI11M010 - Busca de
Sinistros</h3>
<pre><code>================================================================================
 SI11M010            BUSCA DE SINISTROS                        27/10/25 14:35
================================================================================

 INFORME UM DOS CRITÉRIOS DE BUSCA:

 1) BUSCA POR PROTOCOLO:
    FONTE....: [___]     (001-999)
    PROTOCOLO: [_______] (0000001-9999999)
    DAC......: [_]       (0-9)

 2) BUSCA POR NÚMERO DO SINISTRO:
    ORIGEM...: [__]      (01-99)
    RAMO.....: [__]      (01-50)
    NÚMERO...: [______]  (000001-999999)

 3) BUSCA POR CÓDIGO LÍDER:
    LÍDER....: [___]     (001-999)
    SINISTRO.: [_______] (0000001-9999999)

 MENSAGEM: _________________________________________________________________

================================================================================
 PF3=VOLTAR  PF5=LIMPAR  PF12=CANCELAR  ENTER=BUSCAR
================================================================================</code></pre>
<h3 id="sihm020---autorização-de-pagamento-1">SIHM020 - Autorização de
Pagamento</h3>
<pre><code>================================================================================
 SIHM020          AUTORIZAÇÃO DE PAGAMENTO                     27/10/25 14:40
================================================================================

 DADOS DO SINISTRO:
 ------------------
 PROTOCOLO.......: 001/0123456-7        STATUS........: ATIVO
 SINISTRO........: 10/20/789012         DATA ABERTURA.: 15/03/2025
 RAMO............: 20 - AUTOMÓVEIS      
 SEGURADO........: JOÃO SILVA SANTOS
 CPF/CNPJ........: 123.456.789-00
 
 VALORES:
 ---------
 RESERVA ESPERADA: R$    100.000,00
 TOTAL PAGO......: R$     40.000,00
 SALDO DISPONÍVEL: R$     60.000,00

 DADOS DA AUTORIZAÇÃO:
 ----------------------
 TIPO PAGAMENTO..: [_] (1-Total 2-Parcial 3-Complementar 4-Ajuste 5-Recalc)
 TIPO APÓLICE....: [_] (1-Individual 2-Coletiva)
 VALOR PRINCIPAL.: [___________,__]
 VALOR CORREÇÃO..: [___________,__] (Opcional)
 FAVORECIDO......: [__________________________________________________]
 
 TOTAL A PAGAR...:      0,00

================================================================================
 PF3=VOLTAR  PF6=CALCULAR  PF10=CONFIRMAR  PF12=CANCELAR  ENTER=VALIDAR
================================================================================</code></pre>
<h3 id="si11m020---histórico-de-pagamentos">SI11M020 - Histórico de
Pagamentos</h3>
<pre><code>================================================================================
 SI11M020         HISTÓRICO DE PAGAMENTOS                      27/10/25 14:45
================================================================================
 SINISTRO: 10/20/789012                    PROTOCOLO: 001/0123456-7
 
 SEQ  DATA       HORA     TIPO  PRINCIPAL    CORREÇÃO     TOTAL      OPERADOR
 ---  ---------- -------- ----  ------------ ------------ ---------- --------
 001  15/03/2025 09:15:32  1    10.000,00    0,00         10.000,00  OPER001
 002  20/04/2025 14:22:15  2    15.000,00    500,00       15.500,00  OPER002
 003  10/05/2025 11:08:44  2    10.000,00    300,00       10.300,00  OPER001
 004  25/06/2025 16:55:21  3    5.000,00     200,00       5.200,00   OPER003
 
 
 
 
 
 TOTAL PAGO: R$ 40.000,00          SALDO: R$ 60.000,00
 
 PÁGINA 1 DE 1                                              
================================================================================
 PF3=VOLTAR  PF7=ANTERIOR  PF8=PRÓXIMA  PF11=IMPRIMIR  PF12=SAIR
================================================================================</code></pre>
<h3 id="si11m030---relatórios">SI11M030 - Relatórios</h3>
<pre><code>================================================================================
 SI11M030              MENU DE RELATÓRIOS                      27/10/25 14:50
================================================================================

 SELECIONE O RELATÓRIO:

 1. [ ] PAGAMENTOS DO DIA
 2. [ ] PAGAMENTOS DO MÊS
 3. [ ] SINISTROS PENDENTES
 4. [ ] ANÁLISE POR RAMO
 5. [ ] ANÁLISE POR PRODUTO
 6. [ ] RELATÓRIO DE AUDITORIA
 7. [ ] ESTATÍSTICAS GERENCIAIS

 PARÂMETROS:
 ------------
 DATA INICIAL....: [__/__/____]
 DATA FINAL......: [__/__/____]
 RAMO............: [__] (Branco = Todos)
 PRODUTO.........: [____] (Branco = Todos)
 
 FORMATO.........: [_] (1-Tela 2-Impressora 3-Arquivo)
 
================================================================================
 PF3=VOLTAR  PF6=EXECUTAR  PF12=CANCELAR  ENTER=VALIDAR
================================================================================</code></pre>
<hr />
<h2 id="fluxos-de-navegação">Fluxos de Navegação</h2>
<h3 id="fluxo-de-busca-e-autorização">Fluxo de Busca e Autorização</h3>
<pre class="mermaid"><code>graph TD
    A[Menu Principal] --&gt; B[Busca Sinistro]
    B --&gt; C{Encontrou?}
    C --&gt;|Sim| D[Mostra Dados]
    C --&gt;|Não| E[Mensagem Erro]
    E --&gt; B
    D --&gt; F[Autorizar Pagamento]
    F --&gt; G{Validar}
    G --&gt;|OK| H[Confirmar]
    G --&gt;|Erro| I[Mostrar Erro]
    I --&gt; F
    H --&gt; J[Gravar]
    J --&gt; K[Sucesso]
    K --&gt; A</code></pre>
<hr />
<h2 id="atributos-de-campos">Atributos de Campos</h2>
<h3 id="tipos-de-campos">Tipos de Campos</h3>
<table>
<thead>
<tr>
<th>Tipo</th>
<th>Símbolo</th>
<th>Descrição</th>
<th>Input</th>
</tr>
</thead>
<tbody>
<tr>
<td>Protected</td>
<td><code>[texto]</code></td>
<td>Apenas leitura</td>
<td>Não</td>
</tr>
<tr>
<td>Unprotected</td>
<td><code>[____]</code></td>
<td>Entrada de dados</td>
<td>Sim</td>
</tr>
<tr>
<td>Hidden</td>
<td><code>[****]</code></td>
<td>Senha/Oculto</td>
<td>Sim</td>
</tr>
<tr>
<td>Bright</td>
<td><code>*texto*</code></td>
<td>Destaque</td>
<td>Não</td>
</tr>
<tr>
<td>Normal</td>
<td><code>texto</code></td>
<td>Normal</td>
<td>Não</td>
</tr>
</tbody>
</table>
<h3 id="validações-de-campo">Validações de Campo</h3>
<pre><code>NUMERIC:     Apenas dígitos 0-9
ALPHA:       Apenas letras A-Z
ALPHANUMERIC: Letras e números
DECIMAL:     Números com vírgula
DATE:        DD/MM/AAAA
TIME:        HH:MM:SS</code></pre>
<hr />
<h2 id="teclas-de-função">Teclas de Função</h2>
<h3 id="mapeamento-global">Mapeamento Global</h3>
<table>
<thead>
<tr>
<th>Tecla</th>
<th>Função</th>
<th>Disponível</th>
</tr>
</thead>
<tbody>
<tr>
<td>PF1</td>
<td>Ajuda</td>
<td>Sempre</td>
</tr>
<tr>
<td>PF3</td>
<td>Voltar/Sair</td>
<td>Sempre</td>
</tr>
<tr>
<td>PF5</td>
<td>Limpar</td>
<td>Telas entrada</td>
</tr>
<tr>
<td>PF6</td>
<td>Calcular</td>
<td>Quando aplicável</td>
</tr>
<tr>
<td>PF7</td>
<td>Página Anterior</td>
<td>Listas</td>
</tr>
<tr>
<td>PF8</td>
<td>Página Próxima</td>
<td>Listas</td>
</tr>
<tr>
<td>PF10</td>
<td>Confirmar</td>
<td>Ações críticas</td>
</tr>
<tr>
<td>PF11</td>
<td>Imprimir</td>
<td>Quando aplicável</td>
</tr>
<tr>
<td>PF12</td>
<td>Cancelar</td>
<td>Sempre</td>
</tr>
<tr>
<td>ENTER</td>
<td>Validar/Próximo</td>
<td>Sempre</td>
</tr>
<tr>
<td>TAB</td>
<td>Próximo campo</td>
<td>Sempre</td>
</tr>
<tr>
<td>CLEAR</td>
<td>Limpar tela</td>
<td>Sempre</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="mensagens-do-sistema">Mensagens do Sistema</h2>
<h3 id="tipos-de-mensagem">Tipos de Mensagem</h3>
<pre><code>INFORMAÇÃO: [I] Texto em branco
AVISO:      [A] Texto em amarelo  
ERRO:       [E] Texto em vermelho
SUCESSO:    [S] Texto em verde</code></pre>
<h3 id="mensagens-comuns">Mensagens Comuns</h3>
<table>
<thead>
<tr>
<th>Código</th>
<th>Tipo</th>
<th>Mensagem</th>
</tr>
</thead>
<tbody>
<tr>
<td>I001</td>
<td>Info</td>
<td>Processando, aguarde…</td>
</tr>
<tr>
<td>I002</td>
<td>Info</td>
<td>Nenhum registro encontrado</td>
</tr>
<tr>
<td>S001</td>
<td>Sucesso</td>
<td>Operação realizada com sucesso</td>
</tr>
<tr>
<td>S002</td>
<td>Sucesso</td>
<td>Pagamento autorizado</td>
</tr>
<tr>
<td>A001</td>
<td>Aviso</td>
<td>Valor próximo ao limite</td>
</tr>
<tr>
<td>A002</td>
<td>Aviso</td>
<td>Sinistro com pendências</td>
</tr>
<tr>
<td>E001</td>
<td>Erro</td>
<td>Sinistro não encontrado</td>
</tr>
<tr>
<td>E002</td>
<td>Erro</td>
<td>Tipo de pagamento inválido</td>
</tr>
<tr>
<td>E003</td>
<td>Erro</td>
<td>Valor principal obrigatório</td>
</tr>
<tr>
<td>E004</td>
<td>Erro</td>
<td>Beneficiário obrigatório</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="considerações-para-migração-web">Considerações para Migração
Web</h2>
<h3 id="mapeamento-terminal-web">Mapeamento Terminal → Web</h3>
<table>
<thead>
<tr>
<th>3270</th>
<th>Web Equivalent</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tela fixa 80x24</td>
<td>Responsive layout</td>
</tr>
<tr>
<td>Campos protegidos</td>
<td>Readonly inputs</td>
</tr>
<tr>
<td>PF Keys</td>
<td>Buttons/Shortcuts</td>
</tr>
<tr>
<td>Tab navigation</td>
<td>Tab index</td>
</tr>
<tr>
<td>Green screen</td>
<td>Modern UI</td>
</tr>
<tr>
<td>EBCDIC</td>
<td>UTF-8</td>
</tr>
</tbody>
</table>
<h3 id="preservação-de-funcionalidade">Preservação de
Funcionalidade</h3>
<div class="sourceCode" id="cb104"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Simular teclas de função</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;keydown&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(e<span class="op">.</span><span class="at">key</span>) {</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;F1&#39;</span><span class="op">:</span> <span class="fu">showHelp</span>()<span class="op">;</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;F3&#39;</span><span class="op">:</span> <span class="fu">goBack</span>()<span class="op">;</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;F5&#39;</span><span class="op">:</span> <span class="fu">clearForm</span>()<span class="op">;</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;F12&#39;</span><span class="op">:</span> </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;Escape&#39;</span><span class="op">:</span> <span class="fu">cancel</span>()<span class="op">;</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="st">&#39;Enter&#39;</span><span class="op">:</span> <span class="fu">validate</span>()<span class="op">;</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h3 id="css-para-preservar-layout">CSS para Preservar Layout</h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Preservar estilo Site.css original */</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">.terminal-screen</span> {</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">960</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#000</span><span class="op">;</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#0f0</span><span class="op">;</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">.field-protected</span> {</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="dv">transparent</span><span class="op">;</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#0f0</span><span class="op">;</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="fu">.field-input</span> {</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#000</span><span class="op">;</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-bottom</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#0f0</span><span class="op">;</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#0ff</span><span class="op">;</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<p><em>Este documento detalha todas as telas e interfaces do sistema
SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="guia-de-migração-siwea-para-.net-9.0">09 - Guia de Migração:
SIWEA para .NET 9.0</h1>
<hr />
<h2 id="estratégia-de-migração">Estratégia de Migração</h2>
<h3 id="abordagem-recomendada">Abordagem Recomendada</h3>
<p><strong>Tipo:</strong> Big Bang com Parallel Run <strong>Duração
Estimada:</strong> 6 meses <strong>Risco:</strong> Alto
<strong>Complexidade:</strong> Muito Alta</p>
<h3 id="fases-da-migração">Fases da Migração</h3>
<pre class="mermaid"><code>gantt
    title Cronograma de Migração SIWEA
    dateFormat  YYYY-MM-DD
    section Fase 1
    Análise e Documentação    :done, 2025-01-01, 30d
    section Fase 2
    POC e Validação           :active, 2025-02-01, 45d
    section Fase 3
    Desenvolvimento           :2025-03-15, 90d
    section Fase 4
    Testes e Homologação      :2025-06-15, 45d
    section Fase 5
    Parallel Run              :2025-08-01, 60d
    section Fase 6
    Cutover e Go-Live         :2025-10-01, 15d</code></pre>
<hr />
<h2 id="mapeamento-tecnológico">Mapeamento Tecnológico</h2>
<h3 id="stack-transformation">Stack Transformation</h3>
<table>
<thead>
<tr>
<th>Componente</th>
<th>De (Legado)</th>
<th>Para (Moderno)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Linguagem</strong></td>
<td>COBOL/EZEE</td>
<td>C# 13</td>
</tr>
<tr>
<td><strong>Framework</strong></td>
<td>CICS</td>
<td>.NET 9.0</td>
</tr>
<tr>
<td><strong>Frontend</strong></td>
<td>Terminal 3270</td>
<td>React 19 + TypeScript</td>
</tr>
<tr>
<td><strong>Database</strong></td>
<td>DB2 z/OS</td>
<td>SQL Server 2022</td>
</tr>
<tr>
<td><strong>API</strong></td>
<td>CICS Transaction</td>
<td>REST API + SOAP</td>
</tr>
<tr>
<td><strong>Messaging</strong></td>
<td>MQ Series</td>
<td>Azure Service Bus</td>
</tr>
<tr>
<td><strong>Cache</strong></td>
<td>In-memory</td>
<td>Redis</td>
</tr>
<tr>
<td><strong>Auth</strong></td>
<td>RACF</td>
<td>Azure AD + JWT</td>
</tr>
<tr>
<td><strong>Deploy</strong></td>
<td>Mainframe</td>
<td>Azure Kubernetes</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="migração-de-dados">Migração de Dados</h2>
<h3 id="estratégia-etl">Estratégia ETL</h3>
<div class="sourceCode" id="cb107"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 1. Extract from DB2</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>EXPORT <span class="kw">TO</span> tmestsin.csv <span class="kw">OF</span> DEL</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> TMESTSIN;</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- 2. Transform (Python script)</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>import pandas <span class="kw">as</span> pd</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;tmestsin.csv&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;cp500&#39;</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;CREATED_AT&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;CREATED_AT&#39;</span>])</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>df.to_sql(<span class="st">&#39;ClaimMaster&#39;</span>, connection)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">-- 3. Load to SQL Server</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="kw">BULK</span> <span class="kw">INSERT</span> ClaimMaster</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> <span class="st">&#39;transformed_tmestsin.csv&#39;</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="kw">WITH</span> (</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>    FIELDTERMINATOR <span class="op">=</span> <span class="st">&#39;,&#39;</span>,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    ROWTERMINATOR <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    FIRSTROW <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<h3 id="volume-de-dados">Volume de Dados</h3>
<table>
<thead>
<tr>
<th>Tabela</th>
<th>Registros</th>
<th>Tamanho</th>
<th>Tempo Est.</th>
</tr>
</thead>
<tbody>
<tr>
<td>TMESTSIN</td>
<td>500K</td>
<td>2 GB</td>
<td>2 horas</td>
</tr>
<tr>
<td>THISTSIN</td>
<td>2M</td>
<td>8 GB</td>
<td>6 horas</td>
</tr>
<tr>
<td>SI_ACOMPANHA</td>
<td>1.5M</td>
<td>3 GB</td>
<td>3 horas</td>
</tr>
<tr>
<td>SI_SINISTRO_FASE</td>
<td>800K</td>
<td>1.5 GB</td>
<td>2 horas</td>
</tr>
<tr>
<td>Outros</td>
<td>500K</td>
<td>2 GB</td>
<td>2 horas</td>
</tr>
<tr>
<td><strong>TOTAL</strong></td>
<td><strong>5.3M</strong></td>
<td><strong>16.5 GB</strong></td>
<td><strong>15 horas</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="migração-de-código">Migração de Código</h2>
<h3 id="cobol-para-c">COBOL para C</h3>
<h4 id="exemplo-validação-de-pagamento">Exemplo: Validação de
Pagamento</h4>
<p><strong>COBOL Original:</strong></p>
<pre class="cobol"><code>VALIDATE-PAYMENT-TYPE.
    IF WS-PAYMENT-TYPE &lt; 1 OR WS-PAYMENT-TYPE &gt; 5
        MOVE &#39;E0002&#39; TO WS-ERROR-CODE
        MOVE &#39;Tipo de pagamento inválido&#39; TO WS-ERROR-MSG
        PERFORM ERROR-EXIT
    END-IF.
    
CALCULATE-BTNF.
    MULTIPLY WS-PRINCIPAL BY WS-CONVERSION-RATE 
        GIVING WS-PRINCIPAL-BTNF ROUNDED.
    MULTIPLY WS-CORRECTION BY WS-CONVERSION-RATE
        GIVING WS-CORRECTION-BTNF ROUNDED.
    ADD WS-PRINCIPAL-BTNF WS-CORRECTION-BTNF
        GIVING WS-TOTAL-BTNF.</code></pre>
<p><strong>C# Migrado:</strong></p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode csharp"><code class="sourceCode cs"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> PaymentValidator</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">ValidatePaymentType</span><span class="op">(</span><span class="dt">int</span> paymentType<span class="op">)</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>paymentType <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">||</span> paymentType <span class="op">&gt;</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">BusinessException</span><span class="op">(</span><span class="st">&quot;E0002&quot;</span><span class="op">,</span> </span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Tipo de pagamento inválido&quot;</span><span class="op">);</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> BTNFCalculation <span class="fu">CalculateBTNF</span><span class="op">(</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decimal</span> principal<span class="op">,</span> </span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decimal</span> correction<span class="op">,</span> </span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decimal</span> conversionRate<span class="op">)</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">new</span> BTNFCalculation</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>            PrincipalBTNF <span class="op">=</span> Math<span class="op">.</span><span class="fu">Round</span><span class="op">(</span>principal <span class="op">*</span> conversionRate<span class="op">,</span> <span class="dv">2</span><span class="op">),</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>            CorrectionBTNF <span class="op">=</span> Math<span class="op">.</span><span class="fu">Round</span><span class="op">(</span>correction <span class="op">*</span> conversionRate<span class="op">,</span> <span class="dv">2</span><span class="op">),</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>            TotalBTNF <span class="op">=</span> Math<span class="op">.</span><span class="fu">Round</span><span class="op">((</span>principal <span class="op">+</span> correction<span class="op">)</span> <span class="op">*</span> conversionRate<span class="op">,</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">};</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 id="migração-de-telas">Migração de Telas</h2>
<h3 id="terminal-3270-para-react">Terminal 3270 para React</h3>
<p><strong>Terminal Original:</strong></p>
<pre><code> TIPO PAGAMENTO..: [_] (1-Total 2-Parcial...)
 VALOR PRINCIPAL.: [___________,__]</code></pre>
<p><strong>React Component:</strong></p>
<pre class="tsx"><code>const PaymentForm: React.FC = () =&gt; {
  const [paymentType, setPaymentType] = useState(&#39;&#39;);
  const [principalValue, setPrincipalValue] = useState(&#39;&#39;);

  return (
    &lt;div className=&quot;terminal-screen&quot;&gt;
      &lt;div className=&quot;field-row&quot;&gt;
        &lt;label className=&quot;field-label&quot;&gt;TIPO PAGAMENTO.:&lt;/label&gt;
        &lt;select 
          className=&quot;field-input&quot;
          value={paymentType}
          onChange={(e) =&gt; setPaymentType(e.target.value)}
        &gt;
          &lt;option value=&quot;&quot;&gt;Selecione...&lt;/option&gt;
          &lt;option value=&quot;1&quot;&gt;1-Total&lt;/option&gt;
          &lt;option value=&quot;2&quot;&gt;2-Parcial&lt;/option&gt;
          &lt;option value=&quot;3&quot;&gt;3-Complementar&lt;/option&gt;
          &lt;option value=&quot;4&quot;&gt;4-Ajuste&lt;/option&gt;
          &lt;option value=&quot;5&quot;&gt;5-Recalculado&lt;/option&gt;
        &lt;/select&gt;
      &lt;/div&gt;
      
      &lt;div className=&quot;field-row&quot;&gt;
        &lt;label className=&quot;field-label&quot;&gt;VALOR PRINCIPAL.:&lt;/label&gt;
        &lt;CurrencyInput
          className=&quot;field-input&quot;
          value={principalValue}
          onValueChange={setPrincipalValue}
          decimalsLimit={2}
          prefix=&quot;R$ &quot;
        /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};</code></pre>
<hr />
<h2 id="testes-de-paridade">Testes de Paridade</h2>
<h3 id="cenários-críticos">Cenários Críticos</h3>
<ol type="1">
<li><strong>Cálculo Financeiro</strong>
<ul>
<li>Input: Valores conhecidos</li>
<li>Processo: Ambos sistemas</li>
<li>Comparar: Resultados devem ser idênticos</li>
</ul></li>
<li><strong>Validação de Regras</strong>
<ul>
<li>Testar todas 122 regras</li>
<li>Comparar mensagens de erro</li>
<li>Validar comportamento</li>
</ul></li>
<li><strong>Performance</strong>
<ul>
<li>Tempo de busca: &lt; 3s (atual)</li>
<li>Autorização: &lt; 90s (atual)</li>
<li>Carga: 200 usuários simultâneos</li>
</ul></li>
</ol>
<h3 id="script-de-teste">Script de Teste</h3>
<div class="sourceCode" id="cb112"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytest</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> legacy_api <span class="im">import</span> LegacySystem</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> new_api <span class="im">import</span> NewSystem</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TestParity:</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_payment_calculation(<span class="va">self</span>):</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Arrange</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>        claim_data <span class="op">=</span> {</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;principal&#39;</span>: <span class="fl">50000.00</span>,</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;correction&#39;</span>: <span class="fl">2500.00</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;conversion_rate&#39;</span>: <span class="fl">1.0847</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Act</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>        legacy_result <span class="op">=</span> LegacySystem.calculate(claim_data)</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>        new_result <span class="op">=</span> NewSystem.calculate(claim_data)</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Assert</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> legacy_result[<span class="st">&#39;total_btnf&#39;</span>] <span class="op">==</span> new_result[<span class="st">&#39;total_btnf&#39;</span>]</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span> <span class="bu">abs</span>(legacy_result[<span class="st">&#39;total&#39;</span>] <span class="op">-</span> new_result[<span class="st">&#39;total&#39;</span>]) <span class="op">&lt;</span> <span class="fl">0.01</span></span></code></pre></div>
<hr />
<h2 id="plano-de-cutover">Plano de Cutover</h2>
<h3 id="timeline-detalhado">Timeline Detalhado</h3>
<pre><code>D-30: Freeze de funcionalidades
D-14: Backup completo produção
D-7:  Deploy em staging
D-3:  Testes finais
D-1:  Comunicação usuários
D-0:  CUTOVER

00:00 - Stop legacy system
01:00 - Final backup
02:00 - Data migration start
06:00 - Data migration complete
07:00 - Validation checks
08:00 - System online (read-only)
09:00 - Full system online
10:00 - Monitor and support</code></pre>
<h3 id="rollback-plan">Rollback Plan</h3>
<div class="sourceCode" id="cb114"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se falha detectada em até 4 horas</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./rollback.sh</span> <span class="at">--immediate</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Procedimento:</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="ex">1.</span> Stop new system</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="ex">2.</span> Restore legacy system</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="ex">3.</span> Replay transactions from log</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="ex">4.</span> Verify data integrity</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="ex">5.</span> Resume operations</span></code></pre></div>
<hr />
<h2 id="treinamento">Treinamento</h2>
<h3 id="programa-de-capacitação">Programa de Capacitação</h3>
<table>
<thead>
<tr>
<th>Audiência</th>
<th>Duração</th>
<th>Conteúdo</th>
<th>Formato</th>
</tr>
</thead>
<tbody>
<tr>
<td>Desenvolvedores</td>
<td>40h</td>
<td>.NET, React, Azure</td>
<td>Presencial</td>
</tr>
<tr>
<td>Operadores</td>
<td>16h</td>
<td>Nova interface</td>
<td>Hands-on</td>
</tr>
<tr>
<td>Suporte</td>
<td>24h</td>
<td>Troubleshooting</td>
<td>Workshop</td>
</tr>
<tr>
<td>Gestores</td>
<td>4h</td>
<td>Dashboard, KPIs</td>
<td>Apresentação</td>
</tr>
</tbody>
</table>
<h3 id="material-de-treinamento">Material de Treinamento</h3>
<ol type="1">
<li><strong>Manual do Usuário</strong> (100 páginas)</li>
<li><strong>Guia de Referência Rápida</strong> (10 páginas)</li>
<li><strong>Videos Tutoriais</strong> (20 vídeos)</li>
<li><strong>Ambiente de Treinamento</strong> (sandbox)</li>
<li><strong>FAQ</strong> (50 perguntas comuns)</li>
</ol>
<hr />
<h2 id="riscos-e-mitigação">Riscos e Mitigação</h2>
<h3 id="matriz-de-riscos">Matriz de Riscos</h3>
<table>
<thead>
<tr>
<th>Risco</th>
<th>Probabilidade</th>
<th>Impacto</th>
<th>Mitigação</th>
</tr>
</thead>
<tbody>
<tr>
<td>Perda de dados</td>
<td>Baixa</td>
<td>Crítico</td>
<td>Backups redundantes</td>
</tr>
<tr>
<td>Bug crítico</td>
<td>Média</td>
<td>Alto</td>
<td>Parallel run extended</td>
</tr>
<tr>
<td>Performance</td>
<td>Média</td>
<td>Alto</td>
<td>Load testing intensivo</td>
</tr>
<tr>
<td>Resistência usuários</td>
<td>Alta</td>
<td>Médio</td>
<td>Treinamento e suporte</td>
</tr>
<tr>
<td>Integração falha</td>
<td>Baixa</td>
<td>Alto</td>
<td>Modo contingência</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="métricas-de-sucesso">Métricas de Sucesso</h2>
<h3 id="kpis-da-migração">KPIs da Migração</h3>
<ul class="task-list">
<li><label><input type="checkbox" />100% dos dados migrados com
sucesso</label></li>
<li><label><input type="checkbox" />Zero perda de
transações</label></li>
<li><label><input type="checkbox" />Performance igual ou
melhor</label></li>
<li><label><input type="checkbox" />95% satisfação dos
usuários</label></li>
<li><label><input type="checkbox" />Redução 50% em
incidentes</label></li>
<li><label><input type="checkbox" />ROI positivo em 18
meses</label></li>
</ul>
<hr />
<h2 id="checklist-go-live">Checklist Go-Live</h2>
<h3 id="semana-antes">1 Semana Antes</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Todos os testes passed</label></li>
<li><label><input type="checkbox" />Usuários treinados</label></li>
<li><label><input type="checkbox" />Backup plan testado</label></li>
<li><label><input type="checkbox" />Comunicação enviada</label></li>
<li><label><input type="checkbox" />Suporte escalado</label></li>
</ul>
<h3 id="dia-antes">1 Dia Antes</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Freeze produção</label></li>
<li><label><input type="checkbox" />Backup completo</label></li>
<li><label><input type="checkbox" />Scripts prontos</label></li>
<li><label><input type="checkbox" />War room setup</label></li>
<li><label><input type="checkbox" />Rollback testado</label></li>
</ul>
<h3 id="dia-d">Dia D</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Legacy stopped</label></li>
<li><label><input type="checkbox" />Data migrated</label></li>
<li><label><input type="checkbox" />System validated</label></li>
<li><label><input type="checkbox" />Users notified</label></li>
<li><label><input type="checkbox" />Monitoring active</label></li>
</ul>
<hr />
<p><em>Este é o guia completo para migração do sistema SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h1 id="glossário-sistema-legado-siwea">10 - Glossário: Sistema Legado
SIWEA</h1>
<hr />
<h2 id="termos-de-negócio">Termos de Negócio</h2>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 28%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Termo</th>
<th>Sigla</th>
<th>Definição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sinistro</strong></td>
<td>-</td>
<td>Evento coberto pela apólice de seguro que gera direito à
indenização</td>
</tr>
<tr>
<td><strong>Protocolo</strong></td>
<td>PROT</td>
<td>Identificador único do processo de sinistro no formato
XXX/NNNNNNN-D</td>
</tr>
<tr>
<td><strong>Reserva Esperada</strong></td>
<td>SDOPAG</td>
<td>Valor total previsto para pagamento do sinistro</td>
</tr>
<tr>
<td><strong>Total Pago</strong></td>
<td>TOTPAG</td>
<td>Soma de todos os pagamentos já realizados</td>
</tr>
<tr>
<td><strong>Saldo Pendente</strong></td>
<td>-</td>
<td>Diferença entre reserva esperada e total pago</td>
</tr>
<tr>
<td><strong>Beneficiário</strong></td>
<td>NOMFAV</td>
<td>Pessoa ou entidade que recebe a indenização</td>
</tr>
<tr>
<td><strong>Ramo</strong></td>
<td>RMO</td>
<td>Categoria do seguro (ex: automóvel, vida, residencial)</td>
</tr>
<tr>
<td><strong>Líder</strong></td>
<td>-</td>
<td>Seguradora principal em operações de cosseguro</td>
</tr>
<tr>
<td><strong>Apólice</strong></td>
<td>APO</td>
<td>Contrato de seguro entre segurado e seguradora</td>
</tr>
<tr>
<td><strong>Indenização</strong></td>
<td>-</td>
<td>Valor pago ao beneficiário pela ocorrência do sinistro</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="termos-técnicos">Termos Técnicos</h2>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 28%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr>
<th>Termo</th>
<th>Sigla</th>
<th>Definição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SIWEA</strong></td>
<td>-</td>
<td>Sistema de Indenização e Workflow de Eventos Atendidos</td>
</tr>
<tr>
<td><strong>CICS</strong></td>
<td>-</td>
<td>Customer Information Control System (IBM transaction manager)</td>
</tr>
<tr>
<td><strong>DB2</strong></td>
<td>-</td>
<td>Database 2 (Sistema gerenciador de banco de dados IBM)</td>
</tr>
<tr>
<td><strong>COBOL</strong></td>
<td>-</td>
<td>Common Business Oriented Language</td>
</tr>
<tr>
<td><strong>EZEE</strong></td>
<td>-</td>
<td>IBM VisualAge EZEE (ferramenta RAD para COBOL)</td>
</tr>
<tr>
<td><strong>RACF</strong></td>
<td>-</td>
<td>Resource Access Control Facility (segurança mainframe)</td>
</tr>
<tr>
<td><strong>JCL</strong></td>
<td>-</td>
<td>Job Control Language</td>
</tr>
<tr>
<td><strong>VSAM</strong></td>
<td>-</td>
<td>Virtual Storage Access Method</td>
</tr>
<tr>
<td><strong>TSO</strong></td>
<td>-</td>
<td>Time Sharing Option</td>
</tr>
<tr>
<td><strong>ISPF</strong></td>
<td>-</td>
<td>Interactive System Productivity Facility</td>
</tr>
<tr>
<td><strong>3270</strong></td>
<td>-</td>
<td>Protocolo de terminal IBM para mainframe</td>
</tr>
<tr>
<td><strong>EBCDIC</strong></td>
<td>-</td>
<td>Extended Binary Coded Decimal Interchange Code</td>
</tr>
<tr>
<td><strong>MQ Series</strong></td>
<td>MQ</td>
<td>IBM Message Queue middleware</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="campos-do-sistema">Campos do Sistema</h2>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 45%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th>Campo</th>
<th>Nome Completo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TIPSEG</strong></td>
<td>Tipo de Seguro</td>
<td>Classificação do tipo de seguro</td>
</tr>
<tr>
<td><strong>ORGSIN</strong></td>
<td>Origem Sinistro</td>
<td>Código da origem do sinistro</td>
</tr>
<tr>
<td><strong>RMOSIN</strong></td>
<td>Ramo Sinistro</td>
<td>Código do ramo de seguro</td>
</tr>
<tr>
<td><strong>NUMSIN</strong></td>
<td>Número Sinistro</td>
<td>Número sequencial do sinistro</td>
</tr>
<tr>
<td><strong>FONTE</strong></td>
<td>Fonte Protocolo</td>
<td>Origem do protocolo (sistema/canal)</td>
</tr>
<tr>
<td><strong>PROTSINI</strong></td>
<td>Protocolo Sinistro</td>
<td>Número do protocolo</td>
</tr>
<tr>
<td><strong>DAC</strong></td>
<td>Dígito Auto-Conferência</td>
<td>Dígito verificador do protocolo</td>
</tr>
<tr>
<td><strong>ORGAPO</strong></td>
<td>Origem Apólice</td>
<td>Origem da apólice de seguro</td>
</tr>
<tr>
<td><strong>RMOAPO</strong></td>
<td>Ramo Apólice</td>
<td>Ramo da apólice</td>
</tr>
<tr>
<td><strong>NUMAPOL</strong></td>
<td>Número Apólice</td>
<td>Número da apólice</td>
</tr>
<tr>
<td><strong>CODPRODU</strong></td>
<td>Código Produto</td>
<td>Código do produto de seguro</td>
</tr>
<tr>
<td><strong>TIPREG</strong></td>
<td>Tipo Registro</td>
<td>Tipo de registro (1=Individual, 2=Coletivo)</td>
</tr>
<tr>
<td><strong>TPSEGU</strong></td>
<td>Tipo Segurado</td>
<td>Tipo de segurado</td>
</tr>
<tr>
<td><strong>CODLIDER</strong></td>
<td>Código Líder</td>
<td>Código da seguradora líder</td>
</tr>
<tr>
<td><strong>SINLID</strong></td>
<td>Sinistro Líder</td>
<td>Número do sinistro na líder</td>
</tr>
<tr>
<td><strong>OCORHIST</strong></td>
<td>Ocorrência Histórico</td>
<td>Contador sequencial de eventos</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="valores-financeiros">Valores Financeiros</h2>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 25%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr>
<th>Campo</th>
<th>Nome</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>VALPRI</strong></td>
<td>Valor Principal</td>
<td>Valor principal da indenização</td>
</tr>
<tr>
<td><strong>CRRMON</strong></td>
<td>Correção Monetária</td>
<td>Valor de correção monetária</td>
</tr>
<tr>
<td><strong>VALPRIBT</strong></td>
<td>Valor Principal BTNF</td>
<td>Valor principal convertido para BTNF</td>
</tr>
<tr>
<td><strong>CRRMONBT</strong></td>
<td>Correção BTNF</td>
<td>Correção convertida para BTNF</td>
</tr>
<tr>
<td><strong>VALTOTBT</strong></td>
<td>Valor Total BTNF</td>
<td>Soma total em BTNF</td>
</tr>
<tr>
<td><strong>BTNF</strong></td>
<td>-</td>
<td>Bônus do Tesouro Nacional Fiscal (moeda padronizada)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="códigos-de-status">Códigos de Status</h2>
<table>
<thead>
<tr>
<th>Código</th>
<th>Status</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>AT</strong></td>
<td>Ativo</td>
<td>Sinistro ativo, pode receber pagamentos</td>
</tr>
<tr>
<td><strong>EN</strong></td>
<td>Encerrado</td>
<td>Sinistro finalizado, sem mais pagamentos</td>
</tr>
<tr>
<td><strong>CA</strong></td>
<td>Cancelado</td>
<td>Sinistro cancelado</td>
</tr>
<tr>
<td><strong>PE</strong></td>
<td>Pendente</td>
<td>Aguardando documentação ou análise</td>
</tr>
<tr>
<td><strong>AP</strong></td>
<td>Aprovado</td>
<td>Pagamento aprovado</td>
</tr>
<tr>
<td><strong>RJ</strong></td>
<td>Rejeitado</td>
<td>Pagamento rejeitado</td>
</tr>
<tr>
<td><strong>0</strong></td>
<td>Inicial</td>
<td>Status inicial padrão</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>Processado</td>
<td>Já processado pelo sistema</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="tipos-de-pagamento">Tipos de Pagamento</h2>
<table>
<thead>
<tr>
<th>Código</th>
<th>Tipo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>Total</td>
<td>Pagamento integral do sinistro</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>Parcial</td>
<td>Pagamento de parte do valor</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>Complementar</td>
<td>Complemento de pagamento anterior</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>Ajuste</td>
<td>Ajuste de valores</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>Recalculado</td>
<td>Pagamento recalculado</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="integrações-externas-1">Integrações Externas</h2>
<table>
<thead>
<tr>
<th>Sistema</th>
<th>Sigla</th>
<th>Função</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>CNOUA</strong></td>
<td>-</td>
<td>Sistema de validação de produtos de consórcio</td>
</tr>
<tr>
<td><strong>SIPUA</strong></td>
<td>-</td>
<td>Sistema de validação de contratos EFP</td>
</tr>
<tr>
<td><strong>SIMDA</strong></td>
<td>-</td>
<td>Sistema de validação de contratos HB</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="fases-do-workflow">Fases do Workflow</h2>
<table>
<thead>
<tr>
<th>Código</th>
<th>Fase</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>001</strong></td>
<td>Abertura</td>
<td>Abertura inicial do sinistro</td>
</tr>
<tr>
<td><strong>002</strong></td>
<td>Análise Documentação</td>
<td>Verificação de documentos</td>
</tr>
<tr>
<td><strong>003</strong></td>
<td>Autorização Pagamento</td>
<td>Em processo de autorização</td>
</tr>
<tr>
<td><strong>004</strong></td>
<td>Pagamento Realizado</td>
<td>Pagamento efetuado</td>
</tr>
<tr>
<td><strong>005</strong></td>
<td>Aguardando Comprovação</td>
<td>Esperando comprovantes</td>
</tr>
<tr>
<td><strong>006</strong></td>
<td>Comprovação Recebida</td>
<td>Documentos recebidos</td>
</tr>
<tr>
<td><strong>007</strong></td>
<td>Análise Final</td>
<td>Análise para encerramento</td>
</tr>
<tr>
<td><strong>008</strong></td>
<td>Encerramento</td>
<td>Sinistro encerrado</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="mensagens-de-erro">Mensagens de Erro</h2>
<table>
<thead>
<tr>
<th>Código</th>
<th>Severidade</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>E0001</strong></td>
<td>Erro</td>
<td>Sinistro não encontrado</td>
</tr>
<tr>
<td><strong>E0002</strong></td>
<td>Erro</td>
<td>Tipo de pagamento inválido</td>
</tr>
<tr>
<td><strong>E0003</strong></td>
<td>Erro</td>
<td>Valor principal obrigatório</td>
</tr>
<tr>
<td><strong>E0004</strong></td>
<td>Erro</td>
<td>Beneficiário obrigatório</td>
</tr>
<tr>
<td><strong>E0010</strong></td>
<td>Erro</td>
<td>Falha na integração externa</td>
</tr>
<tr>
<td><strong>E0011</strong></td>
<td>Erro</td>
<td>Timeout na validação</td>
</tr>
<tr>
<td><strong>E0020</strong></td>
<td>Erro</td>
<td>Usuário sem permissão</td>
</tr>
<tr>
<td><strong>E0021</strong></td>
<td>Erro</td>
<td>Valor excede alçada</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="códigos-de-retorno-1">Códigos de Retorno</h2>
<table>
<thead>
<tr>
<th>Código</th>
<th>Tipo</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>Sucesso</td>
<td>Operação completada com sucesso</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>Aviso</td>
<td>Operação com avisos</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>Erro</td>
<td>Erro recuperável</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>Fatal</td>
<td>Erro fatal, abort necessário</td>
</tr>
<tr>
<td><strong>100</strong></td>
<td>SQL</td>
<td>Registro não encontrado</td>
</tr>
<tr>
<td><strong>-803</strong></td>
<td>SQL</td>
<td>Violação de chave única</td>
</tr>
<tr>
<td><strong>-911</strong></td>
<td>SQL</td>
<td>Deadlock detectado</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="acrônimos-do-projeto">Acrônimos do Projeto</h2>
<table>
<thead>
<tr>
<th>Sigla</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>POC</strong></td>
<td>Proof of Concept</td>
</tr>
<tr>
<td><strong>MVP</strong></td>
<td>Minimum Viable Product</td>
</tr>
<tr>
<td><strong>SLA</strong></td>
<td>Service Level Agreement</td>
</tr>
<tr>
<td><strong>KPI</strong></td>
<td>Key Performance Indicator</td>
</tr>
<tr>
<td><strong>ETL</strong></td>
<td>Extract, Transform, Load</td>
</tr>
<tr>
<td><strong>DR</strong></td>
<td>Disaster Recovery</td>
</tr>
<tr>
<td><strong>UAT</strong></td>
<td>User Acceptance Testing</td>
</tr>
<tr>
<td><strong>ROI</strong></td>
<td>Return on Investment</td>
</tr>
<tr>
<td><strong>TCO</strong></td>
<td>Total Cost of Ownership</td>
</tr>
<tr>
<td><strong>GDPR</strong></td>
<td>General Data Protection Regulation</td>
</tr>
<tr>
<td><strong>LGPD</strong></td>
<td>Lei Geral de Proteção de Dados</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="conversões-e-equivalências">Conversões e Equivalências</h2>
<table>
<thead>
<tr>
<th>De</th>
<th>Para</th>
<th>Fator/Método</th>
</tr>
</thead>
<tbody>
<tr>
<td>EBCDIC</td>
<td>UTF-8</td>
<td>Tabela de conversão</td>
</tr>
<tr>
<td>COMP-3</td>
<td>Decimal</td>
<td>Unpack + conversão</td>
</tr>
<tr>
<td>Julian Date</td>
<td>DateTime</td>
<td>Cálculo de dias</td>
</tr>
<tr>
<td>9999-12-31</td>
<td>NULL</td>
<td>Data infinita → NULL</td>
</tr>
<tr>
<td>Spaces</td>
<td>NULL</td>
<td>Brancos → NULL</td>
</tr>
<tr>
<td>Low-values</td>
<td>0</td>
<td>Zeros binários</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Este glossário contém todos os termos utilizados no sistema
SIWEA.</em></p>
<p><strong>Última Atualização:</strong> 27/10/2025</p>
<hr />
<h2 id="apêndices">APÊNDICES</h2>
<h3 id="a.-informações-de-contato">A. Informações de Contato</h3>
<ul>
<li><strong>Equipe de Desenvolvimento</strong>:
desenvolvimento-siwea@caixaseguradora.com.br</li>
<li><strong>Suporte Técnico</strong>:
suporte-siwea@caixaseguradora.com.br</li>
<li><strong>Gestão do Projeto</strong>:
pmo-migracao@caixaseguradora.com.br</li>
</ul>
<h3 id="b.-histórico-de-revisões">B. Histórico de Revisões</h3>
<table>
<thead>
<tr>
<th>Versão</th>
<th>Data</th>
<th>Autor</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0</td>
<td>27/10/2025</td>
<td>Equipe Migração</td>
<td>Documentação inicial completa</td>
</tr>
</tbody>
</table>
<h3 id="c.-referências">C. Referências</h3>
<ol type="1">
<li>IBM VisualAge EZEE 4.40 Documentation</li>
<li>COBOL ANSI 85 Reference Manual</li>
<li>DB2 for z/OS Administration Guide</li>
<li>CICS Transaction Server Programming Guide</li>
<li>Circular SUSEP 360/2017</li>
</ol>
<hr />
<p><strong>FIM DO DOCUMENTO</strong></p>
<p><em>© 2025 Caixa Seguradora. Todos os direitos reservados.</em>
<em>Este documento contém informações confidenciais e
proprietárias.</em></p>
